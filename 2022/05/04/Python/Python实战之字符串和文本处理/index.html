<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Python实战之字符串和文本处理 - 山河已无恙</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="山河已无恙"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="山河已无恙"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="傍晚时分，你坐在屋檐下，看着天慢慢地黑下去，心里寂寞而凄凉，感到自己的生命被剥夺了。当时我是个年轻人，但我害怕这样生活下去，衰老下去。在我看来，这是比死亡更可怕的事。——–王小波"><meta property="og:type" content="blog"><meta property="og:title" content="山河已无恙"><meta property="og:url" content="https://mp.weixin.qq.com/s?__biz=MzkyNjIxNTYwMw==&amp;mid=2247496480&amp;idx=1&amp;sn=a9971fed3962ef2a1aeda1f0bda65f86&amp;chksm=c2380ffcf54f86eaba8daac6caca72a70f38e61a8d25dc2a66d3a17b87c02530e326dcaea14b#rd"><meta property="og:site_name" content="山河已无恙"><meta property="og:description" content="傍晚时分，你坐在屋檐下，看着天慢慢地黑下去，心里寂寞而凄凉，感到自己的生命被剥夺了。当时我是个年轻人，但我害怕这样生活下去，衰老下去。在我看来，这是比死亡更可怕的事。——–王小波"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://mp.weixin.qq.com/img/头像.jpg"><meta property="article:published_time" content="2022-05-03T17:27:03.000Z"><meta property="article:modified_time" content="2023-06-21T11:25:59.106Z"><meta property="article:author" content="LIRUILONGS"><meta property="article:tag" content="Python"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/头像.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://liruilongs.github.io/2022/05/04/Python/Python%E5%AE%9E%E6%88%98%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86/"},"headline":"山河已无恙","image":["https://liruilongs.github.io/img/og_image.png"],"datePublished":"2022-05-03T17:27:03.000Z","dateModified":"2023-06-21T11:25:59.106Z","author":{"@type":"Person","name":"山河已无恙"},"description":"傍晚时分，你坐在屋檐下，看着天慢慢地黑下去，心里寂寞而凄凉，感到自己的生命被剥夺了。当时我是个年轻人，但我害怕这样生活下去，衰老下去。在我看来，这是比死亡更可怕的事。——–王小波"}</script><link rel="canonical" href="https://liruilongs.github.io/2022/05/04/Python/Python%E5%AE%9E%E6%88%98%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86/"><link rel="alternate" href="/path/to/atom.xml" title="山河已无恙" type="application/atom+xml"><link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Oxanium:wght@300;400;600&amp;family=Roboto+Mono"><link rel="stylesheet" href="/css/cyberpunk.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?3f06f2b732a5b1034c989f74e28d0eea";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css"><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="/live2d/waifu.css"><script type="text/javascript" async src="/live2d/autoload.js"></script><meta name="generator" content="Hexo 5.4.2"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="山河已无恙" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/media">影音</a><a class="navbar-item" href="/album">相册</a><a class="navbar-item" href="/friend">友链</a><a class="navbar-item" href="/self-talking">生活小记</a><a class="navbar-item" href="/message">留言墙</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Gitee" href="https://gitee.com/liruilonger"><i class="fab fa-git-square fa-1x"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/LIRUILONGS"><i class="fab fa-github fa-1x"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul fa-1x"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search fa-1x"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon fa-1x" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-05-04  <a class="commentCountImg" href="/2022/05/04/Python/Python%E5%AE%9E%E6%88%98%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86/#comment-container"><span class="display-none-class">4e7db57f04d94115a477eca9c64c48de</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="4e7db57f04d94115a477eca9c64c48de">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>44 分钟  <i class="fas fa-pencil-alt"> </i>6.7 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">Python实战之字符串和文本处理</h1><div class="content"><p><strong><font color="009688"> 傍晚时分，你坐在屋檐下，看着天慢慢地黑下去，心里寂寞而凄凉，感到自己的生命被剥夺了。当时我是个年轻人，但我害怕这样生活下去，衰老下去。在我看来，这是比死亡更可怕的事。——–王小波</strong></font></p>
<span id="more"></span>
<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><hr>
<ul>
<li><p>博文为《Python Cookbook》读书后笔记整理</p>
</li>
<li><p>涉及内容包括：</p>
<ul>
<li>使用多个界定符分割字符串</li>
<li>字符串开头或结尾匹配,用Shell通配符匹配字符串</li>
<li>字符串匹配和搜索和替换(忽略大小写),最短匹配模式</li>
<li>将Unicode文本标准化,在正则式中使用Unicode</li>
<li>合并拼接字符串,字符串中插入变量,删除字符串中不需要的字符</li>
<li>以指定列宽格式化字符串,在字符串中处理html和xml</li>
<li>字节字符串上的字符串操作</li>
</ul>
</li>
<li><p>理解不足小伙伴帮忙指正</p>
</li>
</ul>
<p><strong><font color="009688"> 傍晚时分，你坐在屋檐下，看着天慢慢地黑下去，心里寂寞而凄凉，感到自己的生命被剥夺了。当时我是个年轻人，但我害怕这样生活下去，衰老下去。在我看来，这是比死亡更可怕的事。——–王小波</strong></font></p>
<hr>
<h2 id="字符串和文本处理"><a href="#字符串和文本处理" class="headerlink" title="字符串和文本处理"></a>字符串和文本处理</h2><h3 id="针对任意多的分隔符拆分字符串"><a href="#针对任意多的分隔符拆分字符串" class="headerlink" title="针对任意多的分隔符拆分字符串"></a>针对任意多的分隔符拆分字符串</h3><p><strong>你需要将一个字符串分割为多个字段，但是分隔符 (还有周围的空格) 并不是固定的</strong></p>
<p><code>string 对象的 split() 方法</code>只适应于非常简单的字符串分割情形，它并不允许有多个分隔符或者是分隔符周围不确定的空格。当你需要更加灵活的切割字符串的时候，最好使用<code>re.split()</code>方法：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>line = <span class="string">&#x27;asdf fjdk; afed, fjek,asdf, foo&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">r&#x27;[;,\s]\s*&#x27;</span>, line)</span><br><span class="line">[<span class="string">&#x27;asdf&#x27;</span>, <span class="string">&#x27;fjdk&#x27;</span>, <span class="string">&#x27;afed&#x27;</span>, <span class="string">&#x27;fjek&#x27;</span>, <span class="string">&#x27;asdf&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p><code>函数 re.split()</code>允许你为分隔符指定多个正则模式。  分隔符可以是<code>逗号，分号或者是空格，并且后面紧跟着任意个的空格</code>。只要这个模式被找到，那么匹配的分隔符两边的实体都会被当成是结果中的元素返回。返回结果为一个字段列表</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">r&#x27;(;|,|\s)\s*&#x27;</span>, line)</span><br><span class="line">[<span class="string">&#x27;asdf&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;fjdk&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;afed&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;fjek&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;asdf&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>使用<code>re.split()</code>函数时候，需要特别注意的是正则表达式中是否包含一个括号<code>捕获分组</code>。如果使用了捕获分组，那么<code>被匹配的文本也将出现在结果列表中</code>。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>fields = re.split(<span class="string">r&#x27;(;|,|\s)\s*&#x27;</span>, line)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>values = fields[::<span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>delimiters = fields[<span class="number">1</span>::<span class="number">2</span>] + [<span class="string">&#x27;&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>values</span><br><span class="line">[<span class="string">&#x27;asdf&#x27;</span>, <span class="string">&#x27;fjdk&#x27;</span>, <span class="string">&#x27;afed&#x27;</span>, <span class="string">&#x27;fjek&#x27;</span>, <span class="string">&#x27;asdf&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>delimiters</span><br><span class="line">[<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#x27;</span>.join(v+d <span class="keyword">for</span> v,d <span class="keyword">in</span> <span class="built_in">zip</span>(values, delimiters))</span><br><span class="line"><span class="string">&#x27;asdf fjdk;afed,fjek,asdf,foo&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>获取分割字符在某些情况下也是有用的,可能想保留分割字符串，用来在后面重新构造一个新的输出字符串：</p>
<p>如果你不想保留分割字符串到结果列表中去，但仍然需要使用到括号来分组正则表达式的话，确保你的分组是非捕获分组，形如<code>(?:...)</code>。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">r&#x27;(?:,|;|\s)\s*&#x27;</span>, line)</span><br><span class="line">[<span class="string">&#x27;asdf&#x27;</span>, <span class="string">&#x27;fjdk&#x27;</span>, <span class="string">&#x27;afed&#x27;</span>, <span class="string">&#x27;fjek&#x27;</span>, <span class="string">&#x27;asdf&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="在字符串的开头或结尾处做文本匹配"><a href="#在字符串的开头或结尾处做文本匹配" class="headerlink" title="在字符串的开头或结尾处做文本匹配"></a>在字符串的开头或结尾处做文本匹配</h3><p><strong>你需要通过指定的文本模式去检查字符串的开头或者结尾，比如文件名后缀，URLScheme 等等。</strong></p>
<p>检查字符串开头或结尾的一个简单方法是使用<code>str.startswith()</code>或者是<code>str.endswith()</code>方法。比如:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>filename = <span class="string">&#x27;spam.txt&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>filename.endswith(<span class="string">&#x27;.txt&#x27;</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>filename.startswith(<span class="string">&#x27;file:&#x27;</span>)</span><br><span class="line"><span class="literal">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>url = <span class="string">&#x27;http://www.python.org&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>url.startswith(<span class="string">&#x27;http:&#x27;</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>如果你想检查<code>多种匹配可能</code>，只需要将所有的匹配项放入到一个<code>元组</code>中去，然后<code>传给 startswith() 或者 endswith() 方法</code>：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>filenames = os.listdir(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>filenames</span><br><span class="line">[<span class="string">&#x27;.bash_logout&#x27;</span>, <span class="string">&#x27;.bash_profile&#x27;</span>, <span class="string">&#x27;.cshrc&#x27;</span>, <span class="string">&#x27;.tcshrc&#x27;</span>, <span class="string">&#x27;anaconda-ks.cfg&#x27;</span>, <span class="string">&#x27;scp_script.py&#x27;</span>, <span class="string">&#x27;uagtodata&#x27;</span>, <span class="string">&#x27;.bash_history&#x27;</span>, <span class="string">&#x27;one-client-install.sh&#x27;</span>, <span class="string">&#x27;calico.yaml&#x27;</span>, <span class="string">&#x27;docker&#x27;</span>, <span class="string">&#x27;.mysql_history&#x27;</span>, <span class="string">&#x27;UagAAA&#x27;</span>, <span class="string">&#x27;Uag.tar&#x27;</span>, <span class="string">&#x27;liruilong.snap1&#x27;</span>, <span class="string">&#x27;.python_history&#x27;</span>, <span class="string">&#x27;.cache&#x27;</span>, <span class="string">&#x27;translateDemo&#x27;</span>, <span class="string">&#x27;soft&#x27;</span>, <span class="string">&#x27;jenkins.docker.sh&#x27;</span>, <span class="string">&#x27;o3J6.txt&#x27;</span>, <span class="string">&#x27;bak_shell&#x27;</span>, <span class="string">&#x27;liruilong&#x27;</span>, <span class="string">&#x27;index.html&#x27;</span>, <span class="string">&#x27;load_balancing&#x27;</span>, <span class="string">&#x27;redis-2.10.3.tar.gz&#x27;</span>, <span class="string">&#x27;redis-2.10.3&#x27;</span>, <span class="string">&#x27;.kube&#x27;</span>, <span class="string">&#x27;kc1&#x27;</span>, <span class="string">&#x27;pod-demo.yaml&#x27;</span>, <span class="string">&#x27;web-liruilong.yaml&#x27;</span>, <span class="string">&#x27;shell.sh&#x27;</span>, <span class="string">&#x27;.config&#x27;</span>, <span class="string">&#x27;nohup.out&#x27;</span>, <span class="string">&#x27;.viminfo&#x27;</span>, <span class="string">&#x27;.pki&#x27;</span>, <span class="string">&#x27;kubectl.1&#x27;</span>, <span class="string">&#x27;temp&#x27;</span>, <span class="string">&#x27;go&#x27;</span>, <span class="string">&#x27;.vim&#x27;</span>, <span class="string">&#x27;111.txt&#x27;</span>, <span class="string">&#x27;uagtodata.tar&#x27;</span>, <span class="string">&#x27;set.sh&#x27;</span>, <span class="string">&#x27;.Xauthority&#x27;</span>, <span class="string">&#x27;calico_3_14.tar&#x27;</span>, <span class="string">&#x27;.ssh&#x27;</span>, <span class="string">&#x27;.bashrc&#x27;</span>, <span class="string">&#x27;db&#x27;</span>, <span class="string">&#x27;.docker&#x27;</span>, <span class="string">&#x27;UagAAA.tar&#x27;</span>, <span class="string">&#x27;Uag.war&#x27;</span>, <span class="string">&#x27;Uag&#x27;</span>, <span class="string">&#x27;txt.sh&#x27;</span>, <span class="string">&#x27;.lesshst&#x27;</span>, <span class="string">&#x27;gitlab.docker.sh&#x27;</span>, <span class="string">&#x27;kubectl&#x27;</span>, <span class="string">&#x27;rsync&#x27;</span>, <span class="string">&#x27;percona-toolkit-3.0.13-1.el7.x86_64.rpm&#x27;</span>, <span class="string">&#x27;redisclear.py&#x27;</span>, <span class="string">&#x27;Fetch&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[name <span class="keyword">for</span> name <span class="keyword">in</span> filenames <span class="keyword">if</span> name.endswith((<span class="string">&#x27;.yaml&#x27;</span>, <span class="string">&#x27;.sh&#x27;</span>)) ]</span><br><span class="line">[<span class="string">&#x27;one-client-install.sh&#x27;</span>, <span class="string">&#x27;calico.yaml&#x27;</span>, <span class="string">&#x27;jenkins.docker.sh&#x27;</span>, <span class="string">&#x27;pod-demo.yaml&#x27;</span>, <span class="string">&#x27;web-liruilong.yaml&#x27;</span>, <span class="string">&#x27;shell.sh&#x27;</span>, <span class="string">&#x27;set.sh&#x27;</span>, <span class="string">&#x27;txt.sh&#x27;</span>, <span class="string">&#x27;gitlab.docker.sh&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">any</span>(name.endswith(<span class="string">&#x27;.py&#x27;</span>) <span class="keyword">for</span> name <span class="keyword">in</span> filenames)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>必须要输入一个元组作为参数。如果你恰巧有一个 list 或者 set 类型的选择项，要确保传递参数前先调用 tuple() 将其转换为元组类型</p>
<p>类似的操作也可以使用切片来实现，但是代码看起来没有那么优雅</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>filename = <span class="string">&#x27;spam.txt&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>filename[-<span class="number">4</span>:] == <span class="string">&#x27;.txt&#x27;</span></span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>url = <span class="string">&#x27;http://www.python.org&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>url[:<span class="number">5</span>] == <span class="string">&#x27;http:&#x27;</span> <span class="keyword">or</span> url[:<span class="number">6</span>] == <span class="string">&#x27;https:&#x27;</span> <span class="keyword">or</span> url[:<span class="number">4</span>] == <span class="string">&#x27;ftp:&#x27;</span></span><br><span class="line"><span class="literal">True</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>还可以使用正则表达式去实现</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>url = <span class="string">&#x27;http://www.python.org&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.match(<span class="string">&#x27;http:|https:|ftp:&#x27;</span>, url)</span><br><span class="line">&lt;_sre.SRE_Match <span class="built_in">object</span>; span=(<span class="number">0</span>, <span class="number">5</span>), match=<span class="string">&#x27;http:&#x27;</span>&gt;</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="利用Shell通配符做字符串匹配"><a href="#利用Shell通配符做字符串匹配" class="headerlink" title="利用Shell通配符做字符串匹配"></a>利用Shell通配符做字符串匹配</h3><p><strong>你想使用<code>Unix Shell</code>中常用的通配符 (比如 <code>*.py , Dat[0-9]*.csv</code> 等) 去匹配文本字符串</strong></p>
<p>可以使用 <code>fnmatch() </code>函数</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> fnmatch <span class="keyword">import</span> fnmatch, fnmatchcase</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fnmatch(<span class="string">&#x27;foo.txt&#x27;</span>, <span class="string">&#x27;*.txt&#x27;</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fnmatch(<span class="string">&#x27;foo.txt&#x27;</span>, <span class="string">&#x27;?oo.txt&#x27;</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fnmatch(<span class="string">&#x27;Dat45.csv&#x27;</span>, <span class="string">&#x27;Dat[0-9]*&#x27;</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>names = [<span class="string">&#x27;Dat1.csv&#x27;</span>, <span class="string">&#x27;Dat2.csv&#x27;</span>, <span class="string">&#x27;config.ini&#x27;</span>, <span class="string">&#x27;foo.py&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[name <span class="keyword">for</span> name <span class="keyword">in</span> names <span class="keyword">if</span> fnmatch(name, <span class="string">&#x27;Dat*.csv&#x27;</span>)]</span><br><span class="line">[<span class="string">&#x27;Dat1.csv&#x27;</span>, <span class="string">&#x27;Dat2.csv&#x27;</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p><code>fnmatch() </code>函数使用底层操作系统的大小写敏感规则 (不同的系统是不一样的) 来匹配模式</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#winsows10</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> fnmatch <span class="keyword">import</span> fnmatch, fnmatchcase</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fnmatch(<span class="string">&#x27;foo.txt&#x27;</span>, <span class="string">&#x27;*.TXT&#x27;</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="comment"># Linux</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fnmatch(<span class="string">&#x27;foo.txt&#x27;</span>, <span class="string">&#x27;*.TXT&#x27;</span>)</span><br><span class="line"><span class="literal">False</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>如果你对这个区别很在意，可以使用<code>fnmatchcase()</code>来代替。它完全使用你的模式大小写匹配。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> fnmatch <span class="keyword">import</span> fnmatch, fnmatchcase</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fnmatch(<span class="string">&#x27;foo.txt&#x27;</span>, <span class="string">&#x27;*.TXT&#x27;</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fnmatchcase(<span class="string">&#x27;foo.txt&#x27;</span>, <span class="string">&#x27;*.TXT&#x27;</span>)</span><br><span class="line"><span class="literal">False</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p><code>fnmatch()</code> 函数匹配能力介于简单的字符串方法和强大的正则表达式之间.在处理非文件名的字符串时也可以使用</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> fnmatch <span class="keyword">import</span> fnmatchcase</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>addresses = [</span><br><span class="line"><span class="meta">... </span><span class="string">&#x27;5412 N CLARK ST&#x27;</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">&#x27;1060 W ADDISON ST&#x27;</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">&#x27;1039 W GRANVILLE AVE&#x27;</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">&#x27;2122 N CLARK ST&#x27;</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">&#x27;4802 N BROADWAY&#x27;</span>,</span><br><span class="line"><span class="meta">... </span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[addr <span class="keyword">for</span> addr <span class="keyword">in</span> addresses <span class="keyword">if</span> fnmatchcase(addr, <span class="string">&#x27;* ST&#x27;</span>)]</span><br><span class="line">[<span class="string">&#x27;5412 N CLARK ST&#x27;</span>, <span class="string">&#x27;1060 W ADDISON ST&#x27;</span>, <span class="string">&#x27;2122 N CLARK ST&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[addr <span class="keyword">for</span> addr <span class="keyword">in</span> addresses <span class="keyword">if</span> fnmatchcase(addr, <span class="string">&#x27;54[0-9][0-9] *CLARK*&#x27;</span>)]</span><br><span class="line">[<span class="string">&#x27;5412 N CLARK ST&#x27;</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="文本模式的匹配和查找"><a href="#文本模式的匹配和查找" class="headerlink" title="文本模式的匹配和查找"></a>文本模式的匹配和查找</h3><p><strong>你想匹配或者搜索特定模式的文本</strong></p>
<p>如果你想匹配的是字面字符串，那么你通常只需要调用基本字符串方法就行，比如<code>str.find() , str.endswith() , str.startswith() </code>或者类似的方法：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>text = <span class="string">&#x27;yeah, but no, but yeah, but no, but yeah&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text.startswith(<span class="string">&#x27;yeah&#x27;</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text.endswith(<span class="string">&#x27;no&#x27;</span>)</span><br><span class="line"><span class="literal">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text.find(<span class="string">&#x27;no&#x27;</span>)</span><br><span class="line"><span class="number">10</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>对于复杂的匹配需要使用正则表达式和 re 模块</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>text1 = <span class="string">&#x27;11/27/2012&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> re.match(<span class="string">r&#x27;\d+/\d+/\d+&#x27;</span>, text1):</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="string">&#x27;yes&#x27;</span>)</span><br><span class="line"><span class="meta">... </span><span class="keyword">else</span>:</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="string">&#x27;no&#x27;</span>)</span><br><span class="line">...</span><br><span class="line">yes</span><br></pre></td></tr></table></figure>
<p>如果你想使用同一个模式去做多次匹配，你应该先将模式字符串预编译为模式对象。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>datepat = re.<span class="built_in">compile</span>(<span class="string">r&#x27;\d+/\d+/\d+&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> datepat.match(text1):</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="string">&#x27;yes&#x27;</span>)</span><br><span class="line"><span class="meta">... </span><span class="keyword">else</span>:</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="string">&#x27;no&#x27;</span>)</span><br><span class="line">...</span><br><span class="line">yes</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p><code>match() </code>总是从字符串开始去匹配，如果你想查找字符串任意部分的模式出现位置，使用<code>findall()</code>方法去代替</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>text = <span class="string">&#x27;Today is 11/27/2012. PyCon starts 3/13/2013.&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>datepat.findall(text)</span><br><span class="line">[<span class="string">&#x27;11/27/2012&#x27;</span>, <span class="string">&#x27;3/13/2013&#x27;</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>在定义正则式的时候，通常会利用括号去捕获分组分别将每个组的内容提取出来</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>datepat = re.<span class="built_in">compile</span>(<span class="string">r&#x27;(\d+)/(\d+)/(\d+)&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = datepat.match(<span class="string">&#x27;11/27/2012&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m</span><br><span class="line">&lt;_sre.SRE_Match <span class="built_in">object</span>; span=(<span class="number">0</span>, <span class="number">10</span>), match=<span class="string">&#x27;11/27/2012&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.group(<span class="number">0</span>)</span><br><span class="line"><span class="string">&#x27;11/27/2012&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.group(<span class="number">1</span>)</span><br><span class="line"><span class="string">&#x27;11&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.group(<span class="number">3</span>)</span><br><span class="line"><span class="string">&#x27;2012&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.groups()</span><br><span class="line">(<span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27;27&#x27;</span>, <span class="string">&#x27;2012&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><code>findall() </code>方法会搜索文本并以列表形式返回所有的匹配,想以迭代方式返回匹配，可以使用<code>finditer()</code>方法来代替</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>[m.groups()  <span class="keyword">for</span> m <span class="keyword">in</span> datepat.finditer(text)]</span><br><span class="line">[(<span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27;27&#x27;</span>, <span class="string">&#x27;2012&#x27;</span>), (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;13&#x27;</span>, <span class="string">&#x27;2013&#x27;</span>)]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="查找和替换文本"><a href="#查找和替换文本" class="headerlink" title="查找和替换文本"></a>查找和替换文本</h3><p><strong>你想在字符串中搜索和匹配指定的文本模式</strong></p>
<p>对于简单的字面模式，直接使用<code>str.repalce()</code>方法即可</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;yeah, but no, but yeah, but no, but yeah&#x27;</span>.replace(<span class="string">&#x27;yeah&#x27;</span>, <span class="string">&#x27;yep&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;yep, but no, but yep, but no, but yep&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p>复杂的模式，请使用 re 模块中的<code>sub()</code>函数。<code>sub() 函数</code>中的第一个参数是<code>被匹配的模式</code>，第二个参数是<code>替换模式</code>。<code>反斜杠数字比如 \3 指向前面模式的捕获组号。</code></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.sub(<span class="string">r&#x27;(\d+)/(\d+)/(\d+)&#x27;</span>, <span class="string">r&#x27;\3-\1-\2&#x27;</span>,<span class="string">&#x27;Today is 11/27/2012. PyCon starts 3/13/2013.&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;Today is 2012-11-27. PyCon starts 2013-3-13.&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>如果你打算用相同的模式做多次替换，考虑先编译它来提升性能</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>datepat = re.<span class="built_in">compile</span>(<span class="string">r&#x27;(\d+)/(\d+)/(\d+)&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>datepat.sub(<span class="string">r&#x27;\3-\1-\2&#x27;</span>, text)</span><br><span class="line"><span class="string">&#x27;Today is 2012-11-27. PyCon starts 2013-3-13.&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>对于更加复杂的替换，可以传递一个替换回调函数来代替</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> calendar <span class="keyword">import</span> month_abbr</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">change_date</span>(<span class="params">m</span>):</span></span><br><span class="line"><span class="meta">... </span>    mon_name = month_abbr[<span class="built_in">int</span>(m.group(<span class="number">1</span>))]</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">return</span> <span class="string">&#x27;&#123;&#125; &#123;&#125; &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(m.group(<span class="number">2</span>), mon_name, m.group(<span class="number">3</span>))</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>datepat.sub(change_date, text)</span><br><span class="line"><span class="string">&#x27;Today is 27 Nov 2012. PyCon starts 13 Mar 2013.&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>想知道有多少替换发生了，可以使用<code> re.subn()</code></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>newtext, n = datepat.subn(<span class="string">r&#x27;\3-\1-\2&#x27;</span>, text)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>newtext</span><br><span class="line"><span class="string">&#x27;Today is 2012-11-27. PyCon starts 2013-3-13.&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>n</span><br><span class="line"><span class="number">2</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h3 id="字符串忽略大小写的搜索替换"><a href="#字符串忽略大小写的搜索替换" class="headerlink" title="字符串忽略大小写的搜索替换"></a>字符串忽略大小写的搜索替换</h3><p><strong>你需要以忽略大小写的方式搜索与替换文本字符串</strong></p>
<p>类似 Lixnu 中grep的 -i 参数，<code>python</code>中需要在使用<code> re 模块</code>的时候给这些操作提供<code>re.IGNORECASE 标志参数</code>。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>text = <span class="string">&#x27;UPPER PYTHON, lower python, Mixed Python&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.findall(<span class="string">&#x27;python&#x27;</span>, text, flags=re.IGNORECASE)</span><br><span class="line">[<span class="string">&#x27;PYTHON&#x27;</span>, <span class="string">&#x27;python&#x27;</span>, <span class="string">&#x27;Python&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>也可以用于替换</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.sub(<span class="string">&#x27;python&#x27;</span>, <span class="string">&#x27;snake&#x27;</span>, text, flags=re.IGNORECASE)</span><br><span class="line"><span class="string">&#x27;UPPER snake, lower snake, Mixed snake&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>替换字符串并不会自动跟被匹配字符串的大小写保持一致。为了修复这个，你可能需要一个辅助函数</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">matchcase</span>(<span class="params">word</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">replace</span>(<span class="params">m</span>):</span></span><br><span class="line">        text = m.group()</span><br><span class="line">        <span class="keyword">if</span> text.isupper():</span><br><span class="line">            <span class="keyword">return</span> word.upper()</span><br><span class="line">        <span class="keyword">elif</span> text.islower():</span><br><span class="line">            <span class="keyword">return</span> word.lower()</span><br><span class="line">        <span class="keyword">elif</span> text[<span class="number">0</span>].isupper():</span><br><span class="line">            <span class="keyword">return</span> word.capitalize()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> word</span><br><span class="line">    <span class="keyword">return</span> replace</span><br><span class="line"></span><br><span class="line">re.sub(<span class="string">&#x27;python&#x27;</span>, matchcase(<span class="string">&#x27;snake&#x27;</span>), text, flags=re.IGNORECASE)   </span><br><span class="line">========</span><br><span class="line"><span class="string">&#x27;UPPER SNAKE, lower snake, Mixed Snake&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="定义实现最短匹配的正则表达式"><a href="#定义实现最短匹配的正则表达式" class="headerlink" title="定义实现最短匹配的正则表达式"></a>定义实现最短匹配的正则表达式</h3><p><strong>用正则表达式匹配某个文本模式，但是它找到的是模式的最长可能匹配。而你想修改它变成查找最短的可能匹配。</strong></p>
<p>在需要匹配一对分隔符之间的文本的时候,模式 <code>r&#39;\&quot;(.*)\&quot;&#39; </code>的意图是匹配被双引号包含的文本</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>str_pat = re.<span class="built_in">compile</span>(<span class="string">r&#x27;\&quot;(.*)\&quot;&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text1 = <span class="string">&#x27;Computer says &quot;no.&quot;&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str_pat.findall(text1)</span><br><span class="line">[<span class="string">&#x27;no.&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text2 = <span class="string">&#x27;Computer says &quot;no.&quot; Phone says &quot;yes.&quot;&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str_pat.findall(text2)</span><br><span class="line">[<span class="string">&#x27;no.&quot; Phone says &quot;yes.&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str_pat = re.<span class="built_in">compile</span>(<span class="string">r&#x27;\&quot;(.*?)\&quot;&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str_pat.findall(text2)</span><br><span class="line">[<span class="string">&#x27;no.&#x27;</span>, <span class="string">&#x27;yes.&#x27;</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>正则表达式中 <code>* 操作符是贪婪的</code>，因此匹配操作会查找最长的可能匹配,可以在模式中的<code> * 操作符后面加上? 修饰符</code>,使得匹配变成非贪婪模式</p>
<p><code>点 (.) </code>匹配除了换行外的任何字符,如果你将<code>点 (.) </code>号放在开始与结束符 (比如引号) 之间的时候，那么匹配操作会查找符合模式的<code>最长可能匹配</code>,在 <code>* 或者 + </code>这样的操作符后面添加一个<code>?</code>可以强制<code>匹配算 法</code>改成寻找<code>最短的可能匹配</code>。</p>
<h3 id="编写多行模式的正则表达式"><a href="#编写多行模式的正则表达式" class="headerlink" title="编写多行模式的正则表达式"></a>编写多行模式的正则表达式</h3><p><strong>使用正则表达式去匹配一大块的文本，而你需要跨越多行去匹配。</strong></p>
<p>很典型的出现在当你用点 <code>(.) </code>去匹配任意字符的时候，忘记了点<code>(.)</code>不能匹配换行符的事实,匹配 C 语言分割的注释：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>comment = re.<span class="built_in">compile</span>(<span class="string">r&#x27;/\*(.*?)\*/&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text1 = <span class="string">&#x27;/* this is a comment */&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text2 = <span class="string">&#x27;&#x27;&#x27;/* this is a</span></span><br><span class="line"><span class="string"><span class="meta">... </span>multiline comment */</span></span><br><span class="line"><span class="string"><span class="meta">... </span>&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>comment.findall(text1)</span><br><span class="line">[<span class="string">&#x27; this is a comment &#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>comment.findall(text2)</span><br><span class="line">[]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>可以修改模式字符串，增加对换行的支持</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>comment = re.<span class="built_in">compile</span>(<span class="string">r&#x27;/\*((?:.|\n)*?)\*/&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>comment.findall(text2)</span><br><span class="line">[<span class="string">&#x27; this is a\nmultiline comment &#x27;</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>在这个模式中，<code> (?:.|\n)</code> 指定了一个<code>非捕获组</code> (也就是它定义了一个仅仅用来做匹配，而不能通过单独捕获或者编号的组)。</p>
<p><code>re.compile() 函数</code>接受一个标志参数叫 <code>re.DOTALL </code>，在这里非常有用。它可以让<code>正则表达式中的点 (.) 匹配包括换行符在内的任意字符</code></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>comment = re.<span class="built_in">compile</span>(<span class="string">r&#x27;/\*(.*?)\*/&#x27;</span>, re.DOTALL)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>comment.findall(text2)</span><br><span class="line">[<span class="string">&#x27; this is a\nmultiline comment &#x27;</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>



<h3 id="将Unicode文本统一表示为规范形式"><a href="#将Unicode文本统一表示为规范形式" class="headerlink" title="将Unicode文本统一表示为规范形式"></a>将Unicode文本统一表示为规范形式</h3><p><strong>你正在处理 Unicode 字符串，需要确保所有字符串在底层有相同的表示。</strong></p>
<p>嗯，这块先记录下，感觉有些鸡肋….</p>
<p>在 Unicode 中，某些字符能够用多个合法的编码表示</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1 = <span class="string">&#x27;Spicy Jalape\u00f1o&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s2 = <span class="string">&#x27;Spicy Jalapen\u0303o&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1</span><br><span class="line"><span class="string">&#x27;Spicy Jalapeño&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s2</span><br><span class="line"><span class="string">&#x27;Spicy Jalapeño&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1 == s2</span><br><span class="line"><span class="literal">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">len</span>(s1)</span><br><span class="line"><span class="number">14</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">len</span>(s2)</span><br><span class="line"><span class="number">15</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p>在需要比较字符串的程序中使用字符的多种表示会产生问题。为了修正这个问题，你可以使用 unicodedata 模块先将文本标准化：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> unicodedata</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t1 = unicodedata.normalize(<span class="string">&#x27;NFC&#x27;</span>, s1)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t2 = unicodedata.normalize(<span class="string">&#x27;NFC&#x27;</span>, s2)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t1 == t2</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="built_in">ascii</span>(t1))</span><br><span class="line"><span class="string">&#x27;Spicy Jalape\xf1o&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t3 = unicodedata.normalize(<span class="string">&#x27;NFD&#x27;</span>, s1)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t4 = unicodedata.normalize(<span class="string">&#x27;NFD&#x27;</span>, s2)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t3 == t4</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="built_in">ascii</span>(t3))</span><br><span class="line"><span class="string">&#x27;Spicy Jalapen\u0303o&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p><code>normalize()</code> 第一个参数指定<code>字符串标准化</code>的方式。<code>NFC </code>表示字符应该是整体组成 (比如可能的话就使用单一编码)，而 <code>NFD </code>表示字符应该分解为多个组合字符表示。</p>
<p>Python 同样支持扩展的标准化形式<code> NFKC 和 NFKD</code>，它们在处理某些字符的时候增加了额外的兼容特性</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">&#x27;\ufb01&#x27;</span> <span class="comment"># A single character</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line"><span class="string">&#x27; fi&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>unicodedata.normalize(<span class="string">&#x27;NFD&#x27;</span>, s)</span><br><span class="line"><span class="string">&#x27; fi&#x27;</span></span><br><span class="line"><span class="comment"># Notice how the combined letters are broken apart here</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>unicodedata.normalize(<span class="string">&#x27;NFKD&#x27;</span>, s)</span><br><span class="line"><span class="string">&#x27;fi&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>unicodedata.normalize(<span class="string">&#x27;NFKC&#x27;</span>, s)</span><br><span class="line"><span class="string">&#x27;fi&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="用正则表达式处理Unicode字符"><a href="#用正则表达式处理Unicode字符" class="headerlink" title="用正则表达式处理Unicode字符"></a>用正则表达式处理Unicode字符</h3><p><strong>你正在使用正则表达式处理文本，但是关注的是 Unicode 字符处理</strong>。</p>
<p>默认情况下 <code>re 模块</code>已经对一些<code> Unicode 字符</code>类有了基本的支持。比如，<code>\\d</code>已经匹配任意的<code>unicode</code>数字字符了</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num = re.<span class="built_in">compile</span>(<span class="string">&#x27;\d+&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># ASCII digits</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num.match(<span class="string">&#x27;123&#x27;</span>)</span><br><span class="line">&lt;_sre.SRE_Match <span class="built_in">object</span> at <span class="number">0x1007d9ed0</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># Arabic digits</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num.match(<span class="string">&#x27;\u0661\u0662\u0663&#x27;</span>)</span><br><span class="line">&lt;_sre.SRE_Match <span class="built_in">object</span> at <span class="number">0x101234030</span>&gt;</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>嗯，这个不太懂，先记录下</p>
<h3 id="从字符串中去掉不需要的字符"><a href="#从字符串中去掉不需要的字符" class="headerlink" title="从字符串中去掉不需要的字符"></a>从字符串中去掉不需要的字符</h3><p><strong>想去掉文本字符串开头，结尾或者中间不想要的字符，比如空白。</strong></p>
<p><code>strip() </code>方法能用于删除开始或结尾的字符。 <code>lstrip() 和 rstrip() </code>分别从左和从右执行删除操作。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">&#x27; hello world \n&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.strip()</span><br><span class="line"><span class="string">&#x27;hello world&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.lstrip()</span><br><span class="line"><span class="string">&#x27;hello world \n&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.rstrip()</span><br><span class="line"><span class="string">&#x27; hello world&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>默认情况下，这些方法会去除空白字符，但是你也可以指定其他字符</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>t = <span class="string">&#x27;-----hello=====&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t.lstrip(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;hello=====&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t.strip(<span class="string">&#x27;-=&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;hello&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>想处理中间的空格，使用<code>replace()</code>方法或者是用正则表达式替换</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;helloworld&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line">re.sub(<span class="string">&#x27;\s+&#x27;</span>, <span class="string">&#x27; &#x27;</span>, s)</span><br><span class="line"><span class="string">&#x27;hello world&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>将字符串 strip 操作和其他迭代操作相结合，利用生成器表达式</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename) <span class="keyword">as</span> f:</span><br><span class="line">    lines = (line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> f)</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="built_in">print</span>(line)</span><br></pre></td></tr></table></figure>
<h3 id="文本过滤和清理"><a href="#文本过滤和清理" class="headerlink" title="文本过滤和清理"></a>文本过滤和清理</h3><p><strong>一些无聊的幼稚黑客在你的网站页面表单中输入文本”pýtĥöñ”，然后你想将这些字符清理掉。</strong></p>
<p>文本清理问题会涉及到包括文本解析与数据处理等一系列问题。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">&#x27;pýtĥöñ\fis\tawesome\r\n&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line"><span class="string">&#x27;pýtĥöñ\x0cis\tawesome\r\n&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>remap = &#123;</span><br><span class="line"><span class="meta">... </span><span class="built_in">ord</span>(<span class="string">&#x27;\t&#x27;</span>) : <span class="string">&#x27; &#x27;</span>,</span><br><span class="line"><span class="meta">... </span><span class="built_in">ord</span>(<span class="string">&#x27;\f&#x27;</span>) : <span class="string">&#x27; &#x27;</span>,</span><br><span class="line"><span class="meta">... </span><span class="built_in">ord</span>(<span class="string">&#x27;\r&#x27;</span>) : <span class="literal">None</span> <span class="comment"># Deleted</span></span><br><span class="line"><span class="meta">... </span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.translate(remap)</span><br><span class="line"><span class="string">&#x27;pýtĥöñ is awesome\n&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>正如你看的那样，空白字符 \t 和 \f 已经被重新映射到一个空格。回车字符 r 直接被删除。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> unicodedata</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>cmb_chrs = <span class="built_in">dict</span>.fromkeys(c <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(sys.maxunicode)</span><br><span class="line"><span class="meta">... </span><span class="keyword">if</span> unicodedata.combining(<span class="built_in">chr</span>(c)))</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = unicodedata.normalize(<span class="string">&#x27;NFD&#x27;</span>, a)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b</span><br><span class="line"><span class="string">&#x27;pýtĥöñ is awesome\n&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b.translate(cmb_chrs)</span><br><span class="line"><span class="string">&#x27;python is awesome\n&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>通过使用<code>dict.fromkeys()</code>方法构造一个字典，每个<code> Unicode 和音符作为键</code>，对于的值全部为 None</p>
<p>然后使用<code>unicodedata.normalize()</code>将原始输入标准化为分解形式字符。然后再调用<code> translate 函数删除</code>所有重音符。同样的技术也可以被用来删除其他类型的字符<br>(比如控制字符等)。</p>
<p>另一种清理文本的技术涉及到 I&#x2F;O 解码与编码函数。这里的思路是先对文本做一些初步的清理，然后再结合 <code>encode() </code>或者<code>decode()</code>操作来清除或修改它</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line"><span class="string">&#x27;pýtĥöñ is awesome\n&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = unicodedata.normalize(<span class="string">&#x27;NFD&#x27;</span>, a)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b.encode(<span class="string">&#x27;ascii&#x27;</span>, <span class="string">&#x27;ignore&#x27;</span>).decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;python is awesome\n&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="对齐文本字符串"><a href="#对齐文本字符串" class="headerlink" title="对齐文本字符串"></a>对齐文本字符串</h3><p><strong>通过某种对齐方式来格式化字符串</strong></p>
<p>对于基本的字符串对齐操作，可以使用字符串的<code> ljust() , rjust() 和 center()方法</code>。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>text = <span class="string">&#x27;Hello World&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text.ljust(<span class="number">20</span>)</span><br><span class="line"><span class="string">&#x27;Hello World         &#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text.rjust(<span class="number">20</span>)</span><br><span class="line"><span class="string">&#x27;         Hello World&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text.center(<span class="number">20</span>)</span><br><span class="line"><span class="string">&#x27;    Hello World     &#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>所有这些方法都能接受一个可选的填充字符。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>text = <span class="string">&#x27;Hello World&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>text.rjust(<span class="number">20</span>,<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;=========Hello World&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num=<span class="string">&#x27;5&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num.rjust(<span class="number">8</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;00000005&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>rjust这类型的方法只针对对字符串，对于int类型不支持</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>num.rjust(<span class="number">8</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">AttributeError: <span class="string">&#x27;int&#x27;</span> <span class="built_in">object</span> has no attribute <span class="string">&#x27;rjust&#x27;</span></span><br></pre></td></tr></table></figure>
<p>函数<code>format()</code>同样可以用来很容易的对齐字符串。你要做的就是使用<code>&lt;,&gt;</code>或者<code>^字符</code>后面紧跟一个指定的宽度，</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>num=<span class="number">5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">format</span>(num, <span class="string">&#x27;&gt;20&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;                   5&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">format</span>(num, <span class="string">&#x27;0&gt;20&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;00000000000000000005&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">format</span>(num, <span class="string">&#x27;0&lt;20&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;50000000000000000000&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">format</span>(num, <span class="string">&#x27;0^20&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;00000000050000000000&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>当格式化多个值的时候，这些格式代码也可以被用在<code>format()</code>方法中。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#123;:&gt;10s&#125; &#123;:&gt;10s&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;World&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;     Hello      World&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p><code>format() </code>函数的一个好处是它不仅适用于字符串。它可以用来格式化任何值</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">1.2345</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">format</span>(x, <span class="string">&#x27;&gt;10&#x27;</span>)</span><br><span class="line"><span class="string">&#x27; 1.2345&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">format</span>(x, <span class="string">&#x27;^10.2f&#x27;</span>)</span><br><span class="line"><span class="string">&#x27; 1.23 &#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#123;:&gt;10s&#125; &#123;:&gt;10s&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;World&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;     Hello      World&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="字符串连接及合并"><a href="#字符串连接及合并" class="headerlink" title="字符串连接及合并"></a>字符串连接及合并</h3><p><strong>将几个小的字符串合并为一个大的字符串</strong></p>
<p>如果你想要合并的字符串是在<code>一个序列或者 iterable</code> 中，那么最快的方式就是使用<code>join()</code>方法</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>parts = [<span class="string">&#x27;Is&#x27;</span>, <span class="string">&#x27;Chicago&#x27;</span>, <span class="string">&#x27;Not&#x27;</span>, <span class="string">&#x27;Chicago?&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27; &#x27;</span>.join(parts)</span><br><span class="line"><span class="string">&#x27;Is Chicago Not Chicago?&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;,&#x27;</span>.join(parts)</span><br><span class="line"><span class="string">&#x27;Is,Chicago,Not,Chicago?&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#x27;</span>.join(parts)</span><br><span class="line"><span class="string">&#x27;IsChicagoNotChicago?&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = <span class="string">&#x27;Not Chicago?&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a + <span class="string">&#x27; &#x27;</span> + b</span><br><span class="line"><span class="string">&#x27;Is Chicago Not Chicago?&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>如果你想在<code>源码</code>中将<code>两个字面字符串</code>合并起来，你只需要简单的将它们放到一起，不需要用加号 (+)。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="string">&#x27;li&#x27;</span> <span class="string">&#x27;rui&#x27;</span> <span class="string">&#x27;long&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line"><span class="string">&#x27;liruilong&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>嗯，字符串变量是不行的，有些天真了哈….,只适用于字面量</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="string">&#x27;li&#x27;</span> <span class="string">&#x27;rui&#x27;</span> <span class="string">&#x27;long&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line"><span class="string">&#x27;liruilong&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a a</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span></span><br><span class="line">    a a</span><br><span class="line">      ^</span><br><span class="line">SyntaxError: invalid syntax</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = a a</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span></span><br><span class="line">    a = a a</span><br><span class="line">          ^</span><br><span class="line">SyntaxError: invalid syntax</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p><strong><font color=brown>使用加号 (+) 操作符去连接大量的字符串的时候是非常低效率的，因为加号连接会引起内存复制以及垃圾回收操作</font></strong></p>
<p>永远都不应像下面这样写字符串连接代码</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> parts:</span><br><span class="line">    s += p</span><br></pre></td></tr></table></figure>
<p>这种写法会比使用<code> join() 方法</code>运行的要慢一些，因为每一次执行<code> += 操作</code>的时候会创建一个<code>新的字符串对象</code>。你最好是先收集所有的<code>字符串片段</code>然后再将它们连接起来。可以利用生成器表达式</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = [<span class="string">&#x27;ACME&#x27;</span>, <span class="number">50</span>, <span class="number">91.1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;,&#x27;</span>.join(<span class="built_in">str</span>(d) <span class="keyword">for</span>  d <span class="keyword">in</span> data)</span><br><span class="line"><span class="string">&#x27;ACME,50,91.1&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>同样还得注意不必要的字符串连接操作。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(a + <span class="string">&#x27;:&#x27;</span> + b + <span class="string">&#x27;:&#x27;</span> + c) <span class="comment"># Ugly</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;:&#x27;</span>.join([a, b, c])) <span class="comment"># Still ugly</span></span><br><span class="line"><span class="built_in">print</span>(a, b, c, sep=<span class="string">&#x27;:&#x27;</span>) <span class="comment"># Better</span></span><br></pre></td></tr></table></figure>
<p>当混合使用 I&#x2F;O 操作和字符串连接操作的时候，有时候需要仔细研究你的程序</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Version 1 (string concatenation)</span></span><br><span class="line">f.write(chunk1 + chunk2)</span><br><span class="line"><span class="comment"># Version 2 (separate I/O operations)</span></span><br><span class="line">f.write(chunk1)</span><br><span class="line">f.write(chunk2)</span><br></pre></td></tr></table></figure>
<p>如果两个字符串很小，那么第一个版本性能会更好些，因为 I&#x2F;O 系统调用天生就慢。另外一方面，如果两个字符串很大，那么第二个版本可能会更加高效，因为它避免了创建一个很大的临时结果并且要复制大量的内存块数据。</p>
<p>如果你准备编写<code>构建大量小字符串的输出代码</code>，你最好考虑下使用<code>生成器函数</code>，利用<code>yield</code>语句产生输出片段,是它并没有对输出片段到底要怎样组织做出假设</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sample</span>():</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;Is&#x27;</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;Chicago&#x27;</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;Not&#x27;</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="string">&#x27;Chicago?&#x27;</span></span><br><span class="line"></span><br><span class="line">text = <span class="string">&#x27;&#x27;</span>.join(sample())    </span><br><span class="line"><span class="built_in">print</span> (text)</span><br></pre></td></tr></table></figure>

<h3 id="字符串中插入变量"><a href="#字符串中插入变量" class="headerlink" title="字符串中插入变量"></a>字符串中插入变量</h3><p><strong>你想创建一个内嵌变量的字符串，变量被它的值所表示的字符串替换掉。</strong></p>
<p>Python 并没有对在字符串中简单替换变量值提供直接的支持(类似shell那样)。但是通过使用字符串的<code>format()</code>方法来解决这个问题。可用于sql拼接</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">&#x27;&#123;name&#125; has &#123;n&#125; messages.&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.<span class="built_in">format</span>(name=<span class="string">&#x27;Guido&#x27;</span>, n=<span class="number">37</span>)</span><br><span class="line"><span class="string">&#x27;Guido has 37 messages.&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>如果要被替换的变量能在变量域中找到，那么你可以结合使用 <code>format map()和 vars()</code></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">&#x27;&#123;name&#125; has &#123;n&#125; messages.&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">&#x27;Guido&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>n = <span class="number">37</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.format_map(<span class="built_in">vars</span>())</span><br><span class="line"><span class="string">&#x27;Guido has 37 messages.&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p><code>vars() </code>还有一个有意思的特性就是它也适用于<code>对象实例</code>。强大到超乎了的想象…</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Info</span>:</span></span><br><span class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, n</span>):</span></span><br><span class="line"><span class="meta">... </span>        self.name = name</span><br><span class="line"><span class="meta">... </span>        self.n = n</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = Info(<span class="string">&#x27;Guido&#x27;</span>,<span class="number">37</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.format_map(<span class="built_in">vars</span>(a))</span><br><span class="line"><span class="string">&#x27;Guido has 37 messages.&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p><em><code>format 和 format map() </code>的一个缺陷就是它们并不能很好的处理变量缺失的情况</em>,一种避免这种错误的方法是另外定义一个含有<code>missing ()</code>方法的字典对象，从2.5版本开始，如果派生自dict的子类定义了 <code>__missing__() </code>方法，当<code>访问不存在的键时</code>，<code>dict[key]会调用 __missing__() 方法取得默认值</code>。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">safesub</span>(<span class="params"><span class="built_in">dict</span></span>):</span></span><br><span class="line"><span class="string">&quot;&quot;&quot; 防止 key 找不到&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__missing__</span>(<span class="params">self, key</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#123;&#x27;</span> + key + <span class="string">&#x27;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>现在你可以利用这个类包装输入后传递给<code>format map()</code></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> n <span class="comment"># Make sure n is undefined</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.format_map(safesub(<span class="built_in">vars</span>()))</span><br><span class="line"><span class="string">&#x27;Guido has &#123;n&#125; messages.&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sub</span>(<span class="params">text</span>):</span></span><br><span class="line">    <span class="keyword">return</span> text.format_map(safesub(sys._getframe(<span class="number">1</span>).f_locals))</span><br></pre></td></tr></table></figure>
<p>sys._getframe:返回来自调用栈的一个帧对象。如果传入可选整数 depth，则返回从栈顶往下相应调用层数的帧对象。如果该数比调用栈更深，则抛出 ValueError。depth 的默认值是 0，返回调用栈顶部的帧<code>。sys. getframe(1) 返回调用者的栈帧</code>，可以从中访问属性 f_locals 来获得局部变量,</p>
<p><code>f_locals 是一个复制调用函数的本地变量的字典</code>。尽管你可以改变 f_locals 的内容，但是这个修改对于后面的变量访问没有任何影响。所以，虽说访问一个栈帧看上去很邪恶，但是对它的任何操作不会覆盖和改变调用者本地变量的值。</p>
<p>设置完我们可以这样用。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">&#x27;Guido&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>n = <span class="number">37</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(sub(<span class="string">&#x27;Hello &#123;name&#125;&#x27;</span>))</span><br><span class="line">Hello Guido</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(sub(<span class="string">&#x27;You have &#123;n&#125; messages.&#x27;</span>))</span><br><span class="line">You have <span class="number">37</span> messages.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(sub(<span class="string">&#x27;Your favorite color is &#123;color&#125;&#x27;</span>))</span><br><span class="line">Your favorite color <span class="keyword">is</span> &#123;color&#125;</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p>对于Python的字符串替换,如果不使用<code>format() 和 format map() </code>还可以有如下方式</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">&#x27;Guido&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>n = <span class="number">37</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;%(name) has %(n) messages.&#x27;</span> % <span class="built_in">vars</span>()</span><br><span class="line"><span class="string">&#x27;Guido has 37 messages.&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">&#x27;Guido&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>n = <span class="number">37</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = string.Template(<span class="string">&#x27;$name has $n messages.&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.substitute(<span class="built_in">vars</span>())</span><br><span class="line"><span class="string">&#x27;Guido has 37 messages.&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>


<h3 id="以指定列宽格式化字符串"><a href="#以指定列宽格式化字符串" class="headerlink" title="以指定列宽格式化字符串"></a>以指定列宽格式化字符串</h3><p><strong>你有一些长字符串，想以指定的列宽将它们重新格式化。</strong></p>
<p>使用 <code>textwrap 模块</code>来格式化字符串的输出</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">&quot;Look into my eyes, look into my eyes, the eyes, the eyes, \</span></span><br><span class="line"><span class="string">... the eyes, not around the eyes, don&#x27;t look around the eyes, \</span></span><br><span class="line"><span class="string">... look into my eyes, you&#x27;re under.&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> textwrap</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(textwrap.fill(s, <span class="number">70</span>))</span><br><span class="line">Look into my eyes, look into my eyes, the eyes, the eyes, the eyes,</span><br><span class="line"><span class="keyword">not</span> around the eyes, don<span class="string">&#x27;t look around the eyes, look into my eyes,</span></span><br><span class="line"><span class="string">you&#x27;</span>re under.</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(textwrap.fill(s, <span class="number">40</span>))</span><br><span class="line">Look into my eyes, look into my eyes,</span><br><span class="line">the eyes, the eyes, the eyes, <span class="keyword">not</span> around</span><br><span class="line">the eyes, don<span class="string">&#x27;t look around the eyes,</span></span><br><span class="line"><span class="string">look into my eyes, you&#x27;</span>re under.</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(textwrap.fill(s, <span class="number">40</span>, initial_indent=<span class="string">&#x27; &#x27;</span>))</span><br><span class="line"> Look into my eyes, look into my eyes,</span><br><span class="line">the eyes, the eyes, the eyes, <span class="keyword">not</span> around</span><br><span class="line">the eyes, don<span class="string">&#x27;t look around the eyes,</span></span><br><span class="line"><span class="string">look into my eyes, you&#x27;</span>re under.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(textwrap.fill(s, <span class="number">40</span>, subsequent_indent=<span class="string">&#x27; &#x27;</span>))</span><br><span class="line">Look into my eyes, look into my eyes,</span><br><span class="line"> the eyes, the eyes, the eyes, <span class="keyword">not</span></span><br><span class="line"> around the eyes, don<span class="string">&#x27;t look around the</span></span><br><span class="line"><span class="string"> eyes, look into my eyes, you&#x27;</span>re under.</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>textwrap 模块对于字符串打印是非常有用的，特别是当你希望输出自动匹配终端大小的时候。你可以使用 os.get terminal size() 方法来获取终端的大小尺寸。比如：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(textwrap.fill(s, os.get_terminal_size().columns, initial_indent=<span class="string">&#x27; &#x27;</span>))</span><br><span class="line"> Look into my eyes, look into my eyes, the eyes, the eyes, the eyes, <span class="keyword">not</span> around</span><br><span class="line">the eyes, don<span class="string">&#x27;t look around the eyes, look into my eyes, you&#x27;</span>re under.</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>


<h3 id="在字符串中处理-html-和-xml"><a href="#在字符串中处理-html-和-xml" class="headerlink" title="在字符串中处理 html 和 xml"></a>在字符串中处理 html 和 xml</h3><p><strong>你想将 HTML 或者 XML 实体如 &amp;entity; 或 &amp;#code; 替换为对应的文本。再者，你需要转换文本中特定的字符 (比如&lt;, &gt;, 或 &amp;)。</strong></p>
<p>如果你想替换文本字符串中的 ‘&lt;’ 或者 ‘&gt;’ ，使用<code> html.escape() 函数</code>可以很容易的完成。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">&#x27;Elements are written as &quot;&lt;tag&gt;text&lt;/tag&gt;&quot;.&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> html</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(s)</span><br><span class="line">Elements are written <span class="keyword">as</span> <span class="string">&quot;&lt;tag&gt;text&lt;/tag&gt;&quot;</span>.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(html.escape(s))</span><br><span class="line">Elements are written <span class="keyword">as</span> &amp;quot;&amp;lt;tag&amp;gt;text&amp;lt;/tag&amp;gt;&amp;quot;.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># Disable escaping of quotes</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(html.escape(s, quote=<span class="literal">False</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如果你正在处理的是<code> ASCII 文本</code>，并且想将<code>非 ASCII 文本</code>对应的<code>编码</code>实体嵌入进去，可以给某些 I&#x2F;O 函数传递参数<code>errors=&#39;xmlcharrefreplace&#39;</code>来达到这个目。比如：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">&#x27;Spicy Jalapeño&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.encode(<span class="string">&#x27;ascii&#x27;</span>, errors=<span class="string">&#x27;xmlcharrefreplace&#x27;</span>)</span><br><span class="line"><span class="string">b&#x27;Spicy Jalape&amp;#241;o&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>为了替换文本中的编码实体，你需要使用另外一种方法。如果你正在处理 HTML或者 XML 文本，试着先使用一个合适的 HTML 或者 XML 解析</p>
<p>html ,这个方法被移除了，我的3.9的版本，</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> html.parser <span class="keyword">import</span> HTMLParser</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = HTMLParser()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.unescape(s)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">AttributeError: <span class="string">&#x27;HTMLParser&#x27;</span> <span class="built_in">object</span> has no attribute <span class="string">&#x27;unescape&#x27;</span></span><br></pre></td></tr></table></figure>
<p>xml</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>t = <span class="string">&#x27;The prompt is &amp;gt;&amp;gt;&amp;gt;&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> xml.sax.saxutils <span class="keyword">import</span> unescape</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>unescape(t)</span><br><span class="line"><span class="string">&#x27;The prompt is &gt;&gt;&gt;&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>



<h3 id="在字节串上执行文本操作"><a href="#在字节串上执行文本操作" class="headerlink" title="在字节串上执行文本操作"></a>在字节串上执行文本操作</h3><p>需要注意这部分内容在Linux环境和Window环境差别有些大，书里讲的适用于window环境。</p>
<p>你想在字节字符串上执行普通的文本操作 (比如移除，搜索和替换)</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = <span class="string">b&#x27;Hello World&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data[<span class="number">0</span>:<span class="number">5</span>]</span><br><span class="line"><span class="string">&#x27;Hello&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data.startswith(<span class="string">b&#x27;Hello&#x27;</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data.split()</span><br><span class="line">[<span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;World&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data.replace(<span class="string">b&#x27;Hello&#x27;</span>, <span class="string">b&#x27;Hello Cruel&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;Hello Cruel World&#x27;</span></span><br></pre></td></tr></table></figure>
<p>操作同样也适用于字节数组</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = <span class="built_in">bytearray</span>(<span class="string">b&#x27;Hello World&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data[<span class="number">0</span>:<span class="number">5</span>]</span><br><span class="line"><span class="built_in">bytearray</span>(<span class="string">b&#x27;Hello&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data.startswith(<span class="string">b&#x27;Hello&#x27;</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data.split()</span><br><span class="line">[<span class="built_in">bytearray</span>(<span class="string">b&#x27;Hello&#x27;</span>), <span class="built_in">bytearray</span>(<span class="string">b&#x27;World&#x27;</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data.replace(<span class="string">b&#x27;Hello&#x27;</span>, <span class="string">b&#x27;Hello Cruel&#x27;</span>)</span><br><span class="line"><span class="built_in">bytearray</span>(<span class="string">b&#x27;Hello Cruel World&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>可以使用正则表达式匹配字节字符串,Linux下无论是字节串还是字符串都可以，window下并不是这样，这里和书里有些出入。</p>
<p>Linux下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = <span class="string">b&#x27;FOO:BAR,SPAM&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">&#x27;[:,]&#x27;</span>,data)</span><br><span class="line">[<span class="string">&#x27;FOO&#x27;</span>, <span class="string">&#x27;BAR&#x27;</span>, <span class="string">&#x27;SPAM&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">b&#x27;[:,]&#x27;</span>,data)</span><br><span class="line">[<span class="string">&#x27;FOO&#x27;</span>, <span class="string">&#x27;BAR&#x27;</span>, <span class="string">&#x27;SPAM&#x27;</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>window下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = <span class="string">b&#x27;FOO:BAR,SPAM&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">&#x27;[:,]&#x27;</span>,data)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">&quot;D:\python\Python310\lib\re.py&quot;</span>, line <span class="number">231</span>, <span class="keyword">in</span> split</span><br><span class="line">    <span class="keyword">return</span> _<span class="built_in">compile</span>(pattern, flags).split(string, maxsplit)</span><br><span class="line">TypeError: cannot use a string pattern on a <span class="built_in">bytes</span>-like <span class="built_in">object</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.split(<span class="string">b&#x27;[:,]&#x27;</span>,data)</span><br><span class="line">[<span class="string">b&#x27;FOO&#x27;</span>, <span class="string">b&#x27;BAR&#x27;</span>, <span class="string">b&#x27;SPAM&#x27;</span>]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>字节字符串不会提供一个美观的字符串表示，也不能很好的打印出来，除非它们先被解码为一个文本字符串,但是这里Linux没有这种情况。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">b&#x27;Hello World&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line"><span class="string">b&#x27;Hello World&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;Hello World&#x27;</span></span><br></pre></td></tr></table></figure>

<p>格式化字节字符串，你得先使用标准的文本字符串，然后将其编码为字节字符串,这里也有些区别</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#123;:10s&#125; &#123;:10d&#125; &#123;:10.2f&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="string">&#x27;ACME&#x27;</span>, <span class="number">100</span>, <span class="number">490.1</span>).encode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line"><span class="string">b&#x27;ACME              100     490.10&#x27;</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>





</div><div class="article-licensing box"><div class="licensing-title"><p>Python实战之字符串和文本处理</p><p><a href="https://liruilongs.github.io/2022/05/04/Python/Python实战之字符串和文本处理/">https://liruilongs.github.io/2022/05/04/Python/Python实战之字符串和文本处理/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="https://liruilongs.github.io"><p>山河已无恙</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2022-05-04</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2023-06-21</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/2022/11/08/Python/%E3%80%90python%E5%B0%8F%E8%84%9A%E6%9C%AC%E3%80%91%E7%9B%91%E5%90%AC%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%8F%91%E9%80%81%E5%91%8A%E8%AD%A6%E7%9F%AD%E4%BF%A1/" target="_blank">【python小脚本】监听日志文件异常数据发送告警短信</a><br></span><span>  2.<a class="is-size-6" href="/2022/07/12/Python/Python%E5%AE%9E%E6%88%98%E4%B9%8B%E5%87%BD%E6%95%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/" target="_blank">Python实战之函数的一些奇技淫巧</a><br></span><span>  3.<a class="is-size-6" href="/2022/07/05/Python/Python%E5%AE%9E%E6%88%98%E4%B9%8B%E7%94%A8%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97%E6%9D%A5%E6%9E%84%E5%BB%BAREST%E6%9C%8D%E5%8A%A1%E3%80%81RPC%E6%9C%8D%E5%8A%A1/" target="_blank">Python实战之用内置模块来构建REST服务、RPC服务</a><br></span><span>  4.<a class="is-size-6" href="/2022/05/30/Python/Python%E5%AE%9E%E6%88%98%E4%B9%8B%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/" target="_blank">Python中迭代器&amp;生成器的&quot;奇技淫巧&quot;</a><br></span><span>  5.<a class="is-size-6" href="/2022/05/04/Python/Python%E5%AE%9E%E6%88%98%E4%B9%8B%E6%95%B0%E5%AD%97%E3%80%81%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E7%9A%84%E9%AB%98%E7%BA%A7%E5%A4%84%E7%90%86/" target="_blank">Python实战之数字、日期和时间的高级处理</a><br></span><span>  6.<a class="is-size-6" href="/2022/05/02/Python/Python%E5%AE%9E%E6%88%98%E4%B9%8BLinux%E4%B8%8B%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99%E7%9A%84%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/" target="_blank">Python实战之Linux下脚本编写的&quot;奇技淫巧&quot;</a><br></span><span>  7.<a class="is-size-6" href="/2022/04/30/Python/Python%E5%AE%9E%E6%88%98%E4%B9%8B%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/" target="_blank">Python实战之数据结构和算法</a><br></span><span>  8.<a class="is-size-6" href="/2022/03/23/Python/%E3%80%90python%E5%B0%8F%E8%84%9A%E6%9C%AC%E3%80%91%E5%9F%BA%E4%BA%8E%E8%A3%85%E9%A5%B0%E5%99%A8%E7%9A%84%E6%97%A5%E5%BF%97%E5%B7%A5%E5%85%B7%E6%A8%A1%E5%9D%97/" target="_blank">【python小脚本】基于装饰器的函数日志脚本</a><br></span></div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 推荐文章</span><br><span>  1.<a class="is-size-6" href="/2021/08/27/K8s/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AKubernetes%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97-%E4%BB%8EDocker%E5%88%B0Kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A8%E6%8E%A5%E8%A7%A6%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" target="_blank">《Kubernetes权威指南:从Docker到Kubernetes实践全接触》读书笔记</a><br></span><span>  2.<a class="is-size-6" href="/2022/11/19/Git/%E5%85%B3%E4%BA%8E-Git-%E9%87%8D%E5%86%99%E5%8E%86%E5%8F%B2%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于 Git 重写历史的一些笔记</a><br></span><span>  3.<a class="is-size-6" href="/2022/08/02/Git/%E5%85%B3%E4%BA%8EGit%E5%88%86%E6%94%AF%E5%8F%98%E5%9F%BA%E6%93%8D%E4%BD%9C%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于Git分支变基操作的一些笔记</a><br></span><span>  4.<a class="is-size-6" href="/2022/07/26/Git/%E5%85%B3%E4%BA%8EGit%E5%88%86%E6%94%AF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于Git分支基础知识的一些笔记</a><br></span><span>  5.<a class="is-size-6" href="/2022/08/02/Git/%E5%85%B3%E4%BA%8EGit%E5%88%86%E6%94%AF%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于Git分支工作流的一些笔记</a><br></span><span>  6.<a class="is-size-6" href="/2023/02/19/Git/%E5%85%B3%E4%BA%8EGit%E9%AB%98%E7%BA%A7%E5%90%88%E5%B9%B6%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86/" target="_blank">关于Git分支高级合并的一些笔记整理</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/alipay%EF%BF%A5.png" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/wechat%EF%BF%A5.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/05/04/Python/Python%E5%AE%9E%E6%88%98%E4%B9%8B%E6%95%B0%E5%AD%97%E3%80%81%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E7%9A%84%E9%AB%98%E7%BA%A7%E5%A4%84%E7%90%86/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Python实战之数字、日期和时间的高级处理</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/05/02/Python/Python%E5%AE%9E%E6%88%98%E4%B9%8BLinux%E4%B8%8B%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99%E7%9A%84%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/"><span class="level-item">Python实战之Linux下脚本编写的&quot;奇技淫巧&quot;</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><div class="card"><div class="card-content"><div class="title is-5">评论</div><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            language:'zh-CN',
            id: '4e7db57f04d94115a477eca9c64c48de',
            repo: 'blog_comment',
            owner: 'LIRUILONGS',
            clientID: '9fdc9739266d48d5f62e',
            clientSecret: 'c1cc33697d099a2197650ec9dadcb16bd4904655',
            admin: ["LIRUILONGS"],
            createIssueManually: true,
            distractionFreeMode: true,
            perPage: 10,
            pagerDirection: 'last',
            proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token',
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex is-mobile" href="#写在前面"><span class="mr-2">1</span><span>写在前面</span></a></li><li><a class="is-flex is-mobile" href="#字符串和文本处理"><span class="mr-2">2</span><span>字符串和文本处理</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#针对任意多的分隔符拆分字符串"><span class="mr-2">2.1</span><span>针对任意多的分隔符拆分字符串</span></a></li><li><a class="is-flex is-mobile" href="#在字符串的开头或结尾处做文本匹配"><span class="mr-2">2.2</span><span>在字符串的开头或结尾处做文本匹配</span></a></li><li><a class="is-flex is-mobile" href="#利用Shell通配符做字符串匹配"><span class="mr-2">2.3</span><span>利用Shell通配符做字符串匹配</span></a></li><li><a class="is-flex is-mobile" href="#文本模式的匹配和查找"><span class="mr-2">2.4</span><span>文本模式的匹配和查找</span></a></li><li><a class="is-flex is-mobile" href="#查找和替换文本"><span class="mr-2">2.5</span><span>查找和替换文本</span></a></li><li><a class="is-flex is-mobile" href="#字符串忽略大小写的搜索替换"><span class="mr-2">2.6</span><span>字符串忽略大小写的搜索替换</span></a></li><li><a class="is-flex is-mobile" href="#定义实现最短匹配的正则表达式"><span class="mr-2">2.7</span><span>定义实现最短匹配的正则表达式</span></a></li><li><a class="is-flex is-mobile" href="#编写多行模式的正则表达式"><span class="mr-2">2.8</span><span>编写多行模式的正则表达式</span></a></li><li><a class="is-flex is-mobile" href="#将Unicode文本统一表示为规范形式"><span class="mr-2">2.9</span><span>将Unicode文本统一表示为规范形式</span></a></li><li><a class="is-flex is-mobile" href="#用正则表达式处理Unicode字符"><span class="mr-2">2.10</span><span>用正则表达式处理Unicode字符</span></a></li><li><a class="is-flex is-mobile" href="#从字符串中去掉不需要的字符"><span class="mr-2">2.11</span><span>从字符串中去掉不需要的字符</span></a></li><li><a class="is-flex is-mobile" href="#文本过滤和清理"><span class="mr-2">2.12</span><span>文本过滤和清理</span></a></li><li><a class="is-flex is-mobile" href="#对齐文本字符串"><span class="mr-2">2.13</span><span>对齐文本字符串</span></a></li><li><a class="is-flex is-mobile" href="#字符串连接及合并"><span class="mr-2">2.14</span><span>字符串连接及合并</span></a></li><li><a class="is-flex is-mobile" href="#字符串中插入变量"><span class="mr-2">2.15</span><span>字符串中插入变量</span></a></li><li><a class="is-flex is-mobile" href="#以指定列宽格式化字符串"><span class="mr-2">2.16</span><span>以指定列宽格式化字符串</span></a></li><li><a class="is-flex is-mobile" href="#在字符串中处理-html-和-xml"><span class="mr-2">2.17</span><span>在字符串中处理 html 和 xml</span></a></li><li><a class="is-flex is-mobile" href="#在字节串上执行文本操作"><span class="mr-2">2.18</span><span>在字节串上执行文本操作</span></a></li></ul></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class=""><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7.jpg" alt="山河已无恙"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">山河已无恙</p><p class="is-size-6 is-block">爱自己，是终生浪漫的开始</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国·呼和浩特</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">330</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">104</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">156</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://mp.weixin.qq.com/s?__biz=MzkyNjIxNTYwMw==&amp;mid=2247496480&amp;idx=1&amp;sn=a9971fed3962ef2a1aeda1f0bda65f86&amp;chksm=c2380ffcf54f86eaba8daac6caca72a70f38e61a8d25dc2a66d3a17b87c02530e326dcaea14b#rd" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/LIRUILONGS"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="CSDN" href="https://liruilong.blog.csdn.net/"><i class="fa fa-code"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:1224965096@qq.com"><i class="fa fa-envelope"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://liruilong.blog.csdn.net/?t=1&amp;type=blog" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CSDN</span></span><span class="level-right"><span class="level-item tag">liruilong.blog.csdn.net</span></span></a></li><li><a class="level is-mobile" href="https://www.cnblogs.com/liruilong/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">博客园</span></span><span class="level-right"><span class="level-item tag">www.cnblogs.com</span></span></a></li><li><a class="level is-mobile" href="https://github.com/LIRUILONGS" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Githup</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li><li><a class="level is-mobile" href="https://gitee.com/liruilonger" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">码云</span></span><span class="level-right"><span class="level-item tag">gitee.com</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新评论</h3><span class="body_hot_comment">加载中，最新评论有1分钟缓存...</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-04T21:18:22.000Z">2024-02-05</time></p><p class="title"><a href="/2024/02/05/%E5%BE%85%E5%8F%91%E5%B8%83/Linux-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%B0%83%E4%BC%98-Tuning-file-system-utilization/">Linux 性能调优之文件系统调优(Tuning file system utilization)</a></p><p class="categories"><a href="/categories/Linux/">Linux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-04T19:37:07.000Z">2024-02-05</time></p><p class="title"><a href="/2024/02/05/%E5%BE%85%E5%8F%91%E5%B8%83/Linux%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E8%99%9A%E6%8B%9F%E5%8C%96%E8%B0%83%E4%BC%98-Virtualization-tuned/">Linux 性能调优之虚拟化(Virtualization tuned)调优</a></p><p class="categories"><a href="/categories/Linux/">Linux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-04T15:59:19.000Z">2024-02-04</time></p><p class="title"><a href="/2024/02/04/K8s/%E5%8D%8E%E4%B8%BA%E4%BA%91/%E5%A6%82%E4%BD%95%E5%9C%A8%E5%8D%8E%E4%B8%BA%E4%BA%91%E4%B8%8A%E8%B4%AD%E4%B9%B0ECS%E5%8F%8A%E4%BB%A5%E9%95%9C%E5%83%8F%E7%9A%84%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2%E5%8D%8E%E4%B8%BA%E4%BA%91%E6%AC%A7%E6%8B%89%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-HCE-OS/">如何在华为云上购买ECS及以镜像的方式部署华为云欧拉操作系统 (HCE OS)</a></p><p class="categories"><a href="/categories/%E5%8D%8E%E4%B8%BA%E4%BA%91/">华为云</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-04T15:25:36.000Z">2024-02-04</time></p><p class="title"><a href="/2024/02/04/K8s/%E5%8D%8E%E4%B8%BA%E4%BA%91/%E5%A6%82%E4%BD%95%E5%9C%A8%E5%8D%8E%E4%B8%BA%E4%BA%91%E6%AC%A7%E6%8B%89%E7%B3%BB%E7%BB%9F-ECS-%E5%AE%9E%E4%BE%8B%E6%96%B0%E5%BB%BA%E7%A7%81%E6%9C%89-REPO-%E6%BA%90%E5%B9%B6%E5%88%B6%E4%BD%9C%E5%AE%89%E5%85%A8-RPM-%E5%8C%85/">如何在华为云欧拉系统 ECS 实例新建私有 REPO 源并制作安全 RPM 包</a></p><p class="categories"><a href="/categories/%E5%8D%8E%E4%B8%BA%E4%BA%91/">华为云</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-31T03:02:03.000Z">2024-01-31</time></p><p class="title"><a href="/2024/01/31/%E5%BE%85%E5%8F%91%E5%B8%83/IT%20%E8%B5%84%E4%BA%A7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%20OCSInventory-NG%20%E8%AE%A4%E7%9F%A5/">IT 资产管理系统 OCSInventory-NG 认知</a></p><p class="categories"><a href="/categories/OCSInventory-NG/">OCSInventory-NG</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/AIGC/"><span class="level-start"><span class="level-item">AIGC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/AdaFace/"><span class="level-start"><span class="level-item">AdaFace</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ajax/"><span class="level-start"><span class="level-item">Ajax</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ansible/"><span class="level-start"><span class="level-item">Ansible</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/AppCube/"><span class="level-start"><span class="level-item">AppCube</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/BPF/"><span class="level-start"><span class="level-item">BPF</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Bind9/"><span class="level-start"><span class="level-item">Bind9</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CI-CD/"><span class="level-start"><span class="level-item">CI/CD</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CSS/"><span class="level-start"><span class="level-item">CSS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ceph/"><span class="level-start"><span class="level-item">Ceph</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2024/02/"><span class="level-start"><span class="level-item">二月 2024</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2024/01/"><span class="level-start"><span class="level-item">一月 2024</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/12/"><span class="level-start"><span class="level-item">十二月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/11/"><span class="level-start"><span class="level-item">十一月 2023</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/10/"><span class="level-start"><span class="level-item">十月 2023</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Kubernetes/"><span class="tag">Kubernetes</span><span class="tag is-grey-lightest">92</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag is-grey-lightest">38</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ansible/"><span class="tag">Ansible</span><span class="tag is-grey-lightest">25</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ceph/"><span class="tag">Ceph</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Docker/"><span class="tag">Docker</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JAVA/"><span class="tag">JAVA</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go/"><span class="tag">Go</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OpenShift/"><span class="tag">OpenShift</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DNS/"><span class="tag">DNS</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OKD/"><span class="tag">OKD</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/"><span class="tag">程序人生</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/selenium/"><span class="tag">selenium</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%B9%E5%99%A8/"><span class="tag">容器</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C/"><span class="tag">网络</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CKA/"><span class="tag">CKA</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GO/"><span class="tag">GO</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ISCSI/"><span class="tag">ISCSI</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NFS/"><span class="tag">NFS</span><span class="tag is-grey-lightest">3</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="山河已无恙" height="28"></a><p class="size-small"><span>&copy; 2024 山河已无恙</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© <a href="http://www.beian.miit.gov.cn/" target="_blank">备案中</a><br></span><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已运行 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！❤️";
        }var now = new Date();setInterval("createTime('2021/6/26 21:27:00')", 250,"");</script><br></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2364053447" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/katex.min.css"><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/katex.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/contrib/auto-render.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/contrib/mhchem.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdnjs.loli.net/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('9fdc9739266d48d5f62e','c1cc33697d099a2197650ec9dadcb16bd4904655','LIRUILONGS','blog_comment',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(true){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('9fdc9739266d48d5f62e','c1cc33697d099a2197650ec9dadcb16bd4904655','LIRUILONGS','blog_comment',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>