<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>关于 Linux 中安全方面的一些笔记 - 山河已无恙</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="山河已无恙"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="山河已无恙"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="笔记是学习整理的，适合基线扫描参考，常见运维安全Demo。 整理了一份，希望对小伙伴有帮助.生活加油,天天开心！ 博文主要围绕以几个方面： Linux基本防护：账户安全、文件系统安全、关闭不需要的服务 用户切换与提权su和sudo, sshd访问控制 加密与解密&amp;#x2F;对称加密、非对称加密、md5息摘要 AIDE入侵检测 端口扫描"><meta property="og:type" content="blog"><meta property="og:title" content="山河已无恙"><meta property="og:url" content="https://liruilong.blog.csdn.net/?t=1&amp;type=blog"><meta property="og:site_name" content="山河已无恙"><meta property="og:description" content="笔记是学习整理的，适合基线扫描参考，常见运维安全Demo。 整理了一份，希望对小伙伴有帮助.生活加油,天天开心！ 博文主要围绕以几个方面： Linux基本防护：账户安全、文件系统安全、关闭不需要的服务 用户切换与提权su和sudo, sshd访问控制 加密与解密&amp;#x2F;对称加密、非对称加密、md5息摘要 AIDE入侵检测 端口扫描"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://liruilong.blog.csdn.net/img/头像.jpg"><meta property="article:published_time" content="2021-07-30T01:39:39.000Z"><meta property="article:modified_time" content="2023-06-21T11:25:59.089Z"><meta property="article:author" content="LIRUILONGS"><meta property="article:tag" content="Liunx"><meta property="article:tag" content="安全"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/头像.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://liruilongs.github.io/2021/07/30/Linux/%E5%85%B3%E4%BA%8E%20Linux%20%E4%B8%AD%E5%AE%89%E5%85%A8%E6%96%B9%E9%9D%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/"},"headline":"山河已无恙","image":["https://img-blog.csdnimg.cn/4205473f4fa74c6c8dafd91ba37ad9b1.png","https://img-blog.csdnimg.cn/8a69411ce37c4b98bb4df1873885c552.png"],"datePublished":"2021-07-30T01:39:39.000Z","dateModified":"2023-06-21T11:25:59.089Z","author":{"@type":"Person","name":"山河已无恙"},"description":"笔记是学习整理的，适合基线扫描参考，常见运维安全Demo。 整理了一份，希望对小伙伴有帮助.生活加油,天天开心！ 博文主要围绕以几个方面： Linux基本防护：账户安全、文件系统安全、关闭不需要的服务 用户切换与提权su和sudo, sshd访问控制 加密与解密&#x2F;对称加密、非对称加密、md5息摘要 AIDE入侵检测 端口扫描"}</script><link rel="canonical" href="https://liruilongs.github.io/2021/07/30/Linux/%E5%85%B3%E4%BA%8E%20Linux%20%E4%B8%AD%E5%AE%89%E5%85%A8%E6%96%B9%E9%9D%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/"><link rel="alternate" href="/path/to/atom.xml" title="山河已无恙" type="application/atom+xml"><link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Oxanium:wght@300;400;600&amp;family=Roboto+Mono"><link rel="stylesheet" href="/css/cyberpunk.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?3f06f2b732a5b1034c989f74e28d0eea";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css"><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.2"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="山河已无恙" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/media">影音</a><a class="navbar-item" href="/album">相册</a><a class="navbar-item" href="/friend">友链</a><a class="navbar-item" href="/self-talking">生活小记</a><a class="navbar-item" href="/message">留言墙</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Gitee" href="https://gitee.com/liruilonger"><i class="fab fa-git-square fa-1x"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/LIRUILONGS"><i class="fab fa-github fa-1x"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul fa-1x"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search fa-1x"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon fa-1x" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2021-07-30  <a class="commentCountImg" href="/2021/07/30/Linux/%E5%85%B3%E4%BA%8E%20Linux%20%E4%B8%AD%E5%AE%89%E5%85%A8%E6%96%B9%E9%9D%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/#comment-container"><span class="display-none-class">16dde879a39607184f9318798b0a72d5</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="16dde879a39607184f9318798b0a72d5">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>1 小时  <i class="fas fa-pencil-alt"> </i>13.1 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">关于 Linux 中安全方面的一些笔记</h1><div class="content"><ul>
<li>笔记是学习整理的，适合<code>基线扫描</code>参考，常见<code>运维安全Demo</code>。</li>
<li>整理了一份，希望对小伙伴有帮助.生活加油,天天开心！</li>
<li>博文主要围绕以几个方面：<ul>
<li><code>Linux基本防护</code>：<code>账户安全</code>、<code>文件系统安全</code>、<code>关闭不需要的服务</code></li>
<li><code>用户切换</code>与<code>提权su</code>和<code>sudo</code>,</li>
<li><code>sshd访问控制</code></li>
<li><code>加密与解密/对称加密</code>、<code>非对称加密</code>、<code>md5息摘要</code></li>
<li><code>AIDE入侵检测</code></li>
<li><code>端口扫描</code></li>
</ul>
</li>
</ul>
<span id="more"></span>
<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><hr>
<ul>
<li>笔记是学习整理的，适合<code>基线扫描</code>参考，常见<code>运维安全Demo</code>。</li>
<li>整理了一份，希望对小伙伴有帮助.生活加油,天天开心！</li>
<li>博文主要围绕以几个方面：<ul>
<li><code>Linux基本防护</code>：<code>账户安全</code>、<code>文件系统安全</code>、<code>关闭不需要的服务</code></li>
<li><code>用户切换</code>与<code>提权su</code>和<code>sudo</code>,</li>
<li><code>sshd访问控制</code></li>
<li><code>加密与解密/对称加密</code>、<code>非对称加密</code>、<code>md5息摘要</code></li>
<li><code>AIDE入侵检测</code></li>
<li><code>端口扫描</code></li>
</ul>
</li>
</ul>
<h1 id="一、Linux基本防护"><a href="#一、Linux基本防护" class="headerlink" title="一、Linux基本防护"></a><font color=tomato>一、Linux基本防护</font></h1><table>
<thead>
<tr>
<th align="left">一、Linux基本防护</th>
</tr>
</thead>
<tbody><tr>
<td align="left">账户安全:设置账户有效期,锁定与解锁账户密码,修</td>
</tr>
<tr>
<td align="left">改登陆信息</td>
</tr>
<tr>
<td align="left">文件系统安全:修改</td>
</tr>
<tr>
<td align="left">文件 ATTR属性,设置mount挂载</td>
</tr>
<tr>
<td align="left">关闭不需要的服务</td>
</tr>
</tbody></table>
<hr>
<table>
<thead>
<tr>
<th align="left"><font color=brown>设置账号有效期</font></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong><font color=red>使用chage工具</font></strong></td>
</tr>
<tr>
<td align="left"><code>-d 0</code>, 强制修改密码</td>
</tr>
<tr>
<td align="left"><code>-E yyyy-mm-dd</code>，指定失效日期(-1 取消)</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##创建账户dachui</span></span><br><span class="line">[root@liruilong ~]$ useradd dachui</span><br><span class="line"><span class="comment">####查看账户dachui的过期时间</span></span><br><span class="line">[root@liruilong ~]$ chage -l dachui</span><br><span class="line">最近一次密码修改时间 ：8月 18, 2020</span><br><span class="line">密码过期时间 ：从不</span><br><span class="line">密码失效时间 ：从不</span><br><span class="line">帐户过期时间 ：从不 <span class="comment">##永不过期</span></span><br><span class="line">两次改变密码之间相距的最小天数 ：0</span><br><span class="line">两次改变密码之间相距的最大天数 ：99999</span><br><span class="line">在密码过期之前警告的天数 ：7</span><br><span class="line"><span class="comment">###-E 指定账户dachui的过期时间</span></span><br><span class="line">[root@liruilong ~]$ chage -E 2029-10-01 dachui</span><br><span class="line">[root@liruilong ~]$ chage -l dachui</span><br><span class="line">最近一次密码修改时间 ：8月 18, 2020</span><br><span class="line">密码过期时间 ：从不</span><br><span class="line">密码失效时间 ：从不</span><br><span class="line">帐户过期时间 ：10月 01, 2029 <span class="comment">##过期时间指定</span></span><br><span class="line">两次改变密码之间相距的最小天数 ：0</span><br><span class="line">两次改变密码之间相距的最大天数 ：99999</span><br><span class="line">在密码过期之前警告的天数 ：7</span><br><span class="line"><span class="comment">###-E 后跟数字-1，代表取消账户的过期时间设置</span></span><br><span class="line">[root@liruilong ~]$ chage -E -1 dachui</span><br><span class="line">[root@liruilong ~]$ chage -l dachui</span><br><span class="line">最近一次密码修改时间 ：8月 18, 2020</span><br><span class="line">密码过期时间 ：从不</span><br><span class="line">密码失效时间 ：从不</span><br><span class="line">帐户过期时间 ：从不 <span class="comment">##账户永不过期</span></span><br><span class="line">两次改变密码之间相距的最小天数 ：0</span><br><span class="line">两次改变密码之间相距的最大天数 ：99999</span><br><span class="line">在密码过期之前警告的天数 ：7</span><br></pre></td></tr></table></figure>
<p><strong><font color=camel>设置强制要求用户修改密码 <code>-d 0</code> 案例</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########设置强制要求用户修改密码 -d 0 案例</span></span><br><span class="line"><span class="comment">##第一步：给用户dachui设置密码</span></span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> 123456 | passwd --stdin dachui</span><br><span class="line">更改用户 dachui 的密码 。</span><br><span class="line">passwd：所有的身份验证令牌已经成功更新。</span><br><span class="line"><span class="comment">##第二步：使用dachui用户远程本机</span></span><br><span class="line">[root@liruilong ~]$ ssh dachui@127.0.0.1</span><br><span class="line">......</span><br><span class="line">dachui@127.0.0.1 s password: <span class="comment">#输入密码123456</span></span><br><span class="line">[dachui@liruilong ~]$ <span class="comment">#可以登录，ctrl + D 退出</span></span><br><span class="line"><span class="comment">##第三步：管理员设置dachui用户必须修改密码，否则无法登录</span></span><br><span class="line">[root@liruilong ~]$ chage -d 0 dachui</span><br><span class="line"><span class="comment">##第四步：重新使用dachui用户远程本机，需要重新设置密码</span></span><br><span class="line"><span class="comment">#因为是普通用户，权限低，所以密码必须是8位以上，字母和数字(tarena123)</span></span><br><span class="line">[root@liruilong ~]$ ssh dachui@127.0.0.1</span><br><span class="line">dachui@127.0.0.1s password: <span class="comment">#输入密码123456</span></span><br><span class="line">You are required to change your password immediately (root enforced)</span><br><span class="line">Last failed login: Tue Aug 18 08:38:45 CST 2020 from localhost on ssh:notty</span><br><span class="line">There was 1 failed login attempt since the last successful login.</span><br><span class="line">Last login: Tue Aug 18 08:33:19 2020 from localhost</span><br><span class="line">WARNING: Your password has expired.</span><br><span class="line">You must change your password now and login again!</span><br><span class="line">Changing password <span class="keyword">for</span> user dachui.</span><br><span class="line">Changing password <span class="keyword">for</span> dachui.</span><br><span class="line">(current) UNIX password: <span class="comment">#输入以前的密码123456</span></span><br><span class="line">New password: <span class="comment">#设置新的密码为123，太过简单无法通过</span></span><br><span class="line">BAD PASSWORD: The password is too similar to the old one</span><br><span class="line">New password: <span class="comment">#设置新的密码为654321，密码最少是8位</span></span><br><span class="line">BAD PASSWORD: The password is shorter than 8 characters</span><br><span class="line">New password: <span class="comment">#设置新的密码：tarena123</span></span><br><span class="line">Retype new password: <span class="comment">#重新输入新密码：tarena123</span></span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br><span class="line">Connection to 127.0.0.1 closed.</span><br><span class="line"><span class="comment">#第五步：重新使用账户dachui远程本机</span></span><br><span class="line">[root@liruilong ~]$ ssh dachui@127.0.0.1</span><br><span class="line">dachui@127.0.0.1s password: <span class="comment">#输入密码：tarena123</span></span><br><span class="line">Last login: Tue Aug 18 08:38:49 2020 from localhost</span><br><span class="line">[dachui@liruilong ~]$ <span class="comment">#ctrl + D 登出</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="账号的锁定-x2F-解锁"><a href="#账号的锁定-x2F-解锁" class="headerlink" title="账号的锁定&#x2F;解锁"></a><font color=seagreen>账号的锁定&#x2F;解锁</font></h3><p> <strong><font color=blue>使用passwd命令:  <code>-l 锁定、-u 解锁、-S 看状态</code></font></strong></p>
<p><img src="https://img-blog.csdnimg.cn/bd75fd65a014498bb42f8cf947b498c6.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####-S(大写) 查看用户dachui密码的状态</span></span><br><span class="line">[root@liruilong ~]$ passwd -S dachui</span><br><span class="line">dachui PS 2020-08-18 0 99999 7 -1 (密码已设置，使用 SHA512 算法。)</span><br><span class="line"><span class="comment">###-l 锁定dachui账户</span></span><br><span class="line">[root@liruilong ~]$ passwd -l dachui</span><br><span class="line">锁定用户 dachui 的密码 。</span><br><span class="line">passwd: 操作成功</span><br><span class="line"><span class="comment">####-S(大写) 查看用户dachui密码的状态,密码被锁定，无法登录使用</span></span><br><span class="line">[root@liruilong ~]$ passwd -S dachui</span><br><span class="line">dachui LK 2020-08-18 0 99999 7 -1 (密码已被锁定。)</span><br><span class="line"><span class="comment">###使用账户dachui远程本机,无法登录</span></span><br><span class="line">[root@liruilong ~]$ ssh dachui@127.0.0.1</span><br><span class="line">dachui@127.0.0.1<span class="string">&#x27;s password: #密码为: tarena123</span></span><br><span class="line"><span class="string">Permission denied, please try again.</span></span><br><span class="line"><span class="string">dachui@127.0.0.1&#x27;</span>s password:</span><br><span class="line"><span class="comment">###-u 解锁dachui账户</span></span><br><span class="line">[root@liruilong ~]$ passwd -u dachui</span><br><span class="line">解锁用户 dachui 的密码。</span><br><span class="line">passwd: 操作成功</span><br><span class="line"><span class="comment">###重新使用账户dachui远程本机,可以登录</span></span><br><span class="line">[root@liruilong ~]$ ssh dachui@127.0.0.1</span><br><span class="line">dachui@127.0.0.1s password: <span class="comment">#密码为: tarena123</span></span><br><span class="line">Last failed login: Tue Aug 18 08:55:30 CST 2020 from localhost on ssh:notty</span><br><span class="line">There was 1 failed login attempt since the last successful login.</span><br><span class="line">Last login: Tue Aug 18 08:46:50 2020 from localhost</span><br><span class="line">[dachui@liruilong ~]$ <span class="comment">#ctrl + D 退出登录</span></span><br><span class="line">Connection to 127.0.0.1 closed.</span><br><span class="line"><span class="comment">#####-S(大写) 重新查看用户dachui密码的状态，已解锁</span></span><br><span class="line">[root@liruilong ~]$ passwd -S dachui</span><br><span class="line">dachui PS 2020-08-18 0 99999 7 -1 (密码已设置，使用 SHA512 算法。)</span><br></pre></td></tr></table></figure>
<h3 id="强制定期修改密码"><a href="#强制定期修改密码" class="headerlink" title="强制定期修改密码"></a><font color=camel>强制定期修改密码</font></h3><ul>
<li><strong><font color=amber>配置文件 &#x2F;etc&#x2F;login.defs</font></strong></li>
<li><strong><font color=orange>主要控制属性</font></strong></li>
</ul>
<table>
<thead>
<tr>
<th align="left">主要控制属性</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>PASS_MAX_DAYS</code> —》 用户密码的最长有效期</td>
</tr>
<tr>
<td align="left"><code>PASS_MIN_DAYS</code> —》 用户密码的最短有效期</td>
</tr>
<tr>
<td align="left"><code>PASS_WARN_AGE</code> —》 用户密码过期的前几天会发送警告信息</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#######此管理用户密码的操作，只会对后面创建的用户生效，以前的则不影响</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/login.defs</span><br><span class="line">......</span><br><span class="line">25 PASS_MAX_DAYS 60 <span class="comment">#一个密码最长可以使用60天</span></span><br><span class="line">26 PASS_MIN_DAYS 0 <span class="comment">#一个密码最少要用多少天，否则无法修改,0不设置</span></span><br><span class="line">27 PASS_MIN_LEN 5 <span class="comment">#密码的最少长度为5</span></span><br><span class="line">28 PASS_WARN_AGE 7 <span class="comment">#密码过期的前7天，对用户发送警告信息</span></span><br><span class="line">......</span><br><span class="line"><span class="comment">#####对当前用户的密码进行管理，/etc/shadow 为用户密码的配置文件</span></span><br><span class="line"><span class="comment">###用户密码的最长有效期为99999，可以直接修改配置文件对以前的用户进行密码管理</span></span><br><span class="line">[root@liruilong ~]$ cat /etc/shadow | head -3</span><br><span class="line">root:$6<span class="variable">$l2XJYza</span>/aL1Ug4Ta<span class="variable">$4kBxc4ED</span>.pyWbBR5Yg3XVX/3lT3S0Efuh4eNxC83AdIlYDeEzcafsbV</span><br><span class="line">8YkVo88T0W/vVDTxpYtiFceiUM9qQk0::0:99999:7:::</span><br><span class="line">bin:*:17632:0:99999:7:::</span><br><span class="line">daemon:*:17632:0:99999:7:::</span><br></pre></td></tr></table></figure>
<h3 id="伪装登录提示"><a href="#伪装登录提示" class="headerlink" title="伪装登录提示"></a><font color=purple>伪装登录提示</font></h3><table>
<thead>
<tr>
<th align="left">伪装登录提示</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong><font color=camel>配置文件 &#x2F;etc&#x2F;issue、&#x2F;etc&#x2F;issue.net</font></strong></td>
</tr>
<tr>
<td align="left"><code>分别使用于本地、远程登录</code></td>
</tr>
<tr>
<td align="left"><code>默认会提示内核、系统等版本信息</code></td>
</tr>
</tbody></table>
<p>这个 <code>centos7</code> 可能有点问题，可以写到 .bashrc 文件里：.bashrc文件通常也是通过某个bash启动文件来运行的。因为.bashrc文件会运行两次：一次是 当你登入bash shell时，另一次是当你启动一个bash shell时。如果你需要一个脚本在两个时刻都得 以运行，可以把这个脚本放进该文件中。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####修改本地用户登录的提示信息</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/issue</span><br><span class="line">Welcome to Tedu</span><br><span class="line"><span class="comment">#####修改网络用户登录的提示信息,远程登录时显示，ssh默认关闭此功能</span></span><br><span class="line"><span class="comment">##可以不修改</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/issue.net</span><br><span class="line">Welcome to Ted</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/0b5754c98a354cc48ce103a90c02629a.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="文件系统安全"><a href="#文件系统安全" class="headerlink" title="文件系统安全"></a><font color=seagreen>文件系统安全</font></h2><h3 id="锁定-x2F-解锁保护文件"><a href="#锁定-x2F-解锁保护文件" class="headerlink" title="锁定&#x2F;解锁保护文件"></a><font color=blue>锁定&#x2F;解锁保护文件</font></h3><ul>
<li><font color=royalblue>文件属性控制</font>：<code>chattr、lsattr</code></li>
<li><font color=yellowgreen>、- 控制方式</font><ul>
<li><code>属性i</code>：<font color=camel>不可变 (immutable)</font></li>
<li><code>属性a</code>: <font color=green>仅可追加(append only)</font></li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/4205473f4fa74c6c8dafd91ba37ad9b1.png" alt="在这里插入图片描述"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">######创建一个测试文件</span></span><br><span class="line">[root@liruilong ~]$ vim test.sh</span><br><span class="line">hello the world</span><br><span class="line">ni hao.</span><br><span class="line"><span class="comment">#########文件如果有i的属性，则对于此文件，增删改查均无法操作</span></span><br><span class="line"><span class="comment">##lsattr 查看文件的属性</span></span><br><span class="line">[root@liruilong ~]$ lsattr test.sh</span><br><span class="line">---------------- test.sh</span><br><span class="line"><span class="comment">##chattr 给文件test.sh增加i的属性</span></span><br><span class="line">[root@liruilong ~]$ chattr +i test.sh</span><br><span class="line"><span class="comment">##查看文件test.sh属性</span></span><br><span class="line">[root@liruilong ~]$ lsattr test.sh</span><br><span class="line">----i----------- test.sh</span><br><span class="line"><span class="comment">##测试，写入操作和删除操作都无法进行</span></span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> 123 &gt; test.sh</span><br><span class="line">-bash: test.sh: 权限不够</span><br><span class="line">[root@liruilong ~]$ rm -rf test.sh</span><br><span class="line">rm: 无法删除<span class="string">&quot;test.sh&quot;</span>: 不允许的操作</span><br><span class="line"><span class="comment">##取消文件test.sh的i的属性，通过lsattr查看</span></span><br><span class="line">[root@liruilong ~]$ chattr -i test.sh</span><br><span class="line">[root@liruilong ~]$ lsattr test.sh</span><br><span class="line">---------------- test.sh</span><br><span class="line"><span class="comment">#########文件如果有a的属性，则对于此文件，只能执行追加的操作</span></span><br><span class="line"><span class="comment">####对于日志文件执行a属性，防止内容被篡改</span></span><br><span class="line"><span class="comment">##给文件test.sh增加一个a属性，lsattr查看</span></span><br><span class="line">[root@liruilong ~]$ chattr +a test.sh</span><br><span class="line">[root@liruilong ~]$ lsattr test.sh</span><br><span class="line">-----a---------- test.sh</span><br><span class="line"><span class="comment">###测试，追加内容的操作可以进行，写入，删除失败</span></span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> 123 &gt;&gt; test.sh</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> 123 &gt; test.sh</span><br><span class="line">-bash: test.sh: 不允许的操作</span><br><span class="line">[root@liruilong ~]$ rm -rf test.sh</span><br><span class="line">rm: 无法删除<span class="string">&quot;test.sh&quot;</span>: 不允许的操作</span><br><span class="line"><span class="comment">##取消文件test.sh的a的属性，通过lsattr查看</span></span><br><span class="line">[root@liruilong ~]$ chattr -a test.sh</span><br><span class="line">[root@liruilong ~]$ lsattr test.sh</span><br><span class="line">---------------- test.sh</span><br></pre></td></tr></table></figure>
<h3 id="文件系统挂载熟悉"><a href="#文件系统挂载熟悉" class="headerlink" title="文件系统挂载熟悉"></a><font color=red>文件系统挂载熟悉</font></h3><p><strong><font color=yellowgreen>mount 挂载属性</font></strong></p>
<ul>
<li><strong><font color=seagreen>noexec: 不可执行程序</font></strong></li>
<li><strong><font color=plum>noatime: 不更新文件的访问时间</font></strong></li>
</ul>
<blockquote>
<p><strong>noexec</strong>:<br><font color=royalblue>挂载设备时，添加此选项，则此设备中的所有程序均不可被执行(例如：病毒或木马)</font><br><strong>noatime</strong>:<br><font color=plum>计算机中的文件都有访问时间(atime)，修改时间(mtime)；<br>挂载设备时，添加此选项，则所有文件的访问时间都不再被更新；<br>如果计算机中的a文件被用户访问，则a文件的atime就会被修改，对于web服务器而言，会有成千上万的<br>用户访问网页，则这个网页的atime就会被频繁修改，会消耗大量的CPU资源，需要在挂载的时候使用</font></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#########boot分区挂载示例，其他挂载方法类似</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/fstab</span><br><span class="line">UUID=c120742d-5bdf-48c3-b830-3bfb3e796009 /boot xfs</span><br><span class="line">defaults,noexec,noatime 0 0</span><br><span class="line"><span class="comment">###-o remount 重新挂载,让配置生效</span></span><br><span class="line">[root@liruilong ~]$ mount -o remount /boot/</span><br><span class="line"><span class="comment">###查看挂载的属性，/boot分区下，有了noexec,noatime</span></span><br><span class="line">[root@liruilong ~]$ mount</span><br><span class="line">......</span><br><span class="line">/dev/sda1 on /boot <span class="built_in">type</span> xfs (rw,noexec,noatime,attr2,inode64,noquota)</span><br><span class="line">......</span><br><span class="line"><span class="comment">#####定义一个不断输出a的脚本，赋予x执行权限，却无法运行</span></span><br><span class="line">[root@liruilong ~]$ vim /boot/test.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> a</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">##必须是在/boot/目录下，执行脚本</span></span><br><span class="line">[root@liruilong ~]$ <span class="built_in">cd</span> /boot</span><br><span class="line">[root@liruilong boot]$ chmod +x test.sh</span><br><span class="line">[root@liruilong boot]$ ./test.sh</span><br><span class="line">-bash: ./test.sh: 权限不够</span><br></pre></td></tr></table></figure>

<h3 id="程序和服务控制"><a href="#程序和服务控制" class="headerlink" title="程序和服务控制"></a><font color=red>程序和服务控制</font></h3><ul>
<li><font color=tomato>禁用非必要的系统服务</font>: 使用systemctl、chkconfig (centos6使用) 工具</li>
<li><font color=blue>可选服务列表</font>(选择进行关闭)</li>
</ul>
<table>
<thead>
<tr>
<th><strong><font color=brown>可选服务列表</font></strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>cups</code>.service 打印服务</td>
</tr>
<tr>
<td><code>postfix</code>.service 邮件服务</td>
</tr>
<tr>
<td><code>NetworkManager</code>.service 网络管理服务(network可以替代)</td>
</tr>
<tr>
<td><code>firewalld</code> 防火墙 (iptables可以替代)</td>
</tr>
<tr>
<td><code>atd</code>.service 一次性计划任务(crond可以替代)</td>
</tr>
<tr>
<td><code>bluetooth</code>.service 蓝牙服务</td>
</tr>
<tr>
<td><code>autofs</code>.service 自动挂载</td>
</tr>
<tr>
<td><code>pcscd</code>.service 智能卡设备资源管理器</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####停止服务，并设置为开机不会自动启动</span></span><br><span class="line">[root@liruilong ~]$ systemctl stop firewalld</span><br><span class="line">[root@liruilong ~]$ systemctl <span class="built_in">disable</span> firewalld</span><br></pre></td></tr></table></figure>


<h1 id="二、用户切换与提权"><a href="#二、用户切换与提权" class="headerlink" title="二、用户切换与提权"></a><font color=chocolate>二、用户切换与提权</font></h1><h2 id="su切换用户身份"><a href="#su切换用户身份" class="headerlink" title="su切换用户身份"></a><font color=red>su切换用户身份</font></h2><h3 id="切换与提权的应用场景"><a href="#切换与提权的应用场景" class="headerlink" title="切换与提权的应用场景"></a><font color=seagreen>切换与提权的应用场景</font></h3><ul>
<li><code>切换用户身份，When?:</code>SSH远程管理&#x2F;运维测试</li>
<li><code>提升执行权限，when?:</code>管理权限细分</li>
</ul>
<h3 id="su切换的基本用法-Substitube-User，换人"><a href="#su切换的基本用法-Substitube-User，换人" class="headerlink" title="su切换的基本用法:Substitube User，换人"></a><font color=brown>su切换的基本用法:Substitube User，换人</font></h3><ul>
<li>快速切换为指定的其他用户</li>
<li>普通用户执行时，需验证目标用户的口令</li>
<li>root执行时，无需验证口令</li>
</ul>
<p>命令格式</p>
<ul>
<li>用法1：su [-] [目标用户]</li>
<li>用法2：su [-] -c “命令” [目标用户]</li>
</ul>
<h3 id="su操作示例"><a href="#su操作示例" class="headerlink" title="su操作示例"></a><font color=chocolate>su操作示例</font></h3><p><strong><font color=purple>从普通用户切换为root，并登录新Shell环境,执行 su -，或者su - root,不指名目标用户时，默认视为root</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####创建新的用户jerry，并设置密码为123456</span></span><br><span class="line">[root@liruilong ~]$ useradd jerry</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> 123456 | passwd --stdin jerry</span><br><span class="line">更改用户 jerry 的密码 。</span><br><span class="line">passwd：所有的身份验证令牌已经成功更新。</span><br><span class="line"><span class="comment">###从root用户切换到jerry用户</span></span><br><span class="line">[root@liruilong ~]$ su - jerry</span><br><span class="line"><span class="comment">###查看当前当前登录的用户身份为jerry，普通用户的权限很低</span></span><br><span class="line">[jerry@liruilong ~]$ whoami</span><br><span class="line">jerry</span><br><span class="line">[jerry@liruilong ~]$ cat /etc/shadow</span><br><span class="line">cat: /etc/shadow: Permission denied</span><br><span class="line">[jerry@liruilong ~]$ ls /root/</span><br><span class="line">ls: cannot open directory /root/: Permission denied</span><br><span class="line">[jerry@liruilong ~]$ <span class="built_in">exit</span> <span class="comment">#退出jerry用户登录状态</span></span><br><span class="line"><span class="built_in">logout</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####创建新的用户tom，并设置密码为123456</span></span><br><span class="line">[root@liruilong ~]$ useradd tom</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> 123456 | passwd --stdin tom</span><br><span class="line">更改用户 tom 的密码 。</span><br><span class="line">passwd：所有的身份验证令牌已经成功更新。</span><br><span class="line"><span class="comment">###从root用户切换到jerry用户，管理员切换成普通用户身份不需要密码</span></span><br><span class="line">[root@liruilong ~]$ su - jerry</span><br><span class="line">上一次登录：二 8月 18 10:21:41 CST 2020pts/0 上</span><br><span class="line"><span class="comment">###从jerry用户切换到tom用户,普通用户身份的切换需要输入密码</span></span><br><span class="line">[jerry@liruilong ~]$ su - tom</span><br><span class="line">Password: <span class="comment">#输入tom用户的密码</span></span><br><span class="line">[tom@liruilong ~]$ <span class="built_in">exit</span> <span class="comment">#退出tom用户的登录</span></span><br><span class="line"><span class="built_in">logout</span></span><br><span class="line">[jerry@liruilong ~]$ <span class="built_in">exit</span> <span class="comment">#退出jerry用户的登录</span></span><br><span class="line"><span class="built_in">logout</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###从root用户切换到jerry用户，管理员切换成普通用户身份不需要密码</span></span><br><span class="line">[root@liruilong ~]$ su - jerry</span><br><span class="line">上一次登录：二 8月 18 10:23:02 CST 2020pts/0 上</span><br><span class="line"><span class="comment">###su - 后面不跟用户，则默认是切换到root用户下</span></span><br><span class="line">[jerry@liruilong ~]$ su -</span><br><span class="line">Password: <span class="comment">#输入管理员root的密码</span></span><br><span class="line">Last login: Tue Aug 18 10:23:53 CST 2020 on pts/0</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">exit</span> <span class="comment">#退出，回到jerry用户下</span></span><br><span class="line">[jerry@liruilong ~]$ <span class="built_in">exit</span> <span class="comment">#退出，回到最出的root解释器下</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p> <strong><font color=chocolate>root以指定的普通用户身份执行任务:以用户tom的身份创建目录,以用户tom的身份执行管理员操作会出错</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###-c 以普通用户jerry的身份执行一条命令</span></span><br><span class="line">[root@liruilong ~]$ su - jerry -c <span class="string">&quot;touch /tmp/test.txt&quot;</span></span><br><span class="line"><span class="comment">##查看文件的属性</span></span><br><span class="line">[root@liruilong ~]$ ll /tmp/test.txt</span><br><span class="line">-rw-rw-r-- 1 jerry jerry 0 8月 18 10:25 /tmp/test.txt</span><br><span class="line"><span class="comment">####错误，普通用户没有权利去重启sshd服务</span></span><br><span class="line">[root@liruilong ~]$ su - tom -c <span class="string">&quot;systemctl restart sshd&quot;</span></span><br><span class="line">Error creating textual authentication agent:</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p><strong><font color=blue>分析su切换的使用情况：安全日志 &#x2F;var&#x2F;log&#x2F;secure，记录su验证、Shell开启与关闭</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ tail -4 /var/<span class="built_in">log</span>/secure</span><br><span class="line">Aug 18 10:25:03 localhost su: pam_unix(su-l:session): session opened <span class="keyword">for</span> user</span><br><span class="line">jerry by root(uid=0)</span><br><span class="line">Aug 18 10:25:03 localhost su: pam_unix(su-l:session): session closed <span class="keyword">for</span> user</span><br><span class="line">jerry</span><br><span class="line">Aug 18 10:40:50 localhost su: pam_unix(su-l:session): session opened <span class="keyword">for</span> user</span><br><span class="line">tom by root(uid=0)</span><br><span class="line">Aug 18 10:40:51 localhost su: pam_unix(su-l:session): session closed <span class="keyword">for</span> user</span><br><span class="line">tom</span><br></pre></td></tr></table></figure>
<h2 id="sudo-提升执行权限"><a href="#sudo-提升执行权限" class="headerlink" title="sudo 提升执行权限"></a>sudo 提升执行权限</h2><h3 id="sudo提权的基本用法"><a href="#sudo提权的基本用法" class="headerlink" title="sudo提权的基本用法"></a>sudo提权的基本用法</h3><ul>
<li>Super or another Do，超级执行:管理员预先为用户设置执行许可,被授权用户有权执行授权的命令，验证自己的口令</li>
<li>执行提权命令:  用法： sudo 提权命令</li>
<li>查看提权命令: 用法：sudo -l</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/d5351b21f8994565bf8b24073d10b5bf.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="配置sudo提权"><a href="#配置sudo提权" class="headerlink" title="配置sudo提权"></a><font color=royalblue>配置sudo提权</font></h3><p><strong><font color=chocolate>修改方法</font></strong></p>
<ul>
<li><code>推荐：visudo</code></li>
<li><code>其他：vim /etc/sudoers ---&gt; wq!(强制保存并退出)</code>授权记录格式&#96;</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/d5351b21f8994565bf8b24073d10b5bf.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<blockquote>
<p><code>用户或组</code><br>#指定给特定用户授权或者组(多个用户属于一个组)<br>#指定给组授权时，组的前面必须加 %，例如：%wheel</p>
</blockquote>
<blockquote>
<p><code>主机列表</code><br>#允许哪些客户机可以通过这个用户登录本机去执行命令，例如：ALL(指所有客户机)<br><code>提权身份</code><br>#给第一列的用户赋予权限，例如:(root)</p>
</blockquote>
<blockquote>
<p><code>[NOPASSWD]</code>:命令列表 #前半部分是不需要密码执行命令；后半部分是要执行的命令，且；命令要写绝<br>对路径</p>
</blockquote>
<blockquote>
<p><code>%wheel ALL=(root) ALL</code>   #给wheel组中的所有用户，赋予root的权限，让其可以在任何主机上以root的身份去执行任何命令</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/10939310b7ea42989e82ba036e389b51.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong><font color=plum>允许mike以root权限执行 &#x2F;sbin&#x2F; 下的所有命令,但是，禁止修改eth0网卡的参数</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/sbin/* <span class="comment">#模糊匹配，/sbin/下的所有命令都可以用sudo提权使用</span></span><br><span class="line">!/sbin/ifconfg etho <span class="comment">#! 代表取反,该命令不能被sudo提权使用</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####sudo 提权，让普通用户jerry可以执行systemctl restart sshd 命令</span></span><br><span class="line">[root@liruilong ~]$ id jerry</span><br><span class="line">uid=1002(jerry) gid=1002(jerry) 组=1002(jerry)</span><br><span class="line"><span class="comment">####通过which命令，获取systemctl的绝对路径</span></span><br><span class="line">[jerry@liruilong ~]$ <span class="built_in">which</span> systemctl</span><br><span class="line">/bin/systemctl</span><br><span class="line"><span class="comment">###最后一行追加，允许jerry用户，可以以任何人的身份，从任何客户端，执行此命令</span></span><br><span class="line"><span class="comment">##立刻生效</span></span><br><span class="line">[root@liruilong ~]$ visudo</span><br><span class="line">......</span><br><span class="line">jerry ALL=(ALL) /usr/bin/systemctl</span><br><span class="line"><span class="comment">######测试，验证</span></span><br><span class="line"><span class="comment">##切换到jerry用户下</span></span><br><span class="line">[root@liruilong ~]$ su - jerry</span><br><span class="line">上一次登录：二 8月 18 10:50:16 CST 2020pts/0 上</span><br><span class="line"><span class="comment">####使用sudo提权命令，重启sshd服务</span></span><br><span class="line">[jerry@liruilong ~]$ sudo systemctl restart sshd</span><br><span class="line">[sudo] password <span class="keyword">for</span> jerry: <span class="comment">##jerry用户密码：123456</span></span><br><span class="line">Sorry, try again.</span><br><span class="line"><span class="comment">###sudo -l 查看jerry用户可以执行的sudo提权命令</span></span><br><span class="line">[jerry@liruilong ~]$ sudo -l</span><br><span class="line">......</span><br><span class="line">User jerry may run the following commands on liruilong:</span><br><span class="line">(ALL) /usr/bin/systemctl</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> <strong><font color=green>wheel组的用户无需验证可执行所有命令</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####通过which命令，获取parted分区命令的绝对路径</span></span><br><span class="line">[root@liruilong ~]$ <span class="built_in">which</span> parted</span><br><span class="line">/usr/sbin/parted</span><br><span class="line"><span class="comment">###最后一行追加,允许tom用户,可以以任何人的身份，从任何客户端，无密码使用parted命令</span></span><br><span class="line"><span class="comment">##立刻生效</span></span><br><span class="line">[root@liruilong ~]$ visudo</span><br><span class="line">......</span><br><span class="line">jerry ALL=(ALL) /usr/bin/systemctl</span><br><span class="line">tom ALL=(ALL) NOPASSWD:/usr/sbin/parted</span><br><span class="line"><span class="comment">######测试，验证</span></span><br><span class="line"><span class="comment">##切换到tom用户下</span></span><br><span class="line">[root@liruilong ~]$ su - tom</span><br><span class="line">上一次登录：二 8月 18 10:40:50 CST 2020pts/0 上</span><br><span class="line"><span class="comment">##sudo提权后，tom用户下，查看磁盘/dev/sda的分区情况</span></span><br><span class="line">[tom@liruilong ~]$ sudo parted /dev/sda <span class="built_in">print</span></span><br><span class="line">Model: VMware, VMware Virtual S (scsi)</span><br><span class="line">Disk /dev/sda: 21.5GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags:</span><br><span class="line">Number Start End Size Type File system Flags</span><br><span class="line">1 1049kB 1075MB 1074MB primary xfs boot</span><br><span class="line">2 1075MB 21.5GB 20.4GB primary lvm</span><br><span class="line">[tom@liruilong ~]$ <span class="built_in">exit</span> <span class="comment">#退出tom用户登录</span></span><br></pre></td></tr></table></figure>

<p><strong><font color=purple>分析sudo提权的使用情况: 修改全局配置，启动日志<code>Defaults logfile=&quot;/var/log/sudo&quot;</code></font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##########修改全局配置，启动的日志,该日志记录sudo提权的使用情况</span></span><br><span class="line"><span class="comment">##最后一行添加：Defaults logfile=&quot;/var/log/sudo&quot;</span></span><br><span class="line">[root@liruilong ~]$ visudo</span><br><span class="line">......</span><br><span class="line">jerry ALL=(ALL) /usr/bin/systemctl</span><br><span class="line">tom ALL=(ALL) NOPASSWD:/usr/sbin/parted</span><br><span class="line">Defaults logfile=<span class="string">&quot;/var/log/sudo&quot;</span></span><br><span class="line"><span class="comment">########验证日志信息，需先执行一次提权命令</span></span><br><span class="line">[root@liruilong ~]$ su - tom</span><br><span class="line">上一次登录：二 8月 18 10:56:52 CST 2020pts/0 上</span><br><span class="line"><span class="comment">##sudo提权后，tom用户下，查看磁盘/dev/sda的分区情况</span></span><br><span class="line">[tom@liruilong ~]$ sudo parted /dev/sda <span class="built_in">print</span></span><br><span class="line">Model: VMware, VMware Virtual S (scsi)</span><br><span class="line">Disk /dev/sda: 21.5GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags:</span><br><span class="line">Number Start End Size Type File system Flags</span><br><span class="line">1 1049kB 1075MB 1074MB primary xfs boot</span><br><span class="line">2 1075MB 21.5GB 20.4GB primary lvm</span><br><span class="line">[tom@liruilong ~]$ <span class="built_in">exit</span> <span class="comment">#退出tom用户的登录状态</span></span><br><span class="line"><span class="comment">######查看日志，看看sudo提权的使用信息</span></span><br><span class="line">[root@liruilong ~]$ cat /var/<span class="built_in">log</span>/sudo</span><br><span class="line">Aug 18 13:02:12 : jerry : TTY=pts/0 ; PWD=/home/jerry ; USER=root ;</span><br><span class="line">COMMAND=/bin/systemctl restart sshd</span><br><span class="line">Aug 18 13:18:34 : tom : TTY=pts/0 ; PWD=/home/tom ; USER=root ;</span><br><span class="line">COMMAND=/sbin/parted /dev/sda <span class="built_in">print</span></span><br></pre></td></tr></table></figure>
<h1 id="三、sshd访问控制"><a href="#三、sshd访问控制" class="headerlink" title="三、sshd访问控制"></a><font color=brown>三、sshd访问控制</font></h1><h2 id="SSH基本防护"><a href="#SSH基本防护" class="headerlink" title="SSH基本防护"></a><font color=chocolate>SSH基本防护</font></h2><h3 id="SSH防护概述"><a href="#SSH防护概述" class="headerlink" title="SSH防护概述"></a>SSH防护概述</h3><ul>
<li>存在的安全隐患<ul>
<li>密码嗅探、键盘记录</li>
<li>暴力枚举账号、猜解密码</li>
</ul>
</li>
<li>常见的防护措施<ul>
<li>用户限制、黑白名单</li>
<li>更改验证方式(密码 –&gt; 密钥对)</li>
<li>防火墙….</li>
</ul>
</li>
</ul>
<h3 id="sshd基本安全配置"><a href="#sshd基本安全配置" class="headerlink" title="sshd基本安全配置"></a><font color=royalblue>sshd基本安全配置</font></h3><p><font color=plum>配置文件</font> <code>/etc/ssh/sshd_config</code></p>
<ul>
<li>Port 3389 &#x2F;&#x2F;改用非标准端口</li>
<li>ListenAddress 192.168.168.174</li>
<li>PermitrootLogin &#x2F;&#x2F;禁止root登录</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####修改ssh配置时，先备份sshd主配置文件</span></span><br><span class="line">[root@liruilong ~]$ cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak</span><br><span class="line"><span class="comment">####修改虚拟机ssh远程连接得端口为3389</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/ssh/sshd_config</span><br><span class="line">17 Port 3389</span><br><span class="line"><span class="comment">##重启sshd服务</span></span><br><span class="line">[root@liruilong ~]$ systemctl restart sshd</span><br><span class="line"><span class="comment">#xshell测试使用ssh远程时必须加端口号3389</span></span><br><span class="line">[c:\~]$ ssh root@192.168.2.100 3389</span><br><span class="line"><span class="comment">####用户只能通过192.168.2.100这个IP地址远程liruilong这台虚拟机</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/ssh/sshd_config</span><br><span class="line">20 ListenAddress 192.168.2.100</span><br><span class="line"><span class="comment">##重启sshd服务，虚拟机新添加网卡配置其他IP地址测试</span></span><br><span class="line">[root@liruilong ~]$ systemctl restart sshd</span><br><span class="line"><span class="comment">#xshell测试使用ssh远程时必须加端口号3389</span></span><br><span class="line">[c:\~]$ ssh root@192.168.2.100 3389</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####禁止root远程登录虚拟机liruilong</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/ssh/sshd_config</span><br><span class="line">38 PermitRootLogin no</span><br><span class="line"><span class="comment">##重启sshd服务,xshell使用root远程登录liruilong失败</span></span><br><span class="line">[root@liruilong ~]$ systemctl restart sshd</span><br><span class="line"><span class="comment">#####xshell以普通用户jerry的身份可以登录liruilong虚拟机</span></span><br><span class="line"><span class="comment">##使用su -切换成root身份，或者使用sudo提权命令</span></span><br><span class="line">[c:\~]$ ssh jerry@192.168.2.100 3389 <span class="comment">#密码123456</span></span><br><span class="line">[tom@liruilong ~]$</span><br><span class="line">[tom@liruilong ~]$ su - root <span class="comment">#su - 切换root用户</span></span><br><span class="line">密码： <span class="comment">#输入root密码</span></span><br><span class="line">[root@liruilong ~]$</span><br></pre></td></tr></table></figure>
<ul>
<li><font color=tomato>配置文件</font> <code>/etc/ssh/sshd_config</code><ul>
<li><code>UseDNS no</code> &#x2F;&#x2F;不解析客户机地址</li>
<li><code>LoginGraceTime 1m</code> &#x2F;&#x2F;登录限时</li>
<li><code>MaxAuthTries 3 </code>&#x2F;&#x2F;每连接最多认证次数</li>
</ul>
</li>
</ul>
<p><code>UseDNS no  #不对客户机进行域名解析，访问网站的普通用户是没有域名的，不需要解析</code><br><code>LoginGraceTime 1m  #用户在ssh远程服务器时，如果1分钟内用户没有输入用户名和密码，则断开连接</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#########举例演示</span></span><br><span class="line"><span class="comment">##登录限时修改为10s,真实环境需要长一点</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/ssh/sshd_config</span><br><span class="line">37 LoginGraceTime 10s</span><br><span class="line">115 UseDNS no</span><br><span class="line"><span class="comment">##重启sshd服务</span></span><br><span class="line">[root@liruilong ~]$ systemctl restart sshd</span><br><span class="line"><span class="comment">###使用xshell远程连接时，不输入密码，等待10s中，会出现连接关闭的提示</span></span><br><span class="line">[c:\~]$ ssh jerry@192.168.2.100 3389</span><br><span class="line">Connection closing...Socket close.</span><br></pre></td></tr></table></figure>
<p><code>MaxAuthTries 3  : #用户远程服务器时，密码错误，可以尝试多少次</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#这里的3不是指的3次，是一个概数，需要不断尝试错误连接，来得出这里得数字</span></span><br><span class="line"><span class="comment">#########举例演示</span></span><br><span class="line"><span class="comment">##修改连接认证次数为3</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/ssh/sshd_config</span><br><span class="line">40 MaxAuthTries 3</span><br><span class="line"><span class="comment">##重启sshd服务</span></span><br><span class="line">[root@liruilong ~]$ systemctl restart sshd</span><br><span class="line"><span class="comment">##使用xshell远程连接，输入错误密码，输入两次就会出现连接端口的提示</span></span><br><span class="line">[c:\~]$ ssh jerry@192.168.2.100 3389</span><br><span class="line">Connection closing...Socket close.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><font color=orange>ssh经常一段时间就断掉解决办法去掉注释，改成</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br><span class="line"></span><br><span class="line">ClientAliveInterval 30</span><br><span class="line">ClientAliveCountMax 86400</span><br></pre></td></tr></table></figure>
<p>这两行的意思分别是</p>
<ol>
<li>、客户端每隔多少秒向服务发送一个心跳数据</li>
<li>、客户端多少秒没有相应，服务器自动断掉连接</li>
</ol>
<p>重启sshd服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#service sshd restart</span></span><br></pre></td></tr></table></figure>

<ul>
<li><font color=chocolate>sshd黑&#x2F;白名单配</font> <code>配置文件 /etc/ssh/sshd_config</code><ul>
<li>DenyUsers USER1 USER2 …</li>
<li>AllowUsers USER1@HOST USER2 …</li>
<li>DenyGroups GROUP1 GROUP2 …</li>
<li>AllowGroups GROUP1 GROUP2 …</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####设置黑白名单时，如果要允许或拒绝多个用户，用户之间以空格作为分隔符</span></span><br><span class="line">DenyUsers <span class="comment">#设置黑名单，拒绝某些用户登录本机</span></span><br><span class="line">AllowUsers <span class="comment">#设置白名单，允许某些用户登录本机</span></span><br><span class="line">DenyGroups <span class="comment">#设置黑名单，拒绝一个或多个用户组登录本机</span></span><br><span class="line">AllowGroups <span class="comment">#设置白名单，允许一个或多个用户组登录本机</span></span><br><span class="line">AllowUsers USER1@HOST <span class="comment">#设置白名单，允许用户USER1从HOST这台主机登录本机</span></span><br></pre></td></tr></table></figure>
<p><code>应用示例:仅允许一部分用户(从指定地点)登入,其他任何用户均禁止登入</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####使用xshell让用户jerry使用3389端口登录</span></span><br><span class="line">[c:\~]$ ssh jerry@192.168.2.100 3389</span><br><span class="line">[jerry@liruilong ~]$ su - root <span class="comment">#切换为root身份</span></span><br><span class="line">[jerry@liruilong ~]$</span><br><span class="line"><span class="comment">#######设置白名单,仅允许tom可以ssh远程登录服务器，其他任何用户都无法登录</span></span><br><span class="line"><span class="comment">##如果设置的是白名单，则不需要设置黑名单了，默认是拒绝其他用户远程登录</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/ssh/sshd_config</span><br><span class="line">42 AllowUsers tom</span><br><span class="line"><span class="comment">##重启sshd服务</span></span><br><span class="line">[root@liruilong ~]$ systemctl restart sshd</span><br><span class="line"><span class="comment">######xshell远程测试</span></span><br><span class="line"><span class="comment">##jerry无法再登录了</span></span><br><span class="line">[c:\~]$ ssh jerry@192.168.2.100 3389 <span class="comment">#登录密码123456</span></span><br><span class="line"><span class="comment">##tom用户可以远程登录</span></span><br><span class="line">[c:\~]$ ssh tom@192.168.2.100 3389 <span class="comment">#登录密码 123456</span></span><br><span class="line">[tom@liruilong ~]$</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line"><span class="comment">#######设置黑名单,仅拒绝tom通过ssh远程登录服务器，其他用户都允许</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/ssh/sshd_config</span><br><span class="line">42 DenyUsers tom</span><br><span class="line"><span class="comment">##重启sshd服务</span></span><br><span class="line">[root@liruilong ~]$ systemctl restart sshd</span><br><span class="line"><span class="comment">######xshell远程测试</span></span><br><span class="line"><span class="comment">##tom无法再登录了</span></span><br><span class="line">[c:\~]$ ssh tom@192.168.2.100 3389 <span class="comment">#登录密码123456</span></span><br><span class="line"><span class="comment">##jerry用户可以远程登录</span></span><br><span class="line">[c:\~]$ ssh jerry@192.168.2.100 3389 <span class="comment">#登录密码 123456</span></span><br><span class="line">[tom@liruilong ~]$</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#######设置黑名单,拒绝用户tom从IP地址为192.168.2.1的主机，来远程服务器svr7</span></span><br><span class="line">[root@svr7 ~]$ vim /etc/ssh/sshd_config</span><br><span class="line">42 DenyUsers tom@192.168.2.1</span><br><span class="line"><span class="comment">##重启sshd服务</span></span><br><span class="line">[root@svr7 ~]$ systemctl restart sshd</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="SSH密钥对验证"><a href="#SSH密钥对验证" class="headerlink" title="SSH密钥对验证"></a><font color=tomato>SSH密钥对验证</font></h3><p><strong><font color=green>sshd验证方式控制</font></strong></p>
<ul>
<li><font color=red>口令验证</font>::检查登录用户的口令是否一致:密码验证：#当windows被攻击，系统被植入木马，容易被攻击者从键盘记录等方式中获取密码</li>
<li><font color=chocolate>密钥验证</font>:检查客户端私钥与服务器上的公钥是否匹配:密钥验证：#密钥验证的安全度很高；#不会有输入密码的过程，键盘工具方式无效；</li>
<li><font color=chocolate>PasswordAuthentication</font> yes #ssh支持密码验证<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">47 AuthorizedKeysFile .ssh/authorized_keys <span class="comment">##指定公钥的存放位置，在用户的家目录</span></span><br><span class="line">下的.ssh目录中的authorized_keys文件中</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="密钥对验证的实现思路"><a href="#密钥对验证的实现思路" class="headerlink" title="密钥对验证的实现思路"></a><font color=chocolate>密钥对验证的实现思路</font></h3><p><img src="https://img-blog.csdnimg.cn/40c995b084e54087aea074a9d4695f7c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<ul>
<li>第一步：客户机创建密钥对，私钥文件：id_rsa 公钥文件: id_rsa.pub;</li>
<li>第二步: 客户机上传公钥到服务器上用户的家目录下 .&#x2F;ssh&#x2F;authorized_keys文件；<br>ssh-copy-id 命令，会自动将公钥放到指定用户家目录的对应文件中</li>
</ul>
<p><strong><font color=plum><code>创建SSH密钥对</code>:使用工具 ssh-keygen</font></strong></p>
<ul>
<li>可以手动指定加密算法(-t rsa 或 -t dsa)</li>
<li>若不指定，默认采用RSA加密</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">######非交互的方式创建密钥对</span></span><br><span class="line">[root@svr7 ~]$ ssh-keygen -N <span class="string">&#x27;&#x27;</span> -f /root/.ssh/id_rsa</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:+pb7aZI5xtlulc1Z3MQjjsNGLu5mbCHxU5JfPtWOe+w root@svr7</span><br><span class="line">The keys randomart image is:</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">| . |</span><br><span class="line">| . . .o|</span><br><span class="line">| = o .o+|</span><br><span class="line">| . + B o .=|</span><br><span class="line">| S * ++.= |</span><br><span class="line">| o = .oo= .|</span><br><span class="line">| ..+*o. .o |</span><br><span class="line">| .@*+. . o|</span><br><span class="line">| o*O+ oE|</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line"><span class="comment">###密钥对会生成在/root/.ssh/目录下</span></span><br><span class="line">[root@svr7 ~]$ ls /root/.ssh/</span><br><span class="line">id_rsa id_rsa.pub known_hosts</span><br></pre></td></tr></table></figure>
<p><code>部署SSH公钥</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#方法一：将公钥通过ssh-copy-id放到192.168.2.200的服务器上</span></span><br><span class="line">[root@svr7 ~]$ ssh-copy-id root@192.168.2.200</span><br><span class="line"><span class="comment">#查看公钥文件的保存路径</span></span><br><span class="line">[root@client ~]$ ls /root/.ssh/</span><br><span class="line">authorized_keys</span><br></pre></td></tr></table></figure>
<h1 id="四、加密与解密"><a href="#四、加密与解密" class="headerlink" title="四、加密与解密"></a><font color=seagreen>四、加密与解密</font></h1><h2 id="加解密概述"><a href="#加解密概述" class="headerlink" title="加解密概述"></a><font color=purple>加解密概述</font></h2><h3 id="加密目的及方式"><a href="#加密目的及方式" class="headerlink" title="加密目的及方式"></a><font color=tomato>加密目的及方式</font></h3><ul>
<li><font color=green>确保数据的机密性对称加密：</font><ul>
<li>加密&#x2F;解密用同一个密钥</li>
<li>非对称加密：加密&#x2F;解密用不同的密钥(公钥、私钥)</li>
</ul>
</li>
<li><font color=yellowgreen>保护信息的完整性(常用于做数据完整性校验)</font><ul>
<li>信息摘要：基于输入的信息生成长度较短、位数固定的散列值</li>
</ul>
</li>
</ul>
<h3 id="常见的加密算法"><a href="#常见的加密算法" class="headerlink" title="常见的加密算法"></a><font color=royalblue>常见的加密算法</font></h3><ul>
<li><font color=green>对称加密</font><ul>
<li>DES，Data Encryption Standard</li>
<li>AES，Advanced Encryption Standard</li>
</ul>
</li>
<li><font color=chocolate>非对称加密</font><ul>
<li>RSA，Rivest Shamirh Adleman</li>
<li>DSA，Digital Signature Algorithm</li>
</ul>
</li>
<li><font color=amber>Hash散列技术,用于信息摘要</font><ul>
<li>MD5, Message Digest Algorithm 5 : <code>根据输入的文本(长度不限) ,生成固定长度(比如128位)的摘要文本</code></li>
<li>SHA, Secure Hash Algorithm1 : <code>只要输入的文本不同,则生成的摘要文本也不一样 </code></li>
</ul>
</li>
</ul>
<h3 id="MD5完整性检验"><a href="#MD5完整性检验" class="headerlink" title="MD5完整性检验"></a><font color=amber>MD5完整性检验</font></h3><ul>
<li>使用md5sum校验工具<ul>
<li>生成MD5校验值</li>
<li>与软件官方提供的校验值比对</li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/9f3ed8ce1e6b43269e0d32beef47a902.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="GPG加解密厂具"><a href="#GPG加解密厂具" class="headerlink" title="GPG加解密厂具"></a><font color=seagreen>GPG加解密厂具</font></h2><h3 id="GnuPG简介"><a href="#GnuPG简介" class="headerlink" title="GnuPG简介"></a><font color=blue>GnuPG简介</font></h3><p>**<font color=purple>GnuPG</font>**，GNU Privacy Guard : <a target="_blank" rel="noopener" href="http://www.gnupg.org/">http://www.gnupg.org/</a>  最流行的数据加密、数字签名工具软件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########查看gpg的版本，以及支持的算法</span></span><br><span class="line">[root@node1 ~]$ gpg --version</span><br><span class="line">gpg (GnuPG) 2.0.22</span><br><span class="line">libgcrypt 1.5.3</span><br><span class="line">Copyright (C) 2013 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line">Home: ~/.gnupg</span><br><span class="line">支持的算法：</span><br><span class="line">公钥：RSA, ?, ?, ELG, DSA</span><br><span class="line">对称加密：IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256,</span><br><span class="line">TWOFISH, CAMELLIA128, CAMELLIA192, CAMELLIA256</span><br><span class="line">散列：MD5, SHA1, RIPEMD160, SHA256, SHA384, SHA512, SHA224</span><br><span class="line">压缩：不压缩, ZIP, ZLIB, BZIP2</span><br></pre></td></tr></table></figure>
<h3 id="GPG对称加解密"><a href="#GPG对称加解密" class="headerlink" title="GPG对称加解密"></a><font color=royalblue>GPG对称加解密</font></h3><p>基本用法</p>
<ul>
<li><font color=chocolate>加密操作</font>：<code>--symmetric 或 -c</code></li>
<li><font color=camel>解密操作</font>：<code>--decrypt 或 -d</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####定义一个测试文件test.txt</span></span><br><span class="line">[root@node1 ~]$ <span class="built_in">echo</span> <span class="string">&quot;hello the world&quot;</span> &gt; test.txt</span><br><span class="line"><span class="comment">####使用gpg -c 对文件进行加密，输入加密密码 123456【tab键切换，回车确定】</span></span><br><span class="line">[root@node1 ~]$ gpg -c test.txt</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/1742681cfccd4ae49079a7ce9b6147d5.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####加密完成后，会生成一个以.gpg结尾的加密文件</span></span><br><span class="line">[root@node1 ~]$ ls -l test.txt.gpg</span><br><span class="line">-rw-r--r-- 1 root root 63 8月 20 09:58 test.txt.gpg</span><br><span class="line"><span class="comment">###删除原始文件</span></span><br><span class="line">[root@node1 ~]$ rm -rf test.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">######使用gpg -d解密数据,将数据解密后放到/opt/test02.txt文件中</span></span><br><span class="line"><span class="comment">###解密密钥存放在/root/.gnupg/secring.gpg文件中</span></span><br><span class="line"><span class="comment">##加密和解密在同一台服务器上，有解密密钥的存在，不需要输入密码直接解密</span></span><br><span class="line">[root@node1 ~]$ gpg -d test.txt.gpg &gt; /opt/test02.txt</span><br><span class="line">gpg: CAST5 加密过的数据</span><br><span class="line">gpg: 以 1 个密码加密</span><br><span class="line">hello the world</span><br><span class="line">gpg: 警告：报文未受到完整的保护</span><br><span class="line"><span class="comment">###查看解密后的文件内容</span></span><br><span class="line">[root@node1 ~]$ cat /opt/test02.txt</span><br><span class="line">hello the world</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#######在node1上加密文件，在node2上解密文件</span></span><br><span class="line">[root@node1 ~]$ scp test.txt.gpg root@192.168.2.200:/root/</span><br><span class="line"><span class="comment">####客户端node2上查看加密数据</span></span><br><span class="line">[root@node2 ~]$ ls -l test.txt.gpg</span><br><span class="line">-rw-r--r-- 1 root root 63 8月 20 10:16 test.txt.gpg</span><br><span class="line"><span class="comment">######解密数据，存放到test.txt文件中</span></span><br><span class="line"><span class="comment">##根据提示需要输入密码 123456</span></span><br><span class="line">[root@node2 ~]$ gpg -d test.txt.gpg &gt; /root/test.txt</span><br><span class="line"><span class="comment">##查看解密后的数据</span></span><br><span class="line">[root@node2 ~]$ ls -l test.txt</span><br><span class="line">-rw-r--r-- 1 root root 16 8月 20 10:17 test.txt</span><br><span class="line">[root@node2 ~]$ cat test.txt</span><br><span class="line">hello the world</span><br></pre></td></tr></table></figure>

<h3 id="GPG非对称加解密"><a href="#GPG非对称加解密" class="headerlink" title="GPG非对称加解密"></a><font color=tomato>GPG非对称加解密</font></h3><ul>
<li><p>基本过程<br><img src="https://img-blog.csdnimg.cn/243b4075ea054666844f5467b76b6b4c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
</li>
<li><p>前期准备工作</p>
<ul>
<li>UserB 创建密钥对：<code>--gen-key</code></li>
<li>UserB 导出公钥：<code>--export、--armor 或 -a</code></li>
<li>UserA 导入公钥：<code>--import</code></li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]$ gpg --gen-key</span><br><span class="line">gpg (GnuPG) 2.0.22; Copyright (C) 2013 Free Software Foundation, Inc.</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line">请选择您要使用的密钥种类：</span><br><span class="line">(1) RSA and RSA (default) <span class="comment">#默认使用密钥类型</span></span><br><span class="line">(2) DSA and Elgamal</span><br><span class="line">(3) DSA (仅用于签名)</span><br><span class="line">(4) RSA (仅用于签名)</span><br><span class="line">您的选择？ <span class="comment">#直接回车选择默认密钥类型</span></span><br><span class="line">RSA 密钥长度应在 1024 位与 4096 位之间。</span><br><span class="line">您想要用多大的密钥尺寸？(2048) <span class="comment">#密钥长度，默认2048</span></span><br><span class="line">您所要求的密钥尺寸是 2048 位</span><br><span class="line">请设定这把密钥的有效期限。</span><br><span class="line">0 = 密钥永不过期 <span class="comment">#默认选项</span></span><br><span class="line">&lt;n&gt; = 密钥在 n 天后过期 <span class="comment">#3 代表3天后过期</span></span><br><span class="line">&lt;n&gt;w = 密钥在 n 周后过期 <span class="comment">#3w 代表3周后过期</span></span><br><span class="line">&lt;n&gt;m = 密钥在 n 月后过期 <span class="comment">#3m 代表3月后过期</span></span><br><span class="line">&lt;n&gt;y = 密钥在 n 年后过期 <span class="comment">#3y 代表3年后后期</span></span><br><span class="line">密钥的有效期限是？(0) <span class="comment">#回车，默认选择永不过期</span></span><br><span class="line">密钥永远不会过期</span><br><span class="line">以上正确吗？(y/n)y <span class="comment">#选择y,确定以上选择</span></span><br><span class="line">You need a user ID to identify your key; the software constructs the user ID</span><br><span class="line">from the Real Name, Comment and Email Address <span class="keyword">in</span> this form:</span><br><span class="line"><span class="string">&quot;Heinrich Heine (Der Dichter) &lt;heinrichh@duesseldorf.de&gt;&quot;</span></span><br><span class="line">真实姓名：userb <span class="comment">#填写密钥名称</span></span><br><span class="line">电子邮件地址：userb@tedu.cn <span class="comment">#填写密钥邮箱</span></span><br><span class="line">注释：<span class="built_in">test</span> key <span class="comment">#注释信息，任意填写</span></span><br><span class="line">您选定了这个用户标识：</span><br><span class="line">“userb (<span class="built_in">test</span> key) &lt;userb@tedu.cn&gt;”</span><br><span class="line">更改姓名(N)、注释(C)、电子邮件地址(E)或确定(O)/退出(Q)？ <span class="comment">#大写O确定,回车</span></span><br><span class="line"><span class="comment">##这里输入的密码，是解密数据时需要输入的，选择“回车”，则代表解密不需要额外的密码验证，直接解密出</span></span><br><span class="line">数据</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####生成密钥对时，需要大量的随机数,是从/dev/random获取的，如果无法很快生成密钥，ctrl+C 结束</span></span><br><span class="line">命令，修改随机数生成器</span><br><span class="line"><span class="comment">###修改随机数的生成器为 /dev/urandom</span></span><br><span class="line">[root@node1 ~]$ mv /dev/random /dev/random.bak</span><br><span class="line">[root@node1 ~]$ ln -s /dev/urandom /dev/random</span><br><span class="line"><span class="comment">###根据上面的操作重新生成密钥对，如果终端异常，输入 reset 重置终端</span></span><br><span class="line">[root@node1 ~]$ gpg --gen-key</span><br><span class="line"><span class="comment">####查看生成的密钥</span></span><br><span class="line">[root@node1 ~]$ gpg --list-keys</span><br><span class="line">/root/.gnupg/pubring.gpg</span><br><span class="line">------------------------</span><br><span class="line">pub 2048R/8B8D56D4 2020-08-20</span><br><span class="line">uid userb (<span class="built_in">test</span> key) &lt;userb@tedu.cn&gt;</span><br><span class="line">sub 2048R/90116CE3 2020-08-20</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####根据密钥名称userb导出公钥</span></span><br><span class="line">[root@node1 ~]$ gpg -a --<span class="built_in">export</span> userb &gt; /tmp/userb.pub</span><br><span class="line"><span class="comment">###也可以根据密钥邮箱userb@tedu.cn导出公钥</span></span><br><span class="line">[root@node1 ~]$ gpg -a --<span class="built_in">export</span> userb@tedu.cn &gt; /tmp/userb02.pub</span><br><span class="line"><span class="comment">#####查看导出的公钥userb.pub内容</span></span><br><span class="line">[root@node1 ~]$ cat /tmp/userb.pub</span><br><span class="line">-----BEGIN PGP PUBLIC KEY BLOCK-----</span><br><span class="line">Version: GnuPG v2.0.22 (GNU/Linux)</span><br><span class="line">mQENBF895QwBCACwfDPG4vzoazhIGnLIghIN49ByACQG1YB2cHvoqITQ06KDve0p</span><br><span class="line">EHDayr2mcGGwZbv96tp3HDIoS70QpbMdiqri5zD3Jnms2C37pfRmPDjUJ6eQQQJJ</span><br><span class="line">......</span><br><span class="line"><span class="comment">#####查看导出的公钥userb02.pub内容</span></span><br><span class="line">[root@node1 ~]$ cat /tmp/userb02.pub</span><br><span class="line">-----BEGIN PGP PUBLIC KEY BLOCK-----</span><br><span class="line">Version: GnuPG v2.0.22 (GNU/Linux)</span><br><span class="line">mQENBF895QwBCACwfDPG4vzoazhIGnLIghIN49ByACQG1YB2cHvoqITQ06KDve0p</span><br><span class="line">EHDayr2mcGGwZbv96tp3HDIoS70QpbMdiqri5zD3Jnms2C37pfRmPDjUJ6eQQQJJ</span><br><span class="line">......</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########客户机node2导入来自node1的公钥</span></span><br><span class="line"><span class="comment">####第一步：node1拷贝公钥到node2虚拟机中的/tmp目录下</span></span><br><span class="line">[root@node1 ~]$ scp /tmp/userb.pub 192.168.2.200:/tmp/</span><br><span class="line"><span class="comment">####第二步：客户机client导入公钥/tmp/userb.pub</span></span><br><span class="line"><span class="comment">#首先，查看列表，是否有公钥</span></span><br><span class="line">[root@node2 ~]$ gpg --list-keys</span><br><span class="line">gpg: /root/.gnupg/trustdb.gpg：建立了信任度数据库</span><br><span class="line"><span class="comment">#然后，根据文件导入公钥</span></span><br><span class="line">[root@node2 ~]$ gpg --import /tmp/userb.pub</span><br><span class="line">gpg: 密钥 8B8D56D4：公钥“userb (<span class="built_in">test</span> key) &lt;userb@tedu.cn&gt;”已导入</span><br><span class="line">gpg: 合计被处理的数量：1</span><br><span class="line">gpg: 已导入：1 (RSA: 1)</span><br><span class="line"><span class="comment">#最后，再次查看列表，新的公钥已经导入</span></span><br><span class="line">[root@node2 ~]$ gpg --list-keys</span><br><span class="line">/root/.gnupg/pubring.gpg</span><br><span class="line">------------------------</span><br><span class="line">pub 2048R/8B8D56D4 2020-08-20</span><br><span class="line">uid userb (<span class="built_in">test</span> key) &lt;userb@tedu.cn&gt;</span><br><span class="line">sub 2048R/90116CE3 2020-08-20</span><br></pre></td></tr></table></figure>

<ul>
<li><font color=plum>基本用法</font><ul>
<li><font color=chocolate>加密操作：</font><code>--encrypt 或 -e</code></li>
<li><font color=seagreen>指定目标用户：</font><code>--recipient 或 -r</code></li>
<li><font color=blue>解密操作：</font><code>--decrypt 或 -d</code></li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">######在客户机node2上生成一个测试文件clear.txt</span></span><br><span class="line">[root@node2 ~]$ <span class="built_in">echo</span> <span class="built_in">test</span> &gt; /root/clear.txt</span><br><span class="line"><span class="comment">#####-e 加密，-r 使用公钥userb对文件clear.txt进行加密</span></span><br><span class="line">[root@node2 ~]$ gpg -e -r userb clear.txt</span><br><span class="line">gpg: 90116CE3：没有证据表明这把密钥真的属于它所声称的持有者</span><br><span class="line">pub 2048R/90116CE3 2020-08-20 userb (<span class="built_in">test</span> key) &lt;userb@tedu.cn&gt;</span><br><span class="line">主钥指纹： 0644 7DE7 C2A8 EE21 F41F 939B C53B 6BCA 8B8D 56D4</span><br><span class="line">子钥指纹： 80B5 C5AB 7AA9 287C F411 AD7C 0105 14A9 9011 6CE3</span><br><span class="line">这把密钥并不一定属于用户标识声称的那个人。如果您真的知道自</span><br><span class="line">己在做什么，您可以在下一个问题回答 yes。</span><br><span class="line">无论如何还是使用这把密钥吗？(y/N)y <span class="comment">#y 确定使用公钥userb加密</span></span><br><span class="line"><span class="comment">#####加密数据生成，以后发送文件也是发送.gpg结尾的加密文件</span></span><br><span class="line"><span class="comment">#####加密文件发送过去以后，再通过私钥进行解密</span></span><br><span class="line">[root@node2 ~]$ ls -l /root/clear.txt.gpg</span><br><span class="line">-rw-r--r-- 1 root root 346 8月 20 11:10 /root/clear.txt.gpg</span><br><span class="line"><span class="comment">#######客户端client发送加密文件给svr7</span></span><br><span class="line">[root@client ~]$ scp /root/clear.txt.gpg root@192.168.2.100:/root/</span><br><span class="line"><span class="comment">######-d 解密数据；-r 使用userb私钥解密，要解密文件为clear.txt.gpg</span></span><br><span class="line"><span class="comment">##解密后的数据存放到 clear.txt文件中</span></span><br><span class="line">[root@node1 ~]$ gpg -d -r userb clear.txt.gpg &gt; clear.txt</span><br><span class="line">gpg: 由 2048 位的 RSA 密钥加密，钥匙号为 90116CE3、生成于 2020-08-20</span><br><span class="line">“userb (<span class="built_in">test</span> key) &lt;userb@tedu.cn&gt;”</span><br><span class="line"><span class="comment">##查看clear.txt中解密后的数据</span></span><br><span class="line">[root@node1 ~]$ cat clear.txt</span><br><span class="line"><span class="built_in">test</span></span><br></pre></td></tr></table></figure>


<h3 id="GPG软件签名与验证"><a href="#GPG软件签名与验证" class="headerlink" title="GPG软件签名与验证"></a><font color=plum>GPG软件签名与验证</font></h3><table>
<thead>
<tr>
<th><strong><font color=orange>软件签名与验证过程</font></strong></th>
</tr>
</thead>
<tbody><tr>
<td>软件官方以私钥对软件包执行数字签名</td>
</tr>
<tr>
<td>用户下载软件包、软件官方的公钥</td>
</tr>
<tr>
<td>以官方公钥验证软件包签名，确保数据来源正确</td>
</tr>
</tbody></table>
<blockquote>
<p>服务器使用私钥对发送出的所以数据文件进行签名；客户端可以使用公钥来对数据文件进行验证，查看其是否是有服务器发送的；如果是，则代表来源正确；如果不是，则数据文件不安全，删除</p>
</blockquote>
<table>
<thead>
<tr>
<th><strong><font color=plum>GPG软件签名与验证</font></strong></th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>为软件包建立签名文件</td>
<td>分离式签名：<code>--detach-sign 或 -b</code></td>
</tr>
<tr>
<td>验证软件包签名</td>
<td>验证签名：<code>--verify</code></td>
</tr>
<tr>
<td><strong><font color=plum>node1</font></strong></td>
<td></td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####### -b 服务器node1对文件clear.txt进行签名</span></span><br><span class="line"><span class="comment">##签名后会生成一个签名文件</span></span><br><span class="line">[root@node1 ~]$ gpg -b clear.txt</span><br><span class="line">[root@node1 ~]$ ls -l clear.txt.sig</span><br><span class="line">-rw-r--r-- 1 root root 287 8月 20 11:29 clear.txt.sig</span><br><span class="line"><span class="comment">######将数据文件clear.txt和签名文件clear.txt.sig发送给客户端client</span></span><br><span class="line">[root@node1 ~]$ scp clear.txt clear.txt.sig root@192.168.2.200:/root/</span><br></pre></td></tr></table></figure>
<p><strong><font color=brown>node2</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#########客户端node2通过 --verify 验证数据文件clear.txt的来源</span></span><br><span class="line"><span class="comment">##验证签名时，签名文件放到前面，数据文件跟在后面</span></span><br><span class="line">[root@node2 ~]$ gpg --verify clear.txt.sig clear.txt</span><br><span class="line">gpg: 于 2020年08月20日 星期四 11时29分15秒 CST 创建的签名，使用 RSA，钥匙号 8B8D56D4</span><br><span class="line">gpg: 完好的签名，来自于“userb (<span class="built_in">test</span> key) &lt;userb@liruilong.cn&gt;”</span><br><span class="line">gpg: 警告：这把密钥未经受信任的签名认证！</span><br><span class="line">gpg: 没有证据表明这个签名属于它所声称的持有者。</span><br><span class="line">主钥指纹： 0644 7DE7 C2A8 EE21 F41F 939B C53B 6BCA 8B8D 56D4</span><br></pre></td></tr></table></figure>

<h1 id="五、AIDE入侵检测"><a href="#五、AIDE入侵检测" class="headerlink" title="五、AIDE入侵检测"></a><font color=tomato>五、AIDE入侵检测</font></h1><h2 id="初始化系统"><a href="#初始化系统" class="headerlink" title="初始化系统"></a><font color=green>初始化系统</font></h2><h3 id="安装软件包"><a href="#安装软件包" class="headerlink" title="安装软件包"></a><font color=seagreen>安装软件包</font></h3><p>AIDE(Advanced intrusion detection environment),该软件为一套入侵检测系统,配置yum源即可安装aide软件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]$ yum -y install aide</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th><strong><font color=brown>aide原理：</font></strong></th>
</tr>
</thead>
<tbody><tr>
<td>在没有被人篡改之前对我们的计算机做一个全面的检查；</td>
</tr>
<tr>
<td>记录每个文件的状态(包括数据的时间，大小，权限，哈希值等)；</td>
</tr>
<tr>
<td>当计算机被入侵以后，aide对计算机做同样的校验，同样的检查；</td>
</tr>
<tr>
<td>最后，通过对比入侵之前检查的结果和入侵之后的检查结果，找到哪些数据发生了哪些变化</td>
</tr>
</tbody></table>
<h3 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a><font color=red>修改配置文件</font></h3><p>**<font color=plum>AIDE默认配置文件为<code>/etc/aide.conf</code></font>**嗯，这个系统不一样会有出入</p>
<p><img src="https://img-blog.csdnimg.cn/e45260b6b64147edb4b697dc090216a2.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bGx5rKz5bey5peg5oGZ,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@node1 ~]$ vim /etc/aide.conf</span><br><span class="line">1 <span class="comment"># Example configuration file for AIDE.</span></span><br><span class="line">2</span><br><span class="line">3 @@define DBDIR /var/lib/aide <span class="comment">#aide对数据校验后，结果文件的存放位置</span></span><br><span class="line">4 @@define LOGDIR /var/<span class="built_in">log</span>/aide <span class="comment">#aide日志文件的目录</span></span><br><span class="line">......</span><br><span class="line"><span class="comment">###当系统被入侵后，需要将入侵前的数据aide.db.new.gz，更名为aide.db.gz</span></span><br><span class="line"><span class="comment">##系统被入侵后，aide重新校验时会将新生成的校验结果aide.db.new.gz和以前校验结果aide.db.gz进行对比</span></span><br><span class="line">7 database=file:@@&#123;DBDIR&#125;/aide.db.gz</span><br><span class="line">......</span><br><span class="line"><span class="comment">#####定义校验完数据后，将校验结果存放到哪个目录下的哪个文件中</span></span><br><span class="line"><span class="comment">##默认存放到/var/lib/aide目录下；保存的文件名问aide.db.new.gz</span></span><br><span class="line">12 database_out=file:@@&#123;DBDIR&#125;/aide.db.new.gz</span><br><span class="line">......</span><br><span class="line">28 <span class="comment">#p: permissions #校验文件的权限是否被修改</span></span><br><span class="line">29 <span class="comment">#i: inode: #校验文件的inode节点是否被修改</span></span><br><span class="line">30 <span class="comment">#n: number of links #校验文件的链接数量是否增多或减少</span></span><br><span class="line">31 <span class="comment">#u: user #校验文件的所有者是否被修改</span></span><br><span class="line">32 <span class="comment">#g: group #校验文件的所属组否是被修改</span></span><br><span class="line">33 <span class="comment">#s: size #校验文件的大小是否变化</span></span><br><span class="line">......</span><br><span class="line">42 <span class="comment">#md5: md5 checksum #校验文件md5生成的哈希值</span></span><br><span class="line">43 <span class="comment">#sha1: sha1 checksum #校验文件sha1生成的哈希值</span></span><br><span class="line">44 <span class="comment">#sha256: sha256 checksum #校验文件sha256生成的哈希值</span></span><br><span class="line">......</span><br><span class="line"><span class="comment">######定义变量，变量中包含以上的所有校验</span></span><br><span class="line">54 FIPSR = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256</span><br><span class="line">......</span><br><span class="line">71 NORMAL = sha256 <span class="comment">#定义变量，校验哈希值，会调用</span></span><br></pre></td></tr></table></figure>

<h3 id="修改配置文件-1"><a href="#修改配置文件-1" class="headerlink" title="修改配置文件"></a><font color=yellowgreen>修改配置文件</font></h3><p><strong><font color=plum>校验的目录设置</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]$ vim /etc/aide.conf</span><br><span class="line">......</span><br><span class="line">99 /boot/ NORMAL <span class="comment">#对/boot目录，进行sha256校验,NORMAL为变量</span></span><br><span class="line">100 /bin/ NORMAL <span class="comment">#同上</span></span><br><span class="line">101 /sbin/ NORMAL</span><br><span class="line">102 /lib/ NORMAL</span><br><span class="line">103 /lib64/ NORMAL</span><br><span class="line">104 /opt/ NORMAL</span><br><span class="line">......</span><br><span class="line">112 !/usr/src/ <span class="comment">#! 取反，设置不需要校验的目录</span></span><br><span class="line">113 !/usr/tmp/</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><font color=royalblue>第一步：批量注释掉所有的校验目录</font></strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>步骤一： vim 打开文件&#x2F;etc&#x2F;aide.conf</td>
</tr>
<tr>
<td>步骤二： 末行模式下，光标移动到99行&#x2F;boot&#x2F;的首字母上【末行模式 :99】</td>
</tr>
<tr>
<td>步骤三： Ctrl + v 进入到可视化模式，按键盘的下键，拉到最后一行</td>
</tr>
<tr>
<td>步骤四： Shift + i 进入到插入模式,插入注释符号#;</td>
</tr>
<tr>
<td>步骤五： 按键盘左上角的Esc键，批量注释完成</td>
</tr>
</tbody></table>
<p><strong><font color=yellowgreen>第二步：插入一行校验目录</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]$ vim /etc/aide.conf</span><br><span class="line">......</span><br><span class="line">93 DATAONLY = p+n+u+g+s+acl+selinux+xattrs+sha256</span><br><span class="line">......</span><br><span class="line"><span class="comment">######对/tmp/目录进行校验，校验选项由变量DATAONLY决定</span></span><br><span class="line">98 /tmp/ DATAONLY</span><br><span class="line">99 <span class="comment">#/boot/ CONTENT_EX</span></span><br><span class="line">100 <span class="comment">#/bin/ CONTENT_EX</span></span><br><span class="line">......</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="初始化检查"><a href="#初始化检查" class="headerlink" title="初始化检查"></a><font color=blue>初始化检查</font></h3><p><strong><font color=seagreen>在没有被攻击入侵前,根据配置文件，对数据进行校验操作</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####对/tmp/目录进行校验操作</span></span><br><span class="line">[root@node1 ~]$ aide --init</span><br><span class="line">AIDE, version 0.15.1</span><br><span class="line"><span class="comment">### AIDE database at /var/lib/aide/aide.db.new.gz initialized.</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">######查看生成的校验结果数据</span></span><br><span class="line"><span class="comment">#aide每次校验,生成的校验结果文件名都相同</span></span><br><span class="line">[root@node1 ~]$ ls /var/lib/aide/aide.db.new.gz</span><br><span class="line">/var/lib/aide/aide.db.new.gz</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="备份数据库"><a href="#备份数据库" class="headerlink" title="备份数据库"></a><font color=tomato>备份数据库</font></h3><p><strong><font color=green>在被入侵前，将校验的数据库文件备份到安全的地方 如，优盘、光盘、移动硬盘、网络存储</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">######将校验的结果数据文件备份到/mnt目录下</span></span><br><span class="line">[root@node1 ~]$ mv /var/lib/aide/aide.db.new.gz /mnt/</span><br></pre></td></tr></table></figure>
<h2 id="入侵检查"><a href="#入侵检查" class="headerlink" title="入侵检查"></a><font color=yellowgreen>入侵检查</font></h2><h3 id="执行入侵检查"><a href="#执行入侵检查" class="headerlink" title="执行入侵检查"></a><font color=green>执行入侵检查</font></h3><p><strong><font color=yellowgreen>将之前备份的校验数据库文件还原</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####将之前备份的校验数据库文件拷贝会 /var/lib/aide</span></span><br><span class="line"><span class="comment">##配置文件中已经定义了新生成的数据库文件会和aide.db.gz进行比对，所以需要改名</span></span><br><span class="line">[root@node1 ~]$ cp /mnt/aide.db.new.gz /var/lib/aide/aide.db.gz</span><br></pre></td></tr></table></figure>
<p><strong><font color=green>根据数据库执行入侵检测</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####没做任何改变前，进行比对，结果正常</span></span><br><span class="line">[root@node1 ~]$ aide --check</span><br><span class="line">AIDE, version 0.15.1</span><br><span class="line"><span class="comment">### All files match AIDE database. Looks okay!</span></span><br><span class="line"><span class="comment">######对/tmp目录下的文件进行多次修改，重新使用aide进行校验比对</span></span><br><span class="line">[root@node1 ~]$ <span class="built_in">echo</span> aide &gt;&gt; /tmp/test.txt</span><br><span class="line">[root@node1 ~]$ rm -rf /tmp/userb.pub</span><br><span class="line">[root@node1 ~]$ <span class="built_in">echo</span> <span class="string">&quot;xxx&quot;</span> &gt; /tmp/x.txt</span><br><span class="line">[root@node1 ~]$ <span class="built_in">echo</span> <span class="string">&quot;ccc&quot;</span> &gt; /tmp/c.txt</span><br><span class="line"><span class="comment">#####没做任何改变前，进行比对,会列出详细的文件修改信息</span></span><br><span class="line">[root@node1 ~]$ aide --check</span><br><span class="line">AIDE 0.15.1 found differences between database and filesystem!!</span><br><span class="line">Start timestamp: 2020-08-20 13:06:18</span><br><span class="line">Summary:</span><br><span class="line">Total number of files: 17</span><br><span class="line">Added files: 2</span><br><span class="line">Removed files: 1</span><br><span class="line">Changed files: 1</span><br><span class="line">---------------------------------------------------</span><br><span class="line">Added files:</span><br><span class="line">---------------------------------------------------</span><br><span class="line">added: /tmp/c.txt</span><br><span class="line">added: /tmp/x.txt</span><br><span class="line">---------------------------------------------------</span><br><span class="line">Removed files:</span><br><span class="line">---------------------------------------------------</span><br><span class="line">removed: /tmp/userb.pub</span><br><span class="line">---------------------------------------------------</span><br><span class="line">Changed files:</span><br><span class="line">---------------------------------------------------</span><br><span class="line">changed: /tmp/test.txt</span><br><span class="line">---------------------------------------------------</span><br><span class="line">Detailed information about changes:</span><br><span class="line">---------------------------------------------------</span><br><span class="line">File: /tmp/test.txt</span><br><span class="line">Size : 0 , 5</span><br><span class="line">SHA256 : 47DEQpj8HBSa+/TImW+5JCeuQeRkm5NM , OP7pCdRCH5j0ENIbJ9BV1SZScyCe+FEY</span><br></pre></td></tr></table></figure>
<h1 id="六，端口扫描"><a href="#六，端口扫描" class="headerlink" title="六，端口扫描"></a><font color=red>六，端口扫描</font></h1><h2 id="为什么需要扫描？"><a href="#为什么需要扫描？" class="headerlink" title="为什么需要扫描？"></a><font color=chocolate>为什么需要扫描？</font></h2><blockquote>
<p>以获取一些公开&#x2F;非公开信息为目的,检测潜在的风险,查找可攻击目标,收集设备&#x2F;主机&#x2F;系统&#x2F;软件信息,发现可利用的安全漏洞</p>
</blockquote>
<h3 id="扫描方式及工具"><a href="#扫描方式及工具" class="headerlink" title="扫描方式及工具"></a><font color=purple>扫描方式及工具</font></h3><table>
<thead>
<tr>
<th><strong><font color=purple>典型的扫描方式</font></strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>Scan</code>，主动探测(主动扫描百度或天猫的服务器)</td>
</tr>
<tr>
<td><code>Sniff</code>，被动监听&#x2F;嗅探 (A机器给B机器发送数据包时，B可以进行监听数据包)</td>
</tr>
<tr>
<td><code>Capture</code>，数据包捕获(抓包)</td>
</tr>
</tbody></table>
<blockquote>
<p>数据包捕获 通过地址伪装，欺骗，把数据诱导到我们的主机上，对数据抓包；在交换机和路由器上也可以抓包；</p>
</blockquote>
<h3 id="常见的安全分析工具"><a href="#常见的安全分析工具" class="headerlink" title="常见的安全分析工具"></a><font color=plum>常见的安全分析工具</font></h3><p><code>扫描器</code>：NMAP ——&gt; 主动去扫描其他的主机</p>
<p><code>协议分析</code>：tcpdump、WireShark ——&gt; 网络上抓包，截取数据</p>
<h2 id="NMAP扫描"><a href="#NMAP扫描" class="headerlink" title="NMAP扫描"></a><font color=brown>NMAP扫描</font></h2><p>NMAP一款强大的网络探测利器工具，支持多种探测技术</p>
<ul>
<li>ping 扫描</li>
<li>多端口扫描</li>
<li>TCP&#x2F;IP指纹检验<br>…..</li>
</ul>
<p>基本用法 :<code> nmap [扫描类型] [选项] &lt;扫描目标 ...&gt;</code></p>
<p>常用的扫描类型</p>
<ul>
<li>-sS，TCP SYN扫描(半开)</li>
<li>-sT，TCP 连接扫描(全开)</li>
<li>-sU，UDP扫描</li>
<li>-sP，ICMP扫描</li>
<li>-A，目标系统全面分析</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/8a69411ce37c4b98bb4df1873885c552.png" alt="在这里插入图片描述"></p>
<blockquote>
<p><strong><font color=amber>TCP SYN扫描(全开):</font></strong><br>#左边图：要检查目标主机的80端口是否打开，扫描时，A主机向目标主机的80端口发送请求建立连接的<br>请求syn,目标主机回应syn和ack,A主机也回应一个ack，连接建立，目标主机的80端口是打开的；</p>
</blockquote>
<blockquote>
<p><strong><font color=purple>TCP SYN扫描(半开):</font></strong><br>#右边图：要检查目标主机的80端口是否打开，扫描时，A主机向目标主机的80端口发送请求建立连接的<br>请求syn,目标主机回应syn和ack, 目标主机回应了，代表目标主机的80端口是打开的，A主机不再回应<br>ack，节省一个ack回应的资源；<br>#因为并不需要建立连接，只要目标主机回应即可，当扫描更多主机时会节省更多的系统资源；</p>
</blockquote>
<h3 id="NMAP应用示例"><a href="#NMAP应用示例" class="headerlink" title="NMAP应用示例"></a><font color=brown>NMAP应用示例</font></h3><p><strong><font color=red>检查哪些主机开启FTP、SSH服务端</font></strong><br>嗯，这个代码不对应该，这里扫描的的是53端口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####扫描查看UDP协议的端口状态</span></span><br><span class="line"><span class="comment">##-n 取消客户端的反向域名解析; -p 指定扫描的端口号</span></span><br><span class="line">[root@node1 ~]$ nmap -n -sU 192.168.2.200 -p 53</span><br><span class="line">Starting Nmap 6.40 ( http://nmap.org ) at 2020-08-20 15:05 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.2.200</span><br><span class="line">Host is up (0.0012s latency). <span class="comment">#up状态，网络延迟为0.0012s</span></span><br><span class="line">PORT STATE SERVICE</span><br><span class="line">53/udp closed domain <span class="comment">##53端口，处于关闭状态</span></span><br><span class="line">MAC Address: 00:0C:29:3D:40:D8 (VMware)</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 0.04 seconds</span><br></pre></td></tr></table></figure>
<p><strong><font color=orange>扫描查看UDP协议53-55的端口状态</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####扫描查看UDP协议53-55的端口状态</span></span><br><span class="line"><span class="comment">##-n 取消客户端的反向域名解析; -p 指定扫描的端口号</span></span><br><span class="line">[root@node1 ~]$ nmap -n -sU 192.168.2.200 -p 53-55</span><br><span class="line">Starting Nmap 6.40 ( http://nmap.org ) at 2020-08-20 15:07 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.2.200</span><br><span class="line">Host is up (0.00053s latency). <span class="comment">#up状态，网络延迟为0.00053s</span></span><br><span class="line">PORT STATE SERVICE</span><br><span class="line">53/udp closed domain <span class="comment">#53端口，关闭</span></span><br><span class="line">54/udp closed xns-ch <span class="comment">#53端口，关闭</span></span><br><span class="line">55/udp closed isi-gl <span class="comment">#53端口，关闭</span></span><br><span class="line">MAC Address: 00:0C:29:3D:40:D8 (VMware)</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 0.05 seconds</span><br></pre></td></tr></table></figure>
<p><strong><font color=green>扫描查看TCP协议53-55和25的端口状态</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####扫描查看TCP协议53-55和25的端口状态</span></span><br><span class="line"><span class="comment">###对于不连续的端口号用逗号【,】分隔</span></span><br><span class="line"><span class="comment">##-n 取消客户端的反向域名解析; -p 指定要扫描的端口号</span></span><br><span class="line">[root@node1 ~]$ nmap -n 192.168.2.200 -p 53-55,25</span><br><span class="line">Starting Nmap 6.40 ( http://nmap.org ) at 2020-08-20 15:10 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.2.200</span><br><span class="line">Host is up (0.00050s latency). <span class="comment">#up状态，网络延迟为0.00050s</span></span><br><span class="line">PORT STATE SERVICE</span><br><span class="line">25/udp closed smtp <span class="comment">#25端口，关闭</span></span><br><span class="line">53/udp closed domain <span class="comment">#53端口，关闭</span></span><br><span class="line">54/udp closed xns-ch <span class="comment">#54端口，关闭</span></span><br><span class="line">55/udp closed isi-gl <span class="comment">#55端口，关闭</span></span><br><span class="line">MAC Address: 00:0C:29:3D:40:D8 (VMware)</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 0.05 seconds</span><br></pre></td></tr></table></figure>
<p><strong><font color=plum>扫描http端口</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#######client上安装httpd服务，开启80端口</span></span><br><span class="line">[root@node2 ~]$ yum -y install httpd</span><br><span class="line">[root@node2 ~]$ systemctl start httpd</span><br><span class="line"><span class="comment">######在node1扫描查看node2上的80端口的状态</span></span><br><span class="line">[root@node1 ~]$ nmap -n 192.168.2.200 -p 80</span><br><span class="line">Starting Nmap 6.40 ( http://nmap.org ) at 2020-08-20 15:22 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.2.200</span><br><span class="line">Host is up (0.00034s latency).</span><br><span class="line">PORT STATE SERVICE</span><br><span class="line">80/tcp open http <span class="comment">#打开，服务http</span></span><br><span class="line">MAC Address: 00:0C:29:3D:40:D8 (VMware)</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 0.06 seconds</span><br><span class="line"><span class="comment">#########扫描查看网络中所有2.0网段上的80端口的状态</span></span><br><span class="line">[root@node1 ~]$ nmap -n 192.168.2.0/24 -p 80</span><br><span class="line">Starting Nmap 6.40 ( http://nmap.org ) at 2020-08-20 15:24 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.2.200 <span class="comment">#2.200主机</span></span><br><span class="line">Host is up (0.00030s latency).</span><br><span class="line">PORT STATE SERVICE</span><br><span class="line">80/tcp open http <span class="comment">#打开，服务http</span></span><br><span class="line">MAC Address: 00:0C:29:3D:40:D8 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.2.254 <span class="comment">#2.254主机</span></span><br><span class="line">Host is up (0.00030s latency).</span><br><span class="line">PORT STATE SERVICE</span><br><span class="line">80/tcp closed http <span class="comment">#打开，服务http</span></span><br><span class="line">MAC Address: 00:50:56:C0:00:02 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.2.100 <span class="comment">#2.100主机</span></span><br><span class="line">Host is up (0.000032s latency).</span><br><span class="line">PORT STATE SERVICE</span><br><span class="line">80/tcp closed http <span class="comment">#打开，服务http</span></span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (3 hosts up) scanned <span class="keyword">in</span> 4.74 seconds</span><br></pre></td></tr></table></figure>

<p><strong><font color=orange>检查目标主机的存活状态(是否可ping通)</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####使用ping扫描整个2.0网段的主机，查看是否开机</span></span><br><span class="line">[root@node1 ~]$ nmap -n -sP 192.168.2.0/24</span><br><span class="line">Starting Nmap 6.40 ( http://nmap.org ) at 2020-08-20 15:28 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.2.200</span><br><span class="line">Host is up (0.00011s latency). <span class="comment">#2.200开机</span></span><br><span class="line">MAC Address: 00:0C:29:3D:40:D8 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.2.254</span><br><span class="line">Host is up (0.00027s latency). <span class="comment">#2.254开机</span></span><br><span class="line">MAC Address: 00:50:56:C0:00:02 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.2.100 <span class="comment">#2.100开机</span></span><br><span class="line">Host is up.</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (3 hosts up) scanned <span class="keyword">in</span> 5.69 seconds</span><br></pre></td></tr></table></figure>

<p><strong><font color=orange>复合扫描：检查操作系统指纹、软件版本等信息</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#######全面扫描整个目标主机</span></span><br><span class="line">[root@node1 ~]$ nmap -n -A 192.168.2.200</span><br><span class="line">Starting Nmap 6.40 ( http://nmap.org ) at 2020-08-20 15:31 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.2.200</span><br><span class="line">Host is up (0.00079s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line"><span class="comment">###目标主机开启了22端口，使用的是ssh服务，使用软件为OpenSSH 7.4</span></span><br><span class="line">22/tcp open ssh OpenSSH 7.4 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: 2048 37:68:ae:d7:23:48:16:74:ed:c9:d8:de:44:8a:b5:50 (RSA)</span><br><span class="line">|_256 c7:14:c1:8f:1a:1b:64:e8:c1:06:56:74:ec:9a:50:29 (ECDSA)</span><br><span class="line"><span class="comment">###目标主机开启了80端口，使用的是http服务，使用软件为 Apache httpd 2.4.6</span></span><br><span class="line"><span class="comment">##目标主机的操作系统为CentOS</span></span><br><span class="line">80/tcp open http Apache httpd 2.4.6 ((CentOS))</span><br><span class="line">| http-methods: Potentially risky methods: TRACE</span><br><span class="line">|_See http://nmap.org/nsedoc/scripts/http-methods.html</span><br><span class="line">|_http-title: Apache HTTP Server Test Page powered by CentOS</span><br><span class="line">MAC Address: 00:0C:29:3D:40:D8 (VMware)</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (If you know what OS is running on it, see</span><br><span class="line">http://nmap.org/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=6.40%E=4%D=8/20%OT=22%CT=1%CU=43694%PV=Y%DS=1%DC=D%G=Y%M=000C29%T</span><br><span class="line"><span class="comment">###########目标主机使用的是红帽的linux系统</span></span><br><span class="line">OS:M=5F3E26E1%P=x86_64-redhat-linux-gnu)SEQ(SP=102%GCD=1%ISR=10E%TI=Z%CI=I%</span><br><span class="line">OS:TS=A)SEQ(SP=102%GCD=1%ISR=10D%TI=Z%TS=A)SEQ(SP=102%GCD=1%ISR=10D%TI=Z%II</span><br><span class="line">OS:=I%TS=A)OPS(O1=M5B4ST11NW7%O2=M5B4ST11NW7%O3=M5B4NNT11NW7%O4=M5B4ST11NW7</span><br><span class="line">OS:%O5=M5B4ST11NW7%O6=M5B4ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%</span><br><span class="line">OS:W6=7120)ECN(R=Y%DF=Y%T=40%W=7210%O=M5B4NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S</span><br><span class="line">OS:=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%R</span><br><span class="line">OS:D=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=</span><br><span class="line">OS:0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U</span><br><span class="line">OS:1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DF</span><br><span class="line">OS:I=N%T=40%CD=S)</span><br><span class="line"><span class="comment">####连接到目标主机所经过的路由器跳转的数量</span></span><br><span class="line"><span class="comment">##同一网段下，直连，为1</span></span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT ADDRESS</span><br><span class="line">1 0.79 ms 192.168.2.200 <span class="comment">##网络延迟为0.79ms</span></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at</span><br><span class="line">http://nmap.org/submit/ .</span><br><span class="line"><span class="comment">######整个检测一共花费了19.51秒</span></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 19.51 seconds</span><br></pre></td></tr></table></figure>
<p><strong><font color=yellowgreen>嗯，这是我扫描自己的win10的结果</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line">┌──(liruilong㉿Liruilong)-[/mnt/c/Users/lenovo]</span><br><span class="line">└─$ nmap -n -A 172.30.0.1</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 20:41 CST</span><br><span class="line">Stats: 0:00:50 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan</span><br><span class="line">Service scan Timing: About 80.00% <span class="keyword">done</span>; ETC: 20:42 (0:00:12 remaining)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 172.30.0.1</span><br><span class="line">Host is up (0.87s latency).</span><br><span class="line">Not shown: 990 closed ports</span><br><span class="line">PORT     STATE SERVICE         VERSION</span><br><span class="line">135/tcp  open  msrpc           Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn     Microsoft Windows netbios-ssn</span><br><span class="line">443/tcp  open  ssl/https       VMware Workstation SOAP API 16.1.2</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   FourOhFourRequest:</span><br><span class="line">|     HTTP/1.1 404 Not Found</span><br><span class="line">|     Date: Mon, 27 Sep 2021 12:41:49 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Security-Policy: block-all-mixed-content</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Strict-Transport-Security: max-age=31536000</span><br><span class="line">|     X-Content-Type-Options: nosniff</span><br><span class="line">|     X-Frame-Options: DENY</span><br><span class="line">|     X-XSS-Protection: 1</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|   GetRequest:</span><br><span class="line">|     HTTP/1.1 403 Forbidden</span><br><span class="line">|     Date: Mon, 27 Sep 2021 12:41:49 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Security-Policy: block-all-mixed-content</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Strict-Transport-Security: max-age=31536000</span><br><span class="line">|     X-Content-Type-Options: nosniff</span><br><span class="line">|     X-Frame-Options: DENY</span><br><span class="line">|     X-XSS-Protection: 1</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|   HTTPOptions:</span><br><span class="line">|     HTTP/1.1 501 Not Implemented</span><br><span class="line">|     Date: Mon, 27 Sep 2021 12:41:49 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Security-Policy: block-all-mixed-content</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Strict-Transport-Security: max-age=31536000</span><br><span class="line">|     X-Content-Type-Options: nosniff</span><br><span class="line">|     X-Frame-Options: DENY</span><br><span class="line">|     X-XSS-Protection: 1</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|   RTSPRequest:</span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Date: Mon, 27 Sep 2021 12:41:59 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html</span><br><span class="line">|     Content-Length: 50</span><br><span class="line">|     &lt;HTML&gt;&lt;BODY&gt;&lt;H1&gt;400 Bad Request&lt;/H1&gt;&lt;/BODY&gt;&lt;/HTML&gt;</span><br><span class="line">|   SIPOptions:</span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Date: Mon, 27 Sep 2021 12:43:06 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/html</span><br><span class="line">|     Content-Length: 50</span><br><span class="line">|_    &lt;HTML&gt;&lt;BODY&gt;&lt;H1&gt;400 Bad Request&lt;/H1&gt;&lt;/BODY&gt;&lt;/HTML&gt;</span><br><span class="line">|_http-title: Site doesn<span class="string">&#x27;t have a title (text/plain; charset=utf-8).</span></span><br><span class="line"><span class="string">| ssl-cert: Subject: commonName=VMware/countryName=US</span></span><br><span class="line"><span class="string">| Not valid before: 2021-02-17T10:21:06</span></span><br><span class="line"><span class="string">|_Not valid after:  2022-02-17T10:21:06</span></span><br><span class="line"><span class="string">|_ssl-date: TLS randomness does not represent time</span></span><br><span class="line"><span class="string">| vmware-version:</span></span><br><span class="line"><span class="string">|   Server version: VMware Workstation 16.1.2</span></span><br><span class="line"><span class="string">|   Build: 17966106</span></span><br><span class="line"><span class="string">|   Locale version: INTL</span></span><br><span class="line"><span class="string">|   OS type: win32-x86</span></span><br><span class="line"><span class="string">|_  Product Line ID: ws</span></span><br><span class="line"><span class="string">445/tcp  open  microsoft-ds?</span></span><br><span class="line"><span class="string">903/tcp  open  ssl/vmware-auth VMware Authentication Daemon 1.10 (Uses VNC, SOAP)</span></span><br><span class="line"><span class="string">1027/tcp open  msrpc           Microsoft Windows RPC</span></span><br><span class="line"><span class="string">1057/tcp open  msrpc           Microsoft Windows RPC</span></span><br><span class="line"><span class="string">3306/tcp open  mysql           MySQL (unauthorized)</span></span><br><span class="line"><span class="string">3389/tcp open  ms-wbt-server   Microsoft Terminal Services</span></span><br><span class="line"><span class="string">| rdp-ntlm-info:</span></span><br><span class="line"><span class="string">|   Target_Name: LIRUILONG</span></span><br><span class="line"><span class="string">|   NetBIOS_Domain_Name: LIRUILONG</span></span><br><span class="line"><span class="string">|   NetBIOS_Computer_Name: LIRUILONG</span></span><br><span class="line"><span class="string">|   DNS_Domain_Name: Liruilong</span></span><br><span class="line"><span class="string">|   DNS_Computer_Name: Liruilong</span></span><br><span class="line"><span class="string">|   Product_Version: 10.0.19041</span></span><br><span class="line"><span class="string">|_  System_Time: 2021-09-27T12:43:57+00:00</span></span><br><span class="line"><span class="string">| ssl-cert: Subject: commonName=Liruilong</span></span><br><span class="line"><span class="string">| Not valid before: 2021-09-07T13:31:59</span></span><br><span class="line"><span class="string">|_Not valid after:  2022-03-09T13:31:59</span></span><br><span class="line"><span class="string">|_ssl-date: 2021-09-27T12:44:02+00:00; 0s from scanner time.</span></span><br><span class="line"><span class="string">4000/tcp open  remoteanything?</span></span><br><span class="line"><span class="string">| fingerprint-strings:</span></span><br><span class="line"><span class="string">|   GetRequest:</span></span><br><span class="line"><span class="string">|     HTTP/1.1 200 OK</span></span><br><span class="line"><span class="string">|     X-Powered-By: Hexo</span></span><br><span class="line"><span class="string">|     Content-Type: text/html</span></span><br><span class="line"><span class="string">|     Date: Mon, 27 Sep 2021 12:41:42 GMT</span></span><br><span class="line"><span class="string">|     Connection: close</span></span><br><span class="line"><span class="string">|     &lt;!doctype html&gt;</span></span><br><span class="line"><span class="string">|     &lt;html lang=&quot;zh&quot;&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, maximum-scale=1&quot;&gt;&lt;meta&gt;&lt;title&gt;</span></span><br><span class="line"><span class="string">|     &lt;/title&gt;&lt;link rel=&quot;manifest&quot; href=&quot;/manifest.json&quot;&gt;&lt;meta name=&quot;application-name&quot; content=&quot;</span></span><br><span class="line"><span class="string">|     &quot;&gt;&lt;meta name=&quot;msapplication-TileImage&quot; content=&quot;https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png&quot;&gt;&lt;meta name=&quot;apple-mobile-web-app-capable&quot; content=&quot;yes&quot;&gt;&lt;meta name=&quot;apple-mobile-web-app-title&quot; content=&quot;</span></span><br><span class="line"><span class="string">|     &quot;&gt;&lt;meta name=&quot;apple-mobile-web-app-status-bar-style&quot; content=&quot;default&quot;&gt;&lt;meta property=&quot;og:type&quot; content=&quot;blog&quot;&gt;&lt;meta property=&quot;og:title&quot; content=&quot;</span></span><br><span class="line"><span class="string">|     &quot;&gt;&lt;meta property=&quot;og:url&quot; content=&quot;https://removeif.github.io/&quot;&gt;&lt;meta property=&quot;og:site_name&quot; cont</span></span><br><span class="line"><span class="string">|   HTTPOptions:</span></span><br><span class="line"><span class="string">|     HTTP/1.1 404 Not Found</span></span><br><span class="line"><span class="string">|     X-Powered-By: Hexo</span></span><br><span class="line"><span class="string">|     Content-Security-Policy: default-src &#x27;</span>none<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|     X-Content-Type-Options: nosniff</span></span><br><span class="line"><span class="string">|     Content-Type: text/html; charset=utf-8</span></span><br><span class="line"><span class="string">|     Content-Length: 143</span></span><br><span class="line"><span class="string">|     Date: Mon, 27 Sep 2021 12:41:47 GMT</span></span><br><span class="line"><span class="string">|     Connection: close</span></span><br><span class="line"><span class="string">|     &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">|     &lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">|     &lt;head&gt;</span></span><br><span class="line"><span class="string">|     &lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">|     &lt;title&gt;Error&lt;/title&gt;</span></span><br><span class="line"><span class="string">|     &lt;/head&gt;</span></span><br><span class="line"><span class="string">|     &lt;body&gt;</span></span><br><span class="line"><span class="string">|     &lt;pre&gt;Cannot OPTIONS /&lt;/pre&gt;</span></span><br><span class="line"><span class="string">|     &lt;/body&gt;</span></span><br><span class="line"><span class="string">|     &lt;/html&gt;</span></span><br><span class="line"><span class="string">|   NoMachine, RPCCheck, RTSPRequest:</span></span><br><span class="line"><span class="string">|     HTTP/1.1 400 Bad Request</span></span><br><span class="line"><span class="string">|_    Connection: close</span></span><br><span class="line"><span class="string">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span></span><br><span class="line"><span class="string">SF-Port4000-TCP:V=7.91%I=7%D=9/27%Time=6151BC06%P=x86_64-pc-linux-gnu%r(Ge</span></span><br><span class="line"><span class="string">SF:tRequest,3890,&quot;HTTP/1\.1\x20200\x20OK\r\nX-Powered-By:\x20Hexo\r\nConte</span></span><br><span class="line"><span class="string">SF:nt-Type:\x20text/html\r\nDate:\x20Mon,\x2027\x20Sep\x202021\x2012:41:42</span></span><br><span class="line"><span class="string">SF:\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!doctype\x20html&gt;\n&lt;html\x20lan</span></span><br><span class="line"><span class="string">SF:g=\&quot;zh\&quot;&gt;&lt;head&gt;&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;&lt;meta\x20name=\&quot;viewport\&quot;\x2</span></span><br><span class="line"><span class="string">SF:0content=\&quot;width=device-width,\x20initial-scale=1,\x20maximum-scale=1\&quot;</span></span><br><span class="line"><span class="string">SF:&gt;&lt;meta&gt;&lt;title&gt;\xe5\xb1\xb1\xe6\xb2\xb3\xe5\xb7\xb2\xe6\x97\xa0\xe6\x81\</span></span><br><span class="line"><span class="string">SF:x99&lt;/title&gt;&lt;link\x20rel=\&quot;manifest\&quot;\x20href=\&quot;/manifest\.json\&quot;&gt;&lt;meta\</span></span><br><span class="line"><span class="string">SF:x20name=\&quot;application-name\&quot;\x20content=\&quot;\xe5\xb1\xb1\xe6\xb2\xb3\xe5\</span></span><br><span class="line"><span class="string">SF:xb7\xb2\xe6\x97\xa0\xe6\x81\x99\&quot;&gt;&lt;meta\x20name=\&quot;msapplication-TileIma</span></span><br><span class="line"><span class="string">SF:ge\&quot;\x20content=\&quot;https://cdn\.jsdelivr\.net/gh/removeif/removeif-demo@</span></span><br><span class="line"><span class="string">SF:latest/img/favicon\.png\&quot;&gt;&lt;meta\x20name=\&quot;apple-mobile-web-app-capable\</span></span><br><span class="line"><span class="string">SF:&quot;\x20content=\&quot;yes\&quot;&gt;&lt;meta\x20name=\&quot;apple-mobile-web-app-title\&quot;\x20co</span></span><br><span class="line"><span class="string">SF:ntent=\&quot;\xe5\xb1\xb1\xe6\xb2\xb3\xe5\xb7\xb2\xe6\x97\xa0\xe6\x81\x99\&quot;&gt;</span></span><br><span class="line"><span class="string">SF:&lt;meta\x20name=\&quot;apple-mobile-web-app-status-bar-style\&quot;\x20content=\&quot;de</span></span><br><span class="line"><span class="string">SF:fault\&quot;&gt;&lt;meta\x20property=\&quot;og:type\&quot;\x20content=\&quot;blog\&quot;&gt;&lt;meta\x20prop</span></span><br><span class="line"><span class="string">SF:erty=\&quot;og:title\&quot;\x20content=\&quot;\xe5\xb1\xb1\xe6\xb2\xb3\xe5\xb7\xb2\xe6</span></span><br><span class="line"><span class="string">SF:\x97\xa0\xe6\x81\x99\&quot;&gt;&lt;meta\x20property=\&quot;og:url\&quot;\x20content=\&quot;https:</span></span><br><span class="line"><span class="string">SF://removeif\.github\.io/\&quot;&gt;&lt;meta\x20property=\&quot;og:site_name\&quot;\x20cont&quot;)%</span></span><br><span class="line"><span class="string">SF:r(NoMachine,2F,&quot;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20cl</span></span><br><span class="line"><span class="string">SF:ose\r\n\r\n&quot;)%r(HTTPOptions,180,&quot;HTTP/1\.1\x20404\x20Not\x20Found\r\nX-</span></span><br><span class="line"><span class="string">SF:Powered-By:\x20Hexo\r\nContent-Security-Policy:\x20default-src\x20&#x27;</span>none</span><br><span class="line">SF:<span class="string">&#x27;\r\nX-Content-Type-Options:\x20nosniff\r\nContent-Type:\x20text/html;\</span></span><br><span class="line"><span class="string">SF:x20charset=utf-8\r\nContent-Length:\x20143\r\nDate:\x20Mon,\x2027\x20Se</span></span><br><span class="line"><span class="string">SF:p\x202021\x2012:41:47\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!DOCTYPE\x</span></span><br><span class="line"><span class="string">SF:20html&gt;\n&lt;html\x20lang=\&quot;en\&quot;&gt;\n&lt;head&gt;\n&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n&lt;t</span></span><br><span class="line"><span class="string">SF:itle&gt;Error&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;pre&gt;Cannot\x20OPTIONS\x20/&lt;/pre&gt;\</span></span><br><span class="line"><span class="string">SF:n&lt;/body&gt;\n&lt;/html&gt;\n&quot;)%r(RTSPRequest,2F,&quot;HTTP/1\.1\x20400\x20Bad\x20Requ</span></span><br><span class="line"><span class="string">SF:est\r\nConnection:\x20close\r\n\r\n&quot;)%r(RPCCheck,2F,&quot;HTTP/1\.1\x20400\x</span></span><br><span class="line"><span class="string">SF:20Bad\x20Request\r\nConnection:\x20close\r\n\r\n&quot;);</span></span><br><span class="line"><span class="string">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows, cpe:/o:vmware:Workstation:16.1.2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Host script results:</span></span><br><span class="line"><span class="string">|_nbstat: NetBIOS name: LIRUILONG, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:15:5d:1d:9f:bd (Microsoft)</span></span><br><span class="line"><span class="string">| smb2-security-mode:</span></span><br><span class="line"><span class="string">|   2.02:</span></span><br><span class="line"><span class="string">|_    Message signing enabled but not required</span></span><br><span class="line"><span class="string">| smb2-time:</span></span><br><span class="line"><span class="string">|   date: 2021-09-27T12:43:57</span></span><br><span class="line"><span class="string">|_  start_date: N/A</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span></span><br><span class="line"><span class="string">Nmap done: 1 IP address (1 host up) scanned in 148.10 seconds</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">┌──(liruilong㉿Liruilong)-[/mnt/c/Users/lenovo]</span></span><br><span class="line"><span class="string">└─$</span></span><br></pre></td></tr></table></figure>

</div><div class="article-licensing box"><div class="licensing-title"><p>关于 Linux 中安全方面的一些笔记</p><p><a href="https://liruilongs.github.io/2021/07/30/Linux/关于 Linux 中安全方面的一些笔记/">https://liruilongs.github.io/2021/07/30/Linux/关于 Linux 中安全方面的一些笔记/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="https://liruilongs.github.io"><p>山河已无恙</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-07-30</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2023-06-21</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/2021/02/26/web/%E3%80%8A%E7%99%BD%E5%B8%BD%E5%AD%90%E8%AE%B2Web%E5%AE%89%E5%85%A8%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" target="_blank">《白帽子讲Web安全》读书笔记</a><br></span></div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 推荐文章</span><br><span>  1.<a class="is-size-6" href="/2021/08/27/K8s/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AKubernetes%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97-%E4%BB%8EDocker%E5%88%B0Kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A8%E6%8E%A5%E8%A7%A6%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" target="_blank">《Kubernetes权威指南:从Docker到Kubernetes实践全接触》读书笔记</a><br></span><span>  2.<a class="is-size-6" href="/2023/06/17/AI&amp;%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/AdaFace%EF%BC%9A-%E9%80%9A%E8%BF%87AdaFace%E5%AE%9E%E7%8E%B0%E4%BD%8E%E8%B4%A8%E9%87%8F%E9%9D%A2%E9%83%A8%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E7%B2%BE%E5%87%86%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/" target="_blank">AdaFace(CVPR(2022))：通过AdaFace实现低质量面部数据集的人脸识别</a><br></span><span>  3.<a class="is-size-6" href="/2023/05/04/AI&amp;%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/DeepFace%EF%BC%9A%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB%E5%BA%93%20DeepFace%20%E7%AE%80%E5%8D%95%E8%AE%A4%E7%9F%A5/" target="_blank">DeepFace：人脸识别库 DeepFace 简单认知</a><br></span><span>  4.<a class="is-size-6" href="/2023/07/24/AI&amp;%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/%E4%BD%BF%E7%94%A8-OpenCV-%E8%BF%9B%E8%A1%8C%E5%9B%BE%E5%83%8F%E6%A8%A1%E7%B3%8A%E5%BA%A6%E6%A3%80%E6%B5%8B-%E6%8B%89%E6%99%AE%E6%8B%89%E6%96%AF%E6%96%B9%E5%B7%AE%E6%96%B9%E6%B3%95/" target="_blank">使用 OpenCV 进行图像模糊度检测(拉普拉斯方差方法)</a><br></span><span>  5.<a class="is-size-6" href="/2023/06/15/AI&amp;%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/Nvidia%203060%20%E6%98%BE%E5%8D%A1%20CUDA%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA(Ubuntu22.04+Nvidia%20510+Cuda11.6+cudnn8.8)/" target="_blank">Nvidia 3060 显卡 CUDA 环境搭建(Ubuntu22.04+Nvidia 510+Cuda11.6+cudnn8.8)</a><br></span><span>  6.<a class="is-size-6" href="/2023/05/17/AI&amp;%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/%E5%85%B3%E4%BA%8EOpenCv%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7%E5%8C%85-imutils-%E7%AE%80%E5%8D%95%E8%AE%A4%E7%9F%A5/" target="_blank">关于 OpenCV 图像处理工具包 imutils 简单认知</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/alipay%EF%BF%A5.png" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/wechat%EF%BF%A5.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/08/10/Linux/%E5%85%B3%E4%BA%8E%20Linux%E4%B8%ADGit%E7%AD%89%E7%9F%A5%E8%AF%86%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">关于 Linux中Git等知识的一些笔记</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/07/30/Linux/%E5%85%B3%E4%BA%8E%20Linux%E4%B8%AD%20shell%E7%AD%89%E7%9F%A5%E8%AF%86%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/"><span class="level-item">关于 linux中 shell等知识的一些笔记</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><div class="card"><div class="card-content"><div class="title is-5">评论</div><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            language:'zh-CN',
            id: '16dde879a39607184f9318798b0a72d5',
            repo: 'blog_comment',
            owner: 'LIRUILONGS',
            clientID: '9fdc9739266d48d5f62e',
            clientSecret: 'c1cc33697d099a2197650ec9dadcb16bd4904655',
            admin: ["LIRUILONGS"],
            createIssueManually: true,
            distractionFreeMode: true,
            perPage: 10,
            pagerDirection: 'last',
            proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token',
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><ul class="menu-list"><li><a class="is-flex is-mobile" href="#写在前面"><span class="mr-2">1.1</span><span>写在前面</span></a></li></ul><li><a class="is-flex is-mobile" href="#一、Linux基本防护"><span class="mr-2">2</span><span>一、Linux基本防护</span></a><ul class="menu-list"><ul class="menu-list"><li><a class="is-flex is-mobile" href="#账号的锁定-x2F-解锁"><span class="mr-2">2.1.1</span><span>账号的锁定/解锁</span></a></li><li><a class="is-flex is-mobile" href="#强制定期修改密码"><span class="mr-2">2.1.2</span><span>强制定期修改密码</span></a></li><li><a class="is-flex is-mobile" href="#伪装登录提示"><span class="mr-2">2.1.3</span><span>伪装登录提示</span></a></li></ul><li><a class="is-flex is-mobile" href="#文件系统安全"><span class="mr-2">2.2</span><span>文件系统安全</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#锁定-x2F-解锁保护文件"><span class="mr-2">2.2.1</span><span>锁定/解锁保护文件</span></a></li><li><a class="is-flex is-mobile" href="#文件系统挂载熟悉"><span class="mr-2">2.2.2</span><span>文件系统挂载熟悉</span></a></li><li><a class="is-flex is-mobile" href="#程序和服务控制"><span class="mr-2">2.2.3</span><span>程序和服务控制</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#二、用户切换与提权"><span class="mr-2">3</span><span>二、用户切换与提权</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#su切换用户身份"><span class="mr-2">3.1</span><span>su切换用户身份</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#切换与提权的应用场景"><span class="mr-2">3.1.1</span><span>切换与提权的应用场景</span></a></li><li><a class="is-flex is-mobile" href="#su切换的基本用法-Substitube-User，换人"><span class="mr-2">3.1.2</span><span>su切换的基本用法:Substitube User，换人</span></a></li><li><a class="is-flex is-mobile" href="#su操作示例"><span class="mr-2">3.1.3</span><span>su操作示例</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#sudo-提升执行权限"><span class="mr-2">3.2</span><span>sudo 提升执行权限</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#sudo提权的基本用法"><span class="mr-2">3.2.1</span><span>sudo提权的基本用法</span></a></li><li><a class="is-flex is-mobile" href="#配置sudo提权"><span class="mr-2">3.2.2</span><span>配置sudo提权</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#三、sshd访问控制"><span class="mr-2">4</span><span>三、sshd访问控制</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#SSH基本防护"><span class="mr-2">4.1</span><span>SSH基本防护</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#SSH防护概述"><span class="mr-2">4.1.1</span><span>SSH防护概述</span></a></li><li><a class="is-flex is-mobile" href="#sshd基本安全配置"><span class="mr-2">4.1.2</span><span>sshd基本安全配置</span></a></li><li><a class="is-flex is-mobile" href="#SSH密钥对验证"><span class="mr-2">4.1.3</span><span>SSH密钥对验证</span></a></li><li><a class="is-flex is-mobile" href="#密钥对验证的实现思路"><span class="mr-2">4.1.4</span><span>密钥对验证的实现思路</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#四、加密与解密"><span class="mr-2">5</span><span>四、加密与解密</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#加解密概述"><span class="mr-2">5.1</span><span>加解密概述</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#加密目的及方式"><span class="mr-2">5.1.1</span><span>加密目的及方式</span></a></li><li><a class="is-flex is-mobile" href="#常见的加密算法"><span class="mr-2">5.1.2</span><span>常见的加密算法</span></a></li><li><a class="is-flex is-mobile" href="#MD5完整性检验"><span class="mr-2">5.1.3</span><span>MD5完整性检验</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#GPG加解密厂具"><span class="mr-2">5.2</span><span>GPG加解密厂具</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#GnuPG简介"><span class="mr-2">5.2.1</span><span>GnuPG简介</span></a></li><li><a class="is-flex is-mobile" href="#GPG对称加解密"><span class="mr-2">5.2.2</span><span>GPG对称加解密</span></a></li><li><a class="is-flex is-mobile" href="#GPG非对称加解密"><span class="mr-2">5.2.3</span><span>GPG非对称加解密</span></a></li><li><a class="is-flex is-mobile" href="#GPG软件签名与验证"><span class="mr-2">5.2.4</span><span>GPG软件签名与验证</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#五、AIDE入侵检测"><span class="mr-2">6</span><span>五、AIDE入侵检测</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#初始化系统"><span class="mr-2">6.1</span><span>初始化系统</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#安装软件包"><span class="mr-2">6.1.1</span><span>安装软件包</span></a></li><li><a class="is-flex is-mobile" href="#修改配置文件"><span class="mr-2">6.1.2</span><span>修改配置文件</span></a></li><li><a class="is-flex is-mobile" href="#修改配置文件-1"><span class="mr-2">6.1.3</span><span>修改配置文件</span></a></li><li><a class="is-flex is-mobile" href="#初始化检查"><span class="mr-2">6.1.4</span><span>初始化检查</span></a></li><li><a class="is-flex is-mobile" href="#备份数据库"><span class="mr-2">6.1.5</span><span>备份数据库</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#入侵检查"><span class="mr-2">6.2</span><span>入侵检查</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#执行入侵检查"><span class="mr-2">6.2.1</span><span>执行入侵检查</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#六，端口扫描"><span class="mr-2">7</span><span>六，端口扫描</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#为什么需要扫描？"><span class="mr-2">7.1</span><span>为什么需要扫描？</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#扫描方式及工具"><span class="mr-2">7.1.1</span><span>扫描方式及工具</span></a></li><li><a class="is-flex is-mobile" href="#常见的安全分析工具"><span class="mr-2">7.1.2</span><span>常见的安全分析工具</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#NMAP扫描"><span class="mr-2">7.2</span><span>NMAP扫描</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#NMAP应用示例"><span class="mr-2">7.2.1</span><span>NMAP应用示例</span></a></li></ul></li></ul></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class=""><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7.jpg" alt="山河已无恙"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">山河已无恙</p><p class="is-size-6 is-block">爱自己，是终生浪漫的开始</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国·呼和浩特</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">320</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">102</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">153</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://liruilong.blog.csdn.net/?t=1&amp;type=blog" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/LIRUILONGS"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="CSDN" href="https://liruilong.blog.csdn.net/"><i class="fa fa-code"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:1224965096@qq.com"><i class="fa fa-envelope"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://liruilong.blog.csdn.net/?t=1&amp;type=blog" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CSDN</span></span><span class="level-right"><span class="level-item tag">liruilong.blog.csdn.net</span></span></a></li><li><a class="level is-mobile" href="https://www.cnblogs.com/liruilong/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">博客园</span></span><span class="level-right"><span class="level-item tag">www.cnblogs.com</span></span></a></li><li><a class="level is-mobile" href="https://github.com/LIRUILONGS" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Githup</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li><li><a class="level is-mobile" href="https://gitee.com/liruilonger" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">码云</span></span><span class="level-right"><span class="level-item tag">gitee.com</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新评论</h3><span class="body_hot_comment">加载中，最新评论有1分钟缓存...</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-12-18T20:39:30.000Z">2023-12-19</time></p><p class="title"><a href="/2023/12/19/%E5%BE%85%E5%8F%91%E5%B8%83/Stable-Diffusion-Windows%E9%83%A8%E7%BD%B2%E7%AE%80%E7%AD%94%E8%AE%A4%E7%9F%A5/">Stable Diffusion 简单认知 Windows 部署</a></p><p class="categories"><a href="/categories/test3/">test3</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-11-19T19:40:00.000Z">2023-11-20</time></p><p class="title"><a href="/2023/11/20/%E5%BE%85%E5%8F%91%E5%B8%83/Golang%20VScode%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">Golang VScode 开发环境搭建</a></p><p class="categories"><a href="/categories/GO/">GO</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-11-15T12:44:37.000Z">2023-11-15</time></p><p class="title"><a href="/2023/11/15/%E5%BE%85%E5%8F%91%E5%B8%83/%E5%9F%BA%E4%BA%8E%20selenium%20%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%AB%99%E5%9B%BE%E7%89%87%E9%87%87%E9%9B%86/">基于 selenium 实现网站图片采集</a></p><p class="categories"><a href="/categories/selenium/">selenium</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-11-13T20:29:38.000Z">2023-11-14</time></p><p class="title"><a href="/2023/11/14/%E5%BE%85%E5%8F%91%E5%B8%83/%E5%85%B3%E4%BA%8E-Kubernetes%E4%B8%ADAdmission-Controllers-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/">关于 Kubernetes中Admission Controllers(准入控制器) 认知的一些笔记</a></p><p class="categories"><a href="/categories/Kubernetes/">Kubernetes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-11-13T19:52:18.000Z">2023-11-14</time></p><p class="title"><a href="/2023/11/14/%E5%BE%85%E5%8F%91%E5%B8%83/K8s%20Pod%20%E5%88%9B%E5%BB%BA%E5%9F%8B%E7%82%B9%E5%A4%84%E7%90%86(Mutating%20%20Admission%20Webhook)/">K8s Pod 创建埋点处理(Mutating  Admission Webhook)</a></p><p class="categories"><a href="/categories/test3/">test3</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/AdaFace/"><span class="level-start"><span class="level-item">AdaFace</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ajax/"><span class="level-start"><span class="level-item">Ajax</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ansible/"><span class="level-start"><span class="level-item">Ansible</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/AppCube/"><span class="level-start"><span class="level-item">AppCube</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Bind9/"><span class="level-start"><span class="level-item">Bind9</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CI-CD/"><span class="level-start"><span class="level-item">CI/CD</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CSS/"><span class="level-start"><span class="level-item">CSS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ceph/"><span class="level-start"><span class="level-item">Ceph</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/DAD-3DHeads/"><span class="level-start"><span class="level-item">DAD-3DHeads</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/DNS/"><span class="level-start"><span class="level-item">DNS</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2023/12/"><span class="level-start"><span class="level-item">十二月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/11/"><span class="level-start"><span class="level-item">十一月 2023</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/10/"><span class="level-start"><span class="level-item">十月 2023</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/09/"><span class="level-start"><span class="level-item">九月 2023</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/08/"><span class="level-start"><span class="level-item">八月 2023</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Kubernetes/"><span class="tag">Kubernetes</span><span class="tag is-grey-lightest">91</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag is-grey-lightest">34</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ansible/"><span class="tag">Ansible</span><span class="tag is-grey-lightest">25</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ceph/"><span class="tag">Ceph</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Docker/"><span class="tag">Docker</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JAVA/"><span class="tag">JAVA</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go/"><span class="tag">Go</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OpenShift/"><span class="tag">OpenShift</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/"><span class="tag">程序人生</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DNS/"><span class="tag">DNS</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OKD/"><span class="tag">OKD</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/selenium/"><span class="tag">selenium</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%B9%E5%99%A8/"><span class="tag">容器</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C/"><span class="tag">网络</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CKA/"><span class="tag">CKA</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GO/"><span class="tag">GO</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ISCSI/"><span class="tag">ISCSI</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NFS/"><span class="tag">NFS</span><span class="tag is-grey-lightest">3</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="山河已无恙" height="28"></a><p class="size-small"><span>&copy; 2024 山河已无恙</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© <a href="http://www.beian.miit.gov.cn/" target="_blank">备案号</a><br></span><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已运行 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！❤️";
        }var now = new Date();setInterval("createTime('2021/6/26 21:27:00')", 250,"");</script><br></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2364053447" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/katex.min.css"><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/katex.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/contrib/auto-render.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/contrib/mhchem.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdnjs.loli.net/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('9fdc9739266d48d5f62e','c1cc33697d099a2197650ec9dadcb16bd4904655','LIRUILONGS','blog_comment',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(true){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('9fdc9739266d48d5f62e','c1cc33697d099a2197650ec9dadcb16bd4904655','LIRUILONGS','blog_comment',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>