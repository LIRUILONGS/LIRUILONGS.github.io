<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>关于 linux中 shell等知识的一些笔记 - 山河已无恙</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="山河已无恙"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="山河已无恙"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="傍晚时分，你坐在屋檐下，看着天慢慢地黑下去，心里寂寞而凄凉，感到自己的生命被剥夺了。当时我是个年轻人，但我害怕这样生活下去，衰老下去。在我看来，这是比死亡更可怕的事。——–王小波"><meta property="og:type" content="blog"><meta property="og:title" content="山河已无恙"><meta property="og:url" content="https://liruilong.blog.csdn.net/?t=1&amp;type=blog"><meta property="og:site_name" content="山河已无恙"><meta property="og:description" content="傍晚时分，你坐在屋檐下，看着天慢慢地黑下去，心里寂寞而凄凉，感到自己的生命被剥夺了。当时我是个年轻人，但我害怕这样生活下去，衰老下去。在我看来，这是比死亡更可怕的事。——–王小波"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://liruilong.blog.csdn.net/img/头像.jpg"><meta property="article:published_time" content="2021-07-30T13:39:39.000Z"><meta property="article:modified_time" content="2023-06-21T11:25:59.090Z"><meta property="article:author" content="LIRUILONGS"><meta property="article:tag" content="shell"><meta property="article:tag" content="Liunx"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/头像.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://liruilongs.github.io/2021/07/30/Linux/%E5%85%B3%E4%BA%8E%20Linux%E4%B8%AD%20shell%E7%AD%89%E7%9F%A5%E8%AF%86%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/"},"headline":"山河已无恙","image":["https://img-blog.csdnimg.cn/f2b7a0fe702147499174468b2492aa6c.png"],"datePublished":"2021-07-30T13:39:39.000Z","dateModified":"2023-06-21T11:25:59.090Z","author":{"@type":"Person","name":"山河已无恙"},"description":"傍晚时分，你坐在屋檐下，看着天慢慢地黑下去，心里寂寞而凄凉，感到自己的生命被剥夺了。当时我是个年轻人，但我害怕这样生活下去，衰老下去。在我看来，这是比死亡更可怕的事。——–王小波"}</script><link rel="canonical" href="https://liruilongs.github.io/2021/07/30/Linux/%E5%85%B3%E4%BA%8E%20Linux%E4%B8%AD%20shell%E7%AD%89%E7%9F%A5%E8%AF%86%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/"><link rel="alternate" href="/path/to/atom.xml" title="山河已无恙" type="application/atom+xml"><link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?3f06f2b732a5b1034c989f74e28d0eea";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css"><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.2"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="山河已无恙" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/media">影音</a><a class="navbar-item" href="/album">相册</a><a class="navbar-item" href="/friend">友链</a><a class="navbar-item" href="/self-talking">生活小记</a><a class="navbar-item" href="/message">留言墙</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Gitee" href="https://gitee.com/liruilonger"><i class="fab fa-git-square fa-1x"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/LIRUILONGS"><i class="fab fa-github fa-1x"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul fa-1x"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search fa-1x"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon fa-1x" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2021-07-30  <a class="commentCountImg" href="/2021/07/30/Linux/%E5%85%B3%E4%BA%8E%20Linux%E4%B8%AD%20shell%E7%AD%89%E7%9F%A5%E8%AF%86%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/#comment-container"><span class="display-none-class">53df322dbbeca86c07798866c46fa4d9</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="53df322dbbeca86c07798866c46fa4d9">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>1 小时  <i class="fas fa-pencil-alt"> </i>13.4 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">关于 linux中 shell等知识的一些笔记</h1><div class="content"><p><strong><font color="009688"> 傍晚时分，你坐在屋檐下，看着天慢慢地黑下去，心里寂寞而凄凉，感到自己的生命被剥夺了。当时我是个年轻人，但我害怕这样生活下去，衰老下去。在我看来，这是比死亡更可怕的事。——–王小波</strong></font></p>
<span id="more"></span>
<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><hr>
<ul>
<li>笔记是上课后整理的笔记，适合温习，不适合新手，希望对小伙伴有帮助</li>
<li>笔记内容包括：Shell一些常见情境</li>
</ul>
<p><strong><font color="009688"> 傍晚时分，你坐在屋檐下，看着天慢慢地黑下去，心里寂寞而凄凉，感到自己的生命被剥夺了。当时我是个年轻人，但我害怕这样生活下去，衰老下去。在我看来，这是比死亡更可怕的事。——–王小波</strong></font></p>
<hr>
<h1 id="一、Shell-基础知识"><a href="#一、Shell-基础知识" class="headerlink" title="一、Shell 基础知识"></a><font color=green>一、Shell 基础知识</font></h1><h2 id="1-1-什么是-Shell"><a href="#1-1-什么是-Shell" class="headerlink" title="1.1 什么是 Shell"></a><font color=camel>1.1 什么是 Shell</font></h2><p><strong><font color=brown>shell 是用户 与 Linux 内核之间的解释器</font></strong></p>
<p><strong><font color=brown>区分 shell 和 bash:shell是解释器的总称，bash是一类解释器。</font></strong></p>
<h3 id="Bash基本特性"><a href="#Bash基本特性" class="headerlink" title="Bash基本特性"></a><font color=camel>Bash基本特性</font></h3><p><strong><font color=tomato>查看当前在使用得解释器,不会显示临时切换的解释器,查看当前系统支持得解释器类型</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> <span class="variable">$SHELL</span> <span class="comment">#查看当前在使用得解释器,不会显示临时切换的解释器</span></span><br><span class="line">/bin/bash</span><br><span class="line">[root@liruilong ~]$ cat /etc/shells <span class="comment">#查看当前系统支持得解释器类型</span></span><br><span class="line">/bin/sh</span><br><span class="line">/bin/bash</span><br><span class="line">/sbin/nologin</span><br><span class="line">/usr/bin/sh</span><br><span class="line">/usr/bin/bash</span><br><span class="line">/usr/sbin/nologin</span><br><span class="line">/bin/tcsh</span><br><span class="line">/bin/csh</span><br></pre></td></tr></table></figure>
<p><strong><font color=chocolate>临时使用其他的解释器,查看设置用户得解释器类型</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ sh <span class="comment">#临时使用其他的解释器</span></span><br><span class="line">[root@liruilong ~]$ useradd zhangsan <span class="comment">#创建用户</span></span><br><span class="line">[root@liruilong ~]$ cat /etc/passwd | grep zhangsan <span class="comment">#查看用户得解释器类型</span></span><br><span class="line">zhangsan:x:1002:1002::/home/zhangsan:/bin/bash</span><br><span class="line">[root@liruilong ~]$ usermod -s /bin/tcsh zhangsan <span class="comment">#修改zhangsan得解释器</span></span><br><span class="line">[root@liruilong ~]$ cat /etc/passwd | grep zhangsan</span><br><span class="line">zhangsan:x:1002:1002::/home/zhangsan:/bin/tcsh</span><br><span class="line">[root@liruilong ~]$ su - zhangsan <span class="comment">#切换用户，验证用户得解释器类型</span></span><br><span class="line">[zhangsan@liruilong ~]$ <span class="built_in">echo</span> <span class="variable">$SHELL</span></span><br><span class="line">/bin/tcsh</span><br><span class="line">[zhangsan@liruilong ~]$</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/7522dcd82bbd498c8676391775ffe191.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="Bash的优点"><a href="#Bash的优点" class="headerlink" title="Bash的优点"></a><strong><font color=plum>Bash的优点</font></strong></h3><ul>
<li><strong><font color=tomato>快捷键、Tab键补齐</font></strong><ul>
<li><code>Ctrl + A</code> #将光标移动到命令行首</li>
<li><code>Ctrl + E</code> #将光标移动到命令行尾</li>
<li><code>Ctrl + C</code> #中断正在执行的命令</li>
<li><code>Ctrl + L</code> #清屏</li>
<li><code>Ctrl + W</code> #从光标位置，往回删一个单词</li>
<li><code>Ctrl + U</code> #从光标位置，往回删到开头</li>
</ul>
</li>
<li><strong><font color=orange>命令历史 ( history )</font></strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ <span class="built_in">history</span> <span class="comment">#查看历史记录</span></span><br><span class="line">[root@liruilong ~]$ <span class="built_in">history</span> -c <span class="comment">#清空历史记录</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/profile <span class="comment">#修改历史记录的数量</span></span><br><span class="line">46 HISTSIZE=1000</span><br></pre></td></tr></table></figure></li>
<li><strong><font color=seagreen>命令别名 (alias)</font></strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ <span class="built_in">alias</span> <span class="comment">#查看当前用户可以使用的别名</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/fa1f10f13cc14cba9bf00ec280713a0c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ vim /root/.bashrc <span class="comment">#重开一个终端生效，针对root用户生效</span></span><br><span class="line"><span class="built_in">alias</span> ens33=<span class="string">&#x27;cat /etc/sysconfig/network-scripts/ifcfg-ens33&#x27;</span></span><br><span class="line">[root@liruilong ~]$ vim /etc/bashrc <span class="comment">#重开一个终端生效，针对所有用户生效</span></span><br><span class="line"><span class="built_in">alias</span> ens33=<span class="string">&#x27;cat /etc/sysconfig/network-scripts/ifcfg-ens33&#x27;</span></span><br></pre></td></tr></table></figure>
<h4 id="标准输入与输出的重定向-gt-、-gt-gt-、2-gt-、2-gt-gt-、-amp-gt"><a href="#标准输入与输出的重定向-gt-、-gt-gt-、2-gt-、2-gt-gt-、-amp-gt" class="headerlink" title="标准输入与输出的重定向 ( &gt;、&gt;&gt;、2&gt;、2&gt;&gt;、&amp;&gt; )"></a><font color=blue>标准输入与输出的重定向 ( &gt;、&gt;&gt;、2&gt;、2&gt;&gt;、&amp;&gt; )</font></h4><p><strong><font color=red>正确输出重定向覆盖，&gt; 等同于 1&gt;</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##正确输出重定向覆盖，&gt; 等同于 1&gt;</span></span><br><span class="line">[root@liruilong ~]$ ls /etc/passwd &gt; /root/1.txt</span><br><span class="line">[root@liruilong ~]$ cat /root/1.txt</span><br><span class="line">/etc/passwd</span><br></pre></td></tr></table></figure>
<p><strong><font color=tomato>正确输出重定向追加, 1&gt;&gt; 等同于 1&gt;&gt;</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##正确输出重定向追加, 1&gt;&gt; 等同于 1&gt;&gt;</span></span><br><span class="line">[root@liruilong ~]$ ls /etc/passwd &gt;&gt; /root/1.txt</span><br><span class="line">[root@liruilong ~]$ cat /root/1.txt</span><br><span class="line">/etc/passwd</span><br><span class="line">/etc/passwd</span><br></pre></td></tr></table></figure>
<p><strong><font color=amber>错误输出重定向覆盖追加</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##错误输出重定向覆盖</span></span><br><span class="line">[root@liruilong ~]$ ls --helps 2&gt; /root/2.txt</span><br><span class="line">[root@liruilong ~]$ cat /root/2.txt</span><br><span class="line">ls：无法识别的选项“--helps”</span><br><span class="line">Try <span class="string">&#x27;ls --help&#x27;</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="comment">##错误输出重定向追加</span></span><br><span class="line">[root@liruilong ~]$ ls --helps 2&gt;&gt; /root/2.txt</span><br><span class="line">[root@liruilong ~]$ cat 2.txt</span><br><span class="line">ls：无法识别的选项“--helps”</span><br><span class="line">Try <span class="string">&#x27;ls --help&#x27;</span> <span class="keyword">for</span> more information.</span><br><span class="line">ls：无法识别的选项“--helps”</span><br><span class="line">Try <span class="string">&#x27;ls --help&#x27;</span> <span class="keyword">for</span> more information.</span><br></pre></td></tr></table></figure>
<p><strong><font color=yellowgreen>错误或正确的输出重定向覆盖追加</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##错误或正确的输出重定向覆盖</span></span><br><span class="line">[root@liruilong ~]$ ls /etc/shadow /root/fsdfs &amp;&gt; /root/3.txt</span><br><span class="line">[root@liruilong ~]$ cat /root/3.txt</span><br><span class="line">ls: 无法访问/root/fsdfs: 没有那个文件或目录</span><br><span class="line"><span class="comment">##错误或正确的输出重定向追加</span></span><br><span class="line">[root@liruilong ~]$ ls /etc/shadow /root/fsdfs &amp;&gt;&gt; /root/3.txt</span><br><span class="line">[root@liruilong ~]$ cat /root/3.txt</span><br><span class="line">ls: 无法访问/root/fsdfs: 没有那个文件或目录</span><br><span class="line">/etc/shadow</span><br><span class="line">[root@liruilong ~]$ cat /root/3.txt</span><br><span class="line">ls: 无法访问/root/fsdfs: 没有那个文件或目录</span><br><span class="line">/etc/shadow</span><br></pre></td></tr></table></figure>
<h4 id="管道"><a href="#管道" class="headerlink" title="管道 ( | )"></a><strong><font color=green>管道 ( | )</font></strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##管道的应用</span></span><br><span class="line">[root@liruilong ~]$ cat /etc/passwd | less</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> <span class="string">&quot;123&quot;</span> | passwd --stdin zhangsan</span><br></pre></td></tr></table></figure>
<h3 id="Shell-执行命令的方式"><a href="#Shell-执行命令的方式" class="headerlink" title="Shell 执行命令的方式"></a><font color=brown>Shell 执行命令的方式</font></h3><ul>
<li>交互式 (命令行)<ul>
<li>人工干预</li>
<li>逐条解释执行、效率低</li>
</ul>
</li>
<li>非交换式(脚本)<ul>
<li>需要提前设计</li>
<li>批量执行、效率高</li>
<li>修改用户的 Shell 解释器:<code>/etc/shadow</code></li>
</ul>
</li>
</ul>
<h1 id="二、脚本设计与运行"><a href="#二、脚本设计与运行" class="headerlink" title="二、脚本设计与运行"></a><font color=brown>二、脚本设计与运行</font></h1><h2 id="2-1-编写Shell-脚本"><a href="#2-1-编写Shell-脚本" class="headerlink" title="2.1 编写Shell 脚本"></a><font color=orange>2.1 编写Shell 脚本</font></h2><table>
<thead>
<tr>
<th><font color=green>什么是 Shell 脚本</font></th>
</tr>
</thead>
<tbody><tr>
<td>提前将可执行的命令语句写入一个文件</td>
</tr>
<tr>
<td>顺序执行</td>
</tr>
<tr>
<td>解释器逐行解释代码</td>
</tr>
</tbody></table>
<p><strong><font color=camel>第一个 Shell 脚本</font></strong></p>
<table>
<thead>
<tr>
<th>编写一个 Hello Word脚本</th>
</tr>
</thead>
<tbody><tr>
<td>新建文件</td>
</tr>
<tr>
<td>添加可执行语句 (命令)</td>
</tr>
<tr>
<td>给文件添加 x 执行权限</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ mkdir -p /root/shell/day01</span><br><span class="line">[root@liruilong ~]$ vim /root/shell/day01/first.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello World&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="规范脚本的构成"><a href="#规范脚本的构成" class="headerlink" title="规范脚本的构成"></a><font color=purple>规范脚本的构成</font></h3><table>
<thead>
<tr>
<th><strong><font color=plum>一个合格规范的脚本应该包含以下这些内容</font></strong></th>
</tr>
</thead>
<tbody><tr>
<td>#! 脚本声明 (使用哪种解释器解释代码)</td>
</tr>
<tr>
<td>注释信息 (步骤、思路、用途等)，以 #</td>
</tr>
<tr>
<td>可执行的语句</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ vim /root/shell/day01/first.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#A test program for Shell.</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello World&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="2-2-执行-Shell-脚本"><a href="#2-2-执行-Shell-脚本" class="headerlink" title="2.2 执行 Shell 脚本"></a><font color=tomato>2.2 执行 Shell 脚本</font></h2><table>
<thead>
<tr>
<th><strong><font color=seagreen>方法一：需要为文件赋予可执行的权限</font></strong></th>
</tr>
</thead>
<tbody><tr>
<td>绝对路径执行</td>
</tr>
<tr>
<td>相对路径执行</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ chmod +x /root/shell/day01/first.sh <span class="comment">#赋予执行权限</span></span><br><span class="line">[root@liruilong ~]$ /root/shell/day01/first.sh <span class="comment">#以绝对路径的方式运行脚本</span></span><br><span class="line">Hello World</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">cd</span> /root/shell/day01</span><br><span class="line">[root@liruilong day01]<span class="comment"># ./first.sh #以相对路径运行脚本，【.】只得是当前目录</span></span><br><span class="line">Hello World</span><br><span class="line">```  </span><br><span class="line">|**&lt;font color=camel&gt;方法二：不需要文件有可执行的权限&lt;/font&gt;**|</span><br><span class="line">|--|</span><br><span class="line">|sh 脚本文件名|</span><br><span class="line">|<span class="built_in">source</span> 脚本文件名 &lt;font color=red&gt;<span class="comment">#不会启动子进程，通过pstree 查看进程树&lt;/font&gt;|</span></span><br><span class="line">  </span><br><span class="line">![在这里插入图片描述](https://img-blog.csdnimg.cn/4a91b49b11234548a52250efffa28b27.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70)</span><br><span class="line">```bash</span><br><span class="line">[root@liruilong ~]$ chmod -x /root/shell/day01/first.sh <span class="comment">#取消脚本的执行权限</span></span><br><span class="line">[root@liruilong ~]$ ls -l /root/shell/day01/first.sh</span><br><span class="line">-rw-r--r-- 1 root root 58 7月 4 11:03 /root/shell/day01/first.sh</span><br><span class="line">[root@liruilong ~]$ sh /root/shell/day01/first.sh <span class="comment">#用开启子进程的方式运行脚本</span></span><br><span class="line">Hello World</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/f989670192d84a969e78739dd4b6a19f.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="![在这里插入图片描述](https://img-blog.csdnimg.cn/0ed77c927305454dbe40ae57e34b93"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ <span class="built_in">source</span> /root/shell/day01/first.sh <span class="comment">#运行脚本时不会开启子进程</span></span><br><span class="line">Hello World</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello World&quot;</span></span><br><span class="line">sleep 100 <span class="comment">#休眠100秒</span></span><br><span class="line">[root@liruilong ~]$ yum -y install psmisc <span class="comment">#pstree的软件包</span></span><br><span class="line">[root@liruilong ~]$ sh /root/hello.sh <span class="comment">#终端A上运行脚本</span></span><br><span class="line">[root@liruilong ~]$ pstree <span class="comment">#终端B验证，查看进程树</span></span><br><span class="line">├─sshd─┬─sshd───bash───sh───sleep</span><br><span class="line">└─sshd───bash───pstree</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">source</span> /root/hello.sh <span class="comment">#终端A上运行脚本</span></span><br><span class="line">[root@liruilong ~]$ pstree <span class="comment">#终端B验证，查看进程树</span></span><br><span class="line">├─sshd─┬─sshd───bash───sleep</span><br><span class="line">└─sshd───bash───pstree</span><br></pre></td></tr></table></figure>


<h1 id="三、变量"><a href="#三、变量" class="headerlink" title="三、变量"></a><font color=blue>三、变量</font></h1><h2 id="3-1-自定义变量"><a href="#3-1-自定义变量" class="headerlink" title="3.1 自定义变量"></a><font color=green>3.1 自定义变量</font></h2><p><strong><font color=red>以固定的名称，存放可以能有变化的值</font></strong></p>
<h4 id="定义变量"><a href="#定义变量" class="headerlink" title="定义变量"></a><font color=seagreen>定义变量</font></h4><ul>
<li><strong><font color=purple>定义变量的格式：变量名&#x3D;变量值</font></strong></li>
<li><strong><font color=purple>取消变量的格式：unset 变量名</font></strong></li>
</ul>
<table>
<thead>
<tr>
<th><font color=orange>注意事项：</font></th>
</tr>
</thead>
<tbody><tr>
<td>&#x3D; 两边不能有空格，不要使用关键字做变量名，如：ls、cd等；</td>
</tr>
<tr>
<td>如果变量名已经存在则覆盖之前的变量值；</td>
</tr>
<tr>
<td>变量名称有：字母&#x2F;数字&#x2F;下划线，不能以数字开始；</td>
</tr>
</tbody></table>
<h4 id="查看变量"><a href="#查看变量" class="headerlink" title="查看变量"></a><font color=royalblue>查看变量</font></h4><ul>
<li>查看变量的语法格式： <code>$变量名</code> <code>$&#123;变量名&#125;</code><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###脚本中得变量并不需要回收，运行完成后系统会自动回收变量</span></span><br><span class="line">[root@liruilong ~]$ x=12 <span class="comment">#给变量x赋值为12</span></span><br><span class="line">[root@liruilong ~]$ var1=centos <span class="comment">#给变量var1赋值为centos</span></span><br><span class="line">[root@liruilong ~]$ _a=12 <span class="comment">#变量名以下划线开头</span></span><br><span class="line">[root@liruilong ~]$ a_0=<span class="string">&quot;hello world&quot;</span> <span class="comment">#变量的值可以是字符串</span></span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> <span class="variable">$x</span> <span class="comment">#输出变量x的值</span></span><br><span class="line">12</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> <span class="variable">$_a</span> <span class="comment">#输出变量$_a的值</span></span><br><span class="line">12</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> <span class="variable">$a_0</span> <span class="comment">#输出变量$_0的值</span></span><br><span class="line">hello world</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> <span class="variable">$&#123;var1&#125;</span>6.5 <span class="comment">#输出变量 var1的值，为了区分，用&#123;var1&#125;表示</span></span><br><span class="line">centos6.5</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">unset</span> x <span class="comment">#取消定义的变量x</span></span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> <span class="variable">$x</span> <span class="comment">#再次输出结果为空</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="3-2系统预设变量"><a href="#3-2系统预设变量" class="headerlink" title="3.2系统预设变量"></a><strong><font color=amber>3.2系统预设变量</font></strong></h2><table>
<thead>
<tr>
<th><font color=chocolate>变量类型</font></th>
</tr>
</thead>
<tbody><tr>
<td>环境变量(变量名通常大写，有操作系统维护)；</td>
</tr>
<tr>
<td>位置变量(bash内置变量，存储脚本执行时的参数)；</td>
</tr>
<tr>
<td>预定义变量(bash内置变量，可以调用但是不能赋值或修改)；</td>
</tr>
<tr>
<td>自定义变量(用户自主设置)</td>
</tr>
</tbody></table>
<h4 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a><font color=royalblue>环境变量</font></h4><table>
<thead>
<tr>
<th>环境变量</th>
</tr>
</thead>
<tbody><tr>
<td>存储在 <code>/etc/profile</code> 或<code> ~/.bash_profile</code></td>
</tr>
<tr>
<td>命令 <code>env</code> 可以列出所有环境变量</td>
</tr>
<tr>
<td>常见环境变量：<code>PATH、PWD、USER、UID、HOME、SHELL</code></td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> <span class="variable">$PATH</span> <span class="comment">#默认搜索路径</span></span><br><span class="line">/usr/<span class="built_in">local</span>/sbin:/usr/<span class="built_in">local</span>/bin:/usr/sbin:/usr/bin:/root/bin</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> <span class="variable">$UID</span> <span class="comment">#当前用户对应得UID号</span></span><br><span class="line">0</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> <span class="variable">$USER</span> <span class="comment">#当前系统得登录用户</span></span><br><span class="line">root</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> <span class="variable">$HOME</span> <span class="comment">#当前登录用户得家目录</span></span><br><span class="line">/root</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">cd</span> /etc/sysconfig/network-scripts/</span><br><span class="line">[root@liruilong network-scripts]<span class="comment"># echo $PWD #显示当前用户得所在路径</span></span><br><span class="line">/etc/sysconfig/network-scripts</span><br><span class="line">[root@liruilong ~]$ [root@liruilong ~]$ <span class="built_in">echo</span> <span class="variable">$SHELL</span> <span class="comment">#显示当前用户使用得解释器</span></span><br><span class="line">/bin/bash</span><br></pre></td></tr></table></figure>

<h4 id="位置变量"><a href="#位置变量" class="headerlink" title="位置变量"></a><font color=royalblue>位置变量</font></h4><table>
<thead>
<tr>
<th>位置变量</th>
</tr>
</thead>
<tbody><tr>
<td><code>存储脚本执行时的参数:</code></td>
</tr>
<tr>
<td><code>使用 $n 表示，n 为数字序列号</code></td>
</tr>
<tr>
<td><code>$1、$2、... 、$&#123;10&#125;、$&#123;11&#125;、...</code></td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ vim /root/shell/day01/user.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#test positional parameters.</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$1</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$2</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$3</span></span><br><span class="line">[root@liruilong ~]$ bash /root/shell/day01/user.sh aa 99 cc</span><br><span class="line">aa</span><br><span class="line">99</span><br><span class="line">cc</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><font color=blue>通过位置变量创建系统账户，配置密码</font></strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ vim /root/shell/day01/user02.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#read username and pass from positional parameters.</span></span><br><span class="line">useradd <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="comment">#创建用户</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$2</span>&quot;</span> | passwd --stdin <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="comment">#给用户设置密码</span></span><br><span class="line">[root@liruilong ~]$ sh /root/shell/day01/user02.sh tom 123</span><br><span class="line">更改用户 tom 的密码 。</span><br><span class="line">passwd：所有的身份验证令牌已经成功更新。</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="预定义变量"><a href="#预定义变量" class="headerlink" title="预定义变量"></a><font color=green>预定义变量</font></h4><table>
<thead>
<tr>
<th>预定义变量</th>
</tr>
</thead>
<tbody><tr>
<td>用来保存脚本程序的执行信息</td>
</tr>
<tr>
<td>直接使用这些变量</td>
</tr>
<tr>
<td>不能直接为这些变量赋值</td>
</tr>
</tbody></table>
<p><img src="https://img-blog.csdnimg.cn/f2b7a0fe702147499174468b2492aa6c.png" alt="在这里插入图片描述"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]$ ls /tmp/</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> $? <span class="comment">#返回上一条命令的执行状态：0 为正确，非0 为错误</span></span><br><span class="line">0</span><br><span class="line">[root@liruilong ~]$ cat /root/sfsfsd</span><br><span class="line">cat: /root/sfsfsd: 没有那个文件或目录</span><br><span class="line">[root@liruilong ~]$ <span class="built_in">echo</span> $? <span class="comment">#上一条命令执行失败，返回一个非0值</span></span><br><span class="line">1</span><br><span class="line">[root@liruilong ~]$ vim /root/shell/day01/pre.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$0</span> <span class="comment">#输出当前得脚本名</span></span><br><span class="line"><span class="built_in">echo</span> $* <span class="comment">#输出所有得位置变量</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$#</span> <span class="comment">#输出位置变量得数量</span></span><br><span class="line"><span class="built_in">echo</span> $$ <span class="comment">#输出脚本的进程号，每次运行脚本进程号不同</span></span><br><span class="line">[root@liruilong ~]$ bash /root/shell/day01/pre.sh aa bb 88 qq</span><br><span class="line">/root/shell/day01/pre.sh <span class="comment"># $0执行结果</span></span><br><span class="line">aa bb 88 qq <span class="comment"># $*执行结果</span></span><br><span class="line">4 <span class="comment"># $#执行结果</span></span><br><span class="line">3255 <span class="comment"># $$脚本进程号</span></span><br><span class="line">[root@liruilong ~]$</span><br></pre></td></tr></table></figure>
<h1 id="四、变量的扩展应用"><a href="#四、变量的扩展应用" class="headerlink" title="四、变量的扩展应用"></a><font color=amber>四、变量的扩展应用</font></h1><h2 id="4-1-各种引号"><a href="#4-1-各种引号" class="headerlink" title="4.1 各种引号"></a><font color=chocolate>4.1 各种引号</font></h2><h4 id="多种引号的区别"><a href="#多种引号的区别" class="headerlink" title="多种引号的区别"></a><font color=chocolate>多种引号的区别</font></h4><table>
<thead>
<tr>
<th><strong><font color=red>区别三种定界符</font></strong></th>
<th>–</th>
</tr>
</thead>
<tbody><tr>
<td>双引号 “ “</td>
<td>允许扩展，以 $ 引用其他变量；</td>
</tr>
<tr>
<td>单引号 ‘ ‘</td>
<td>禁用扩展，即便 $ 也视为普通符号；</td>
</tr>
<tr>
<td>反引号 &#96;&#96;</td>
<td>将命令的执行输出作为变量值，$() 与反引号等效；</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># touch a b c #创建的是三个文件</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># touch &quot;a b c&quot; #双引号让其代表一个文件</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># touch &#x27;b c d&#x27; #单引号作用这里是与双引号相同</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># ls -l #查看</span></span><br><span class="line">-rw-r--r-- 1 root root 0 7月 6 09:36 a</span><br><span class="line">-rw-r--r-- 1 root root 0 7月 6 09:36 b</span><br><span class="line">-rw-r--r-- 1 root root 0 7月 6 09:36 c</span><br><span class="line">-rw-r--r-- 1 root root 0 7月 6 09:48 a b c</span><br><span class="line">-rw-r--r-- 1 root root 0 7月 6 09:48 b c d</span><br><span class="line">[root@liruilong ~]<span class="comment"># rm -rf &quot;a b c&quot; #删除时要引号引起来</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># rm -rf &#x27;b c d&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># echo $HOME #输出家目录路径</span></span><br><span class="line">/root</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &#x27;$HOME&#x27; #只输出 $HOME 字符串，&#x27;&#x27;屏蔽特殊符号的含义</span></span><br><span class="line"><span class="variable">$HOME</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &#x27;$USER id is $UID&#x27;</span></span><br><span class="line"><span class="variable">$USER</span> id is <span class="variable">$UID</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $USER id is $UID</span></span><br><span class="line">root id is 0</span><br><span class="line">[root@liruilong ~]<span class="comment"># test=`grep root /etc/shadow`</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># test01=$(grep root /etc/shadow)</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $test</span></span><br><span class="line">root:$6<span class="variable">$Uebh9</span>/WEzEaQfT<span class="variable">$8b0B6oBgWUTEmYojDW9</span>.6PHOw0.jD7A.SENsHFD/YPwh/L9jRJK0yWAtRF4BEteYZETeMiInp72dTviSKmLZf.:18501:0:99999:7::: dockerroot:!!:18691::::::</span><br><span class="line">[root@liruilong ~]<span class="comment">#  echo $test01</span></span><br><span class="line">root:$6<span class="variable">$Uebh9</span>/WEzEaQfT<span class="variable">$8b0B6oBgWUTEmYojDW9</span>.6PHOw0.jD7A.SENsHFD/YPwh/L9jRJK0yWAtRF4BEteYZETeMiInp72dTviSKmLZf.:18501:0:99999:7::: dockerroot:!!:18691::::::</span><br><span class="line">[root@liruilong ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="4-2-read-命令定义变量"><a href="#4-2-read-命令定义变量" class="headerlink" title="4.2 read 命令定义变量"></a><font color=purple>4.2 read 命令定义变量</font></h2><h4 id="read-标准输入取值"><a href="#read-标准输入取值" class="headerlink" title="read 标准输入取值"></a><font color=amber>read 标准输入取值</font></h4><table>
<thead>
<tr>
<th>read 标准输入取值</th>
</tr>
</thead>
<tbody><tr>
<td>read 从键盘读入变量值完成赋值</td>
</tr>
<tr>
<td>格式：<code>read [-p &quot;提示信息&quot;] 变量名 </code></td>
</tr>
<tr>
<td><code>-p 可选</code>，<code>-t 可指定超时秒数</code>，<code>-s 设置是否在终端显示输入的内容</code></td>
</tr>
</tbody></table>
<p><strong><font color=red>交互式定义变量</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># read name #交互式定义变量</span></span><br><span class="line">haha <span class="comment">#输入名字</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $name #查看变量</span></span><br><span class="line">haha</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># read -p &quot;请输入用户名:&quot; name #交互式定义变量</span></span><br><span class="line">请输入用户名:xixi</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $name #查看变量</span></span><br><span class="line">xixi</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><font color=camel>从键盘读取用户名密码，创建用户并设置密码</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day01/user03.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">##read 从键盘读取用户名密码，创建用户并设置密码</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入一个用户名：&quot;</span> name</span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入密码：&quot;</span> pass</span><br><span class="line">useradd <span class="variable">$name</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$pass</span>&quot;</span> | passwd --stdin <span class="variable">$name</span></span><br><span class="line"><span class="comment">##脚本测试</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># source /root/shell/day01/user03.sh</span></span><br><span class="line">请输入一个用户名：nana</span><br><span class="line">请输入密码：123456</span><br><span class="line">更改用户 nana 的密码 。</span><br><span class="line">passwd：所有的身份验证令牌已经成功更新。</span><br></pre></td></tr></table></figure>
<p><strong><font color=camel>read 从键盘读取用户名密码，创建用户并设置密码,要求不显示输入密码</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day01/user03.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">##read 从键盘读取用户名密码，创建用户并设置密码,要求不显示输入密码</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入一个用户名：&quot;</span> name</span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入密码：&quot;</span> -s pass</span><br><span class="line">useradd <span class="variable">$name</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$pass</span>&quot;</span> | passwd --stdin <span class="variable">$name</span></span><br><span class="line"><span class="comment">##脚本测试</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># source /root/shell/day01/user03.sh</span></span><br><span class="line">请输入一个用户名：haha</span><br><span class="line">请输入密码：更改用户 haha 的密码 。</span><br><span class="line">passwd：所有的身份验证令牌已经成功更新。</span><br><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day01/user03.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br></pre></td></tr></table></figure>
<p><strong><font color=green>不输入就会自动退出：如果后面不加秒数，则不会自动退出</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##read 从键盘读取用户名密码，创建用户并设置密码,要求不显示输入密码</span></span><br><span class="line"><span class="comment">##-t 多少秒不输入就会自动退出：如果后面不加秒数，则不会自动退出</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入一个用户名：&quot;</span> name</span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入密码：&quot;</span> -s -t 3 pass</span><br><span class="line">useradd <span class="variable">$name</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$pass</span>&quot;</span> | passwd --stdin <span class="variable">$name</span></span><br><span class="line"><span class="comment">##脚本测试</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># source /root/shell/day01/user03.sh</span></span><br><span class="line">请输入一个用户名：lisi</span><br><span class="line">请输入密码：更改用户 lisi 的密码 。 <span class="comment">#超过3秒退出</span></span><br><span class="line">passwd: 鉴定令牌操作错误</span><br></pre></td></tr></table></figure>
<h2 id="4-3-全局变量-or-局部变量"><a href="#4-3-全局变量-or-局部变量" class="headerlink" title="4.3 全局变量 or 局部变量"></a><font color=camel>4.3 全局变量 or 局部变量</font></h2><h4 id="变量的作用范围"><a href="#变量的作用范围" class="headerlink" title="变量的作用范围"></a><font color=plum>变量的作用范围</font></h4><table>
<thead>
<tr>
<th>变量的作用范围</th>
<th>–</th>
</tr>
</thead>
<tbody><tr>
<td>局部变量</td>
<td>新定义的变量默认只是在当前 Shell 环境中有效，无法在子 Shell 环境中使用</td>
</tr>
<tr>
<td>全局变量</td>
<td>系统中的任何 Shell 环境中都有效</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####开启两个终端，A和B来测试</span></span><br><span class="line"><span class="comment">#终端A上操作</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># x=11 #定义局部变量</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh #进入sh子进程</span></span><br><span class="line">sh-4.2<span class="comment"># echo $x #无此变量，输出为空</span></span><br><span class="line"><span class="comment">#终端B上操作</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># pstree #查看进程树</span></span><br><span class="line">......</span><br><span class="line">├─sshd─┬─sshd───bash───sh</span><br><span class="line">│ └─sshd───bash───pstree</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p><strong><font color=plum>使用  <code>export</code> 定义全局变量</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#终端A上操作</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># export x=12 #定义全局变量</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh #开启sh子进程</span></span><br><span class="line">sh-4.2<span class="comment"># echo $x #新的解释器里变量也生效</span></span><br><span class="line">12</span><br><span class="line">sh-4.2<span class="comment"># bash #开启bash子进程</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $x #新的解释器里变量也生效</span></span><br><span class="line">12</span><br><span class="line">[root@liruilong ~]<span class="comment"># pstree #查看进程树</span></span><br><span class="line">......</span><br><span class="line">├─sshd─┬─sshd───bash───sh───bash</span><br><span class="line">└─sshd───bash───pstree</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<h1 id="五、Shell-中的运算"><a href="#五、Shell-中的运算" class="headerlink" title="五、Shell 中的运算"></a><font color=blue>五、Shell 中的运算</font></h1><h2 id="5-1-整数运算"><a href="#5-1-整数运算" class="headerlink" title="5.1 整数运算"></a><font color=plum>5.1 整数运算</font></h2><h4 id="基本运算法则"><a href="#基本运算法则" class="headerlink" title="基本运算法则"></a><font color=tomato>基本运算法则</font></h4><table>
<thead>
<tr>
<th>基本运算法则</th>
</tr>
</thead>
<tbody><tr>
<td><strong><font color=brown>四则运算</font></strong></td>
</tr>
<tr>
<td>加法：num1 + num2</td>
</tr>
<tr>
<td>减法：num1 - num2</td>
</tr>
<tr>
<td>乘法：num1 * num2</td>
</tr>
<tr>
<td>整除：num1 &#x2F; num2</td>
</tr>
<tr>
<td><strong><font color=red>取余数运算</font></strong></td>
</tr>
<tr>
<td>求模：num1 % num2</td>
</tr>
</tbody></table>
<h4 id="算式替换"><a href="#算式替换" class="headerlink" title="$[] 算式替换"></a><code>$[] 算式替换</code></h4><ul>
<li>使用 <code>$[ ]</code> 或 <code>$(( ))</code> 表达式<ul>
<li>格式：$[整数1 运算符 整数2……]</li>
<li>计算结果替换表达式本身，可结合 echo 命令输出<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># echo $[1+2]</span></span><br><span class="line">3</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $[2*3]</span></span><br><span class="line">6</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># x=15;y=3 #定义两个临时变量x,y</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $[x+y] #加法运算</span></span><br><span class="line">18</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $[x-y] #减法运算</span></span><br><span class="line">12</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $[x*y] #乘法运算</span></span><br><span class="line">45</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $[x/3] #除法运算</span></span><br><span class="line">5</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $[x%3] #取余运算(除尽)</span></span><br><span class="line">0</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $[x%2] #取余运算(未除尽)</span></span><br><span class="line">1</span><br><span class="line">[root@liruilong ~]<span class="comment"># x=15;y=3 #定义两个临时变量x,y</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $((x+y)) #加法运算</span></span><br><span class="line">18</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $((x-y)) #减法运算</span></span><br><span class="line">12</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $((x*y)) #乘法运算</span></span><br><span class="line">45</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $((x/y)) #除法运算</span></span><br><span class="line">5</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $((x%y)) #取余运算(除尽)</span></span><br><span class="line">0</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $((x%y)) #取余运算(未除尽)</span></span><br><span class="line">1</span><br><span class="line">[root@liruilong ~]<span class="comment"># x=2 #定义变量x=2</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $[x+=4] #输出x值，x=x+4</span></span><br><span class="line">6</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $x #输出x值</span></span><br><span class="line">6</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h4 id="变量的自增-x2F-减等操作"><a href="#变量的自增-x2F-减等操作" class="headerlink" title="变量的自增&#x2F;减等操作"></a><font color=plum>变量的自增&#x2F;减等操作</font></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># echo $[x+=1] #输出x值，x=x+1</span></span><br><span class="line">7</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $x #输出x值</span></span><br><span class="line">7</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $[x*=3] #输出x值，x=x*3</span></span><br><span class="line">21</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $x #输出x值</span></span><br><span class="line">21</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $[x++] #输出x+1前的值</span></span><br><span class="line">21</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $x #这是x+1后的值</span></span><br><span class="line">22</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $[x--] #输出x-1前的值</span></span><br><span class="line">22</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $x #输出x-1后的值</span></span><br><span class="line">21</span><br></pre></td></tr></table></figure>
<h4 id="let-指定算术运算"><a href="#let-指定算术运算" class="headerlink" title="let 指定算术运算"></a><font color=royalblue>let 指定算术运算</font></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####let 用于指定算术运算</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># let i=2*3 #将算术运算 2*3 赋予变量 i</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $i</span></span><br><span class="line">6</span><br><span class="line">[root@liruilong ~]<span class="comment"># let i=3*6 #将算术运算 3*6 赋予变量 i</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $i</span></span><br><span class="line">18</span><br><span class="line">[root@liruilong ~]<span class="comment"># b=2 #定义变量</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># let b+=2 #变量赋值，b=b+2</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $b</span></span><br><span class="line">4</span><br><span class="line">[root@liruilong ~]<span class="comment"># let b*=3 #变量赋值，b=b*3</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $b</span></span><br><span class="line">12</span><br><span class="line">[root@liruilong ~]<span class="comment"># x=2</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># let x++;echo $x # ;用来区分两条命令</span></span><br><span class="line">3</span><br><span class="line">[root@liruilong ~]<span class="comment"># let x++;echo $x # ;用来区分两条命令</span></span><br><span class="line">4</span><br><span class="line">[root@liruilong ~]<span class="comment"># let x+=3;echo $x # ;用来区分两条命令</span></span><br><span class="line">7</span><br></pre></td></tr></table></figure>
<h2 id="5-2-小数运算"><a href="#5-2-小数运算" class="headerlink" title="5.2 小数运算"></a><font color=camel>5.2 小数运算</font></h2><h4 id="bc计算器"><a href="#bc计算器" class="headerlink" title="bc计算器"></a><font color=orange>bc计算器</font></h4><p><strong><font color=green>Bash 内建机制仅支持整数运算，不支持小数运算</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># echo $[12.2+23]</span></span><br><span class="line">-bash: 12.2+23: 语法错误: 无效的算术运算符 (错误符号是 <span class="string">&quot;.2+23&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><strong><font color=blue>我们可以通过计算器软件<code> bc</code> 实现<code>小数运算</code></font></strong></p>
<p>我们没有该软件则需要使用<code>yum</code>安装； <code>bc支持交换式和非交换式两种计算</code>，<code>scale=n </code>可以约束小数位,<code>quit </code>退出交互式计算</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># yum -y install bc #安装bc软件包</span></span><br><span class="line"><span class="comment">###使用bc进行交互运算</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># bc</span></span><br><span class="line">12+23 <span class="comment">#加法运算</span></span><br><span class="line">35</span><br><span class="line">23.43*1.243 <span class="comment">#乘法运算</span></span><br><span class="line">29.123</span><br><span class="line">23/2 <span class="comment">#除法运算</span></span><br><span class="line">11</span><br><span class="line">23%3 <span class="comment">#取余运算</span></span><br><span class="line">2</span><br><span class="line">quit <span class="comment">#退出命令</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;1.2+3.3&quot; | bc</span></span><br><span class="line">4.5</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;1.2+3.3;3.8*2.7&quot; | bc #同时进行多个运算</span></span><br><span class="line">4.5</span><br><span class="line">10.2</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;scale=2;10/2&quot; |bc #scale=2 结果小数位保留两位</span></span><br><span class="line">5.00</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;scale=2;17/2&quot; |bc</span></span><br><span class="line">8.50</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;scale=2;17.34/2&quot; |bc #scale=2 结果小数位保留两位</span></span><br></pre></td></tr></table></figure>

<h4 id="小数的比较"><a href="#小数的比较" class="headerlink" title="小数的比较"></a><font color=plum>小数的比较</font></h4><ul>
<li>bc 支持的比较操作符：<code>&gt;、&gt;=、&lt;、&lt;=、==、!=</code></li>
<li>表达式成立则返回1，否则返回0</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;1&gt;2&quot; | bc #比较错误，1小于2，结果为0</span></span><br><span class="line">0</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;5&gt;2&quot; | bc #比较正确，5大于2，结果为1</span></span><br><span class="line">1</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;2==2&quot; | bc #比较正确，2等于2，结果为1</span></span><br><span class="line">1</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;2!=2&quot; | bc #比较错误，2等于2，结果为0</span></span><br><span class="line">0</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;12.34 &lt; 8.8&quot; | bc #比较错误，12.34 大于 8.8，结果为0</span></span><br><span class="line">0</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;12.34 != 8.8&quot; | bc #比较正确，12.34不等于8.8</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;hello world&quot; #echo 默认会换行</span></span><br><span class="line">hello world</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo -n &quot;hello world&quot; #-n 取消 echo 命令的默认换行</span></span><br><span class="line">hello world</span><br><span class="line">[root@liruilong ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<h1 id="六、综合案例"><a href="#六、综合案例" class="headerlink" title="六、综合案例"></a><font color=seagreen>六、综合案例</font></h1><h2 id="6-1-监控脚本之显示硬件信息"><a href="#6-1-监控脚本之显示硬件信息" class="headerlink" title="6.1 监控脚本之显示硬件信息"></a><font color=royalblue>6.1 监控脚本之显示硬件信息</font></h2><h4 id="echo回显"><a href="#echo回显" class="headerlink" title="echo回显"></a><font color=amber>echo回显</font></h4><ul>
<li>-n选项：不换行</li>
<li>-e选项：支持扩展属性</li>
</ul>
<h4 id="改变echo输出的文本颜色"><a href="#改变echo输出的文本颜色" class="headerlink" title="改变echo输出的文本颜色"></a><font color=chocolate>改变echo输出的文本颜色</font></h4><ul>
<li>echo -e “\033[文字颜色m 文字 \033[0m”</li>
<li>文字颜色：30 ———– 37</li>
</ul>
<p>30:黑 34:蓝色<br>31:红 35:紫色<br>32:绿 36:深绿<br>33:黄 37:白色</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># echo -e &quot;\033[32m天气预报\033[0m&quot; #0m还原文字颜色，让颜色只作用</span></span><br><span class="line">于当前字体</span><br><span class="line">hello <span class="comment">#32绿色字</span></span><br></pre></td></tr></table></figure>

<h4 id="监控硬件信息"><a href="#监控硬件信息" class="headerlink" title="监控硬件信息"></a><font color=camel>监控硬件信息</font></h4><p><strong><font color=plum>显示服务器硬件信息</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###最小化安装需要安装查看IP的软件包</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># which ifconfig</span></span><br><span class="line">/usr/sbin/ifconfig</span><br><span class="line">[root@liruilong ~]<span class="comment"># rpm -qf /usr/sbin/ifconfig</span></span><br><span class="line">net-tools-2.0-0.22.20131004git.el7.x86_64</span><br><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day01/info.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">##显示服务器硬件信息</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[34m----------服务器硬件信息----------\033[0m&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m网卡信息如下：\033[0m&quot;</span></span><br><span class="line">ifconfig ens33 | grep <span class="string">&quot;inet&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m剩余内容容量信息如下: \033[0m&quot;</span></span><br><span class="line">grep MemAvailable /proc/meminfo</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m磁盘容量信息如下: \033[0m&quot;</span></span><br><span class="line">df -h /</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32mCPU信息如下:\033[0m&quot;</span></span><br><span class="line">grep <span class="string">&quot;model name&quot;</span> /proc/cpuinfo</span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day01/info.sh #运行脚本</span></span><br><span class="line">----------服务器硬件信息----------</span><br><span class="line">网卡信息如下：</span><br><span class="line">inet 192.168.4.5 netmask 255.255.255.0 broadcast 192.168.4.255</span><br><span class="line">inet6 fe80::452e:bf37:6ef7:c2fa prefixlen 64 scopeid 0x20&lt;link&gt;</span><br><span class="line">剩余内容容量信息如下:</span><br><span class="line">MemAvailable: 1238268 kB</span><br><span class="line">磁盘容量信息如下:</span><br><span class="line">文件系统 容量 已用 可用 已用% 挂载点</span><br><span class="line">/dev/mapper/centos-root 50G 7.2G 43G 15% /</span><br><span class="line">CPU信息如下:</span><br><span class="line">model name : Intel(R) Core(TM) i7-1065G7 CPU @ 1.30GHz</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/4bc41c66a4fa47518d2ffa57a3300fbd.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="计算例题"><a href="#计算例题" class="headerlink" title="计算例题"></a><font color=tomato>计算例题</font></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day01/calc.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">##计算1+2+3,...,+n的和，可以使用n*(n+1)/2公式快速计算结果</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入一个正整数:&quot;</span> num</span><br><span class="line">sum=$[num*(num+1)/2]</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m<span class="variable">$num</span>以内整数的总和是:<span class="variable">$sum</span> \033[0m&quot;</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day01/calc.sh</span></span><br><span class="line">请输入一个正整数:23</span><br><span class="line">23以内整数的总和是:276</span><br><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day01/area.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">##使用三角形的底边和高计算面积：A=1/2底高</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入三角形底边长度:&quot;</span> bottom</span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入三角形的高度:&quot;</span> hight</span><br><span class="line">A=$(<span class="built_in">echo</span> <span class="string">&quot;scale=2;1/2*<span class="variable">$bottom</span>*<span class="variable">$hight</span>&quot;</span> | bc)</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m三角形的面积是:<span class="variable">$A</span>\033[0m&quot;</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day01/area.sh</span></span><br><span class="line">请输入三角形底边长度:23</span><br><span class="line">请输入三角形的高度:5</span><br><span class="line">三角形的面积是:57.50</span><br><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day01/tixingmianhi.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">##梯形面积:(上底边长度+下底边长度)*高/2</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入梯形上底边长度:&quot;</span> a</span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入梯形下底边长度:&quot;</span> b</span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入梯形高度:&quot;</span> h</span><br><span class="line">A=$(<span class="built_in">echo</span> <span class="string">&quot;scale=2;(<span class="variable">$a</span>+<span class="variable">$b</span>)*<span class="variable">$h</span>/2&quot;</span> | bc)</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m梯形面积是:<span class="variable">$A</span>\033[0m&quot;</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh -x /root/shell/day01/tixingmianhi.sh #-x执行时测试</span></span><br><span class="line">+ <span class="built_in">read</span> -p 请输入梯形上底边长度: a</span><br><span class="line">请输入梯形上底边长度:32</span><br><span class="line">+ <span class="built_in">read</span> -p 请输入梯形下底边长度: b</span><br><span class="line">请输入梯形下底边长度:45</span><br><span class="line">+ <span class="built_in">read</span> -p 请输入梯形高度: h</span><br><span class="line">请输入梯形高度:7</span><br><span class="line">++ <span class="built_in">echo</span> <span class="string">&#x27;scale=2;(32+45)*7/2&#x27;</span></span><br><span class="line">++ bc</span><br><span class="line">+ A=269.50</span><br><span class="line">+ <span class="built_in">echo</span> -e <span class="string">&#x27;\033[32m梯形面积是:269.50\033[0m&#x27;</span></span><br><span class="line">梯形面积是:269.50</span><br><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day01/yuanmianji.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">###使用A=πr2 公式计算圆的面积，取2位小数点精度，π=3.14</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入圆的半径:&quot;</span> r</span><br><span class="line">A=`<span class="built_in">echo</span> <span class="string">&quot;scale=2;3.14*<span class="variable">$r</span>*2&quot;</span> | bc`</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m圆的面积是:<span class="variable">$A</span>\033[0m&quot;</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh -x /root/shell/day01/yuanmianji.sh #-x执行时测试</span></span><br><span class="line">+ <span class="built_in">read</span> -p 请输入圆的半径: r</span><br><span class="line">请输入圆的半径:25</span><br><span class="line">++ <span class="built_in">echo</span> <span class="string">&#x27;scale=2;3.14*25*2&#x27;</span></span><br><span class="line">++ bc</span><br><span class="line">+ A=157.00</span><br><span class="line">+ <span class="built_in">echo</span> -e <span class="string">&#x27;\033[32m圆的面积是:157.00\033[0m&#x27;</span></span><br><span class="line">圆的面积是:157.00</span><br></pre></td></tr></table></figure>

<h4 id="配置-YUM-源脚本"><a href="#配置-YUM-源脚本" class="headerlink" title="配置 YUM 源脚本"></a><font color=chocolate>配置 YUM 源脚本</font></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day01/yum.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">###配置本地yum仓库</span></span><br><span class="line"><span class="comment">#删除所有.repo文件</span></span><br><span class="line">rm -rf /etc/yum.repos.d/*</span><br><span class="line"><span class="comment">#挂载本地光盘</span></span><br><span class="line">mkdir /centos</span><br><span class="line">mount /dev/cdrom /centos</span><br><span class="line">chmod +x /etc/rc.d/rc.local</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;mount /dev/cdrom /centos&quot;</span> &gt;&gt; /etc/rc.d/rc.local</span><br><span class="line"><span class="comment">#创建yum源配置文件</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[Centos]</span></span><br><span class="line"><span class="string">name=centos7.5</span></span><br><span class="line"><span class="string">baseurl=file:///centos</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">gpgcheck=0&quot;</span> &gt; /etc/yum.repos.d/centos.repo</span><br><span class="line"><span class="comment">#yum 测试</span></span><br><span class="line">yum clean all</span><br><span class="line">yum repolist</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># sh -x /root/shell/day01/yum.sh</span></span><br><span class="line">+ rm -rf /etc/yum.repos.d/centos.repo</span><br><span class="line">+ mkdir /centos</span><br><span class="line">+ mount /dev/cdrom /centos</span><br><span class="line">mount: /dev/sr0 写保护，将以只读方式挂载</span><br><span class="line">+ chmod +x /etc/rc.d/rc.local</span><br><span class="line">+ <span class="built_in">echo</span> <span class="string">&#x27;mount /dev/cdrom /centos&#x27;</span></span><br><span class="line">+ <span class="built_in">echo</span> <span class="string">&#x27;[Centos]</span></span><br><span class="line"><span class="string">name=centos7.5</span></span><br><span class="line"><span class="string">baseurl=file:///centos</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">gpgcheck=0&#x27;</span></span><br><span class="line">+ yum clean all</span><br><span class="line">+ yum repolist</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="七、字符串处理与变量初始化"><a href="#七、字符串处理与变量初始化" class="headerlink" title="七、字符串处理与变量初始化"></a><font color=orange>七、字符串处理与变量初始化</font></h1><h2 id="字符串处理机制"><a href="#字符串处理机制" class="headerlink" title="字符串处理机制"></a><font color=orange>字符串处理机制</font></h2><h4 id="子串截取"><a href="#子串截取" class="headerlink" title="子串截取"></a><font color=brown>子串截取</font></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">┌──(liruilong㉿Liruilong)-[/mnt/c/Users/lenovo]</span><br><span class="line">└─$ name=liruilong</span><br><span class="line">┌──(liruilong㉿Liruilong)-[/mnt/c/Users/lenovo]</span><br><span class="line">└─$ <span class="built_in">echo</span> <span class="variable">$name</span></span><br><span class="line">liruilong</span><br><span class="line">┌──(liruilong㉿Liruilong)-[/mnt/c/Users/lenovo]</span><br><span class="line">└─$ <span class="built_in">echo</span> <span class="variable">$&#123;#name&#125;</span></span><br><span class="line">9</span><br><span class="line">┌──(liruilong㉿Liruilong)-[/mnt/c/Users/lenovo]</span><br><span class="line">└─$ <span class="built_in">echo</span> <span class="variable">$&#123;name:0:3&#125;</span></span><br><span class="line">lir</span><br><span class="line">┌──(liruilong㉿Liruilong)-[/mnt/c/Users/lenovo]</span><br><span class="line">└─$ <span class="built_in">echo</span> <span class="variable">$&#123;name:3:3&#125;</span></span><br><span class="line">uil</span><br><span class="line">┌──(liruilong㉿Liruilong)-[/mnt/c/Users/lenovo]</span><br><span class="line">└─$ <span class="built_in">echo</span> <span class="variable">$&#123;name:3:-3&#125;</span></span><br><span class="line">uil</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="子串替换"><a href="#子串替换" class="headerlink" title="子串替换"></a><font color=chocolate>子串替换</font></h4><ul>
<li><strong><font color=blue>替换1个结果:${变量&#x2F;旧字串&#x2F;新字串}</font></strong></li>
<li><strong><font color=chocolate>替换全部结果:${变量&#x2F;&#x2F;旧字串&#x2F;新字串}</font></strong></li>
</ul>
<p><strong><font color=amber>子串替换时，变量本身的值并不会变化，只会把变化的值输出到屏幕</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###子串替换时，变量本身的值并不会变化，只会把变化的值输出到屏幕</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># phone=13812345678</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $&#123;phone/3/X&#125; # / 替换变量中的第一个3</span></span><br><span class="line">1X812345678</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $&#123;phone//3/X&#125; # // 替换变量中所有3</span></span><br><span class="line">1X812X45678</span><br><span class="line">[root@liruilong ~]<span class="comment"># info=$(head -1 /etc/passwd) #定义变量</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $info #查看变量的值</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $&#123;info/root/ROOT&#125; #替换单个root为大写</span></span><br><span class="line">ROOT:x:0:0:root:/root:/bin/bash</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $&#123;info//root/ROOT&#125; #替换所有root为大写</span></span><br><span class="line">ROOT:x:0:0:ROOT:/ROOT:/bin/bash</span><br></pre></td></tr></table></figure>

<h4 id="字串掐头"><a href="#字串掐头" class="headerlink" title="字串掐头"></a><font color=blue>字串掐头</font></h4><ul>
<li><strong><font color=brown>从左向右： 最短匹配删除：<code>$&#123;变量#关键词&#125;</code></font></strong></li>
<li><strong><font color=seagreen>从左向左：最长匹配删除：<code>$&#123;变量##关键词&#125;</code></font></strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># A=$(head -1 /etc/passwd) #定义变量</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $A #查看变量的值</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $&#123;A#*:&#125; #删除字串A中，第一个 : 前的所有字符</span></span><br><span class="line">x:0:0:root:/root:/bin/bash</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $&#123;A##*:&#125; #删除字串A中，最后一个 : 前的所有字符</span></span><br><span class="line">/bin/bash</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $A #变量A的值不会发生变化</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure>

<h4 id="字串去尾"><a href="#字串去尾" class="headerlink" title="字串去尾"></a><font color=purple>字串去尾</font></h4><ul>
<li><strong><font color=seagreen>从右向左： 最短匹配删除：<code>$&#123;变量%关键词&#125;</code></font></strong></li>
<li><strong><font color=red>从右向左：最长匹配删除：<code>$&#123;变量%%关键词&#125;</code></font></strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># A=$(head -1 /etc/passwd) #定义变量</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $A #查看变量的值</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $&#123;A%:*&#125; #删除字串A中，最后一个 : 后的所有字符</span></span><br><span class="line">root:x:0:0:root:/root</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $&#123;A%%:*&#125; #删除字串A中，第一个 : 后的所有字符</span></span><br><span class="line">root</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $A #变量A的值不会发生变化</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<strong><font color=orange>批量修改文件扩展名</font></strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># cd /root/shell/day03/</span></span><br><span class="line">[root@liruilong day03]<span class="comment"># touch &#123;a,b,c,d,e,f&#125;.txt</span></span><br><span class="line">[root@liruilong day03]<span class="comment"># vim /root/shell/day03/rename1.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">####批量修改目录下的以.txt结尾的文件为.doc结尾</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(ls *.txt)</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">mv <span class="variable">$i</span> <span class="variable">$&#123;i%.*&#125;</span>.doc <span class="comment">#通过字符串去尾的去做</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">###脚本验证</span></span><br><span class="line">[root@liruilong day03]<span class="comment"># sh ./rename1.sh</span></span><br><span class="line">[root@liruilong day03]<span class="comment"># ls</span></span><br><span class="line">[root@liruilong day03]<span class="comment"># vim /root/shell/day03/rename2.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">###批量修改文件扩展名,$1为原扩展名，$2为新扩展名</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(ls *.<span class="variable">$1</span>)</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">mv <span class="variable">$i</span> <span class="variable">$&#123;i%.*&#125;</span>.<span class="variable">$2</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">###脚本验证</span></span><br><span class="line">[root@liruilong day03]<span class="comment"># sh ./rename1.sh doc pdf</span></span><br><span class="line">[root@liruilong day03]<span class="comment"># ls</span></span><br></pre></td></tr></table></figure>
<strong><font color=tomato>变量初始化：<code>:</code></font></strong></li>
</ul>
<table>
<thead>
<tr>
<th>变量初始化</th>
</tr>
</thead>
<tbody><tr>
<td>变量有值，则返回该变量的值</td>
</tr>
<tr>
<td>变量无值，则返回初始值</td>
</tr>
<tr>
<td>格式：<code>$&#123;变量:-关键字&#125;</code></td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># X=123</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $&#123;X:-xyz&#125; #变量有值，输出该变量的值</span></span><br><span class="line">123</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo $&#123;ABC:-xyz&#125; #变量无值，输出该变量的初始值</span></span><br><span class="line">xyz</span><br></pre></td></tr></table></figure>
<p><strong><font color=camel>创建系统用户</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day03/user03.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">##创建系统用户,未设置密码，会自动赋予用户初始密码12345</span></span><br><span class="line"><span class="comment">###定义函数，输出文字的颜色</span></span><br><span class="line"><span class="function"><span class="title">color</span></span>()&#123;</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m<span class="variable">$1</span>\033[0m&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入用户名:&quot;</span> iname</span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$iname</span>&quot;</span> ];<span class="keyword">then</span></span><br><span class="line">color <span class="string">&quot;未输入用户名,脚本将退出...&quot;</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment">###输入密码，不输入密码，则赋予初始密码123456</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入密码：&quot;</span> ipass</span><br><span class="line">ipass=<span class="variable">$&#123;ipass:-123456&#125;</span></span><br><span class="line">useradd <span class="string">&quot;<span class="variable">$iname</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$ipass</span>&quot;</span> | passwd --stdin <span class="string">&quot;<span class="variable">$iname</span>&quot;</span></span><br><span class="line"><span class="comment">###测试脚本</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day03/user3.sh</span></span><br><span class="line">请输入用户名:</span><br><span class="line">未输入用户名,脚本将退出...</span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day03/user3.sh</span></span><br><span class="line">请输入用户名:zhang</span><br><span class="line">请输入密码：</span><br><span class="line">更改用户 zhang 的密码 。</span><br><span class="line">passwd：所有的身份验证令牌已经成功更新。</span><br></pre></td></tr></table></figure>


<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="一、使用sed修改配置"><a href="#一、使用sed修改配置" class="headerlink" title="一、使用sed修改配置"></a><font color=blue>一、使用sed修改配置</font></h1><h2 id="1-1-常用sed指令"><a href="#1-1-常用sed指令" class="headerlink" title="1.1 常用sed指令"></a>1.1 常用sed指令</h2><table>
<thead>
<tr>
<th>常用sed指令</th>
</tr>
</thead>
<tbody><tr>
<td>p(print): 打印行</td>
</tr>
<tr>
<td>d(delete): 删除行</td>
</tr>
<tr>
<td>c(replace): 替换行</td>
</tr>
<tr>
<td>s(substitution): 替换关键词</td>
</tr>
<tr>
<td>&#x3D;：打印行号</td>
</tr>
</tbody></table>
<h2 id="1-2-过滤数据"><a href="#1-2-过滤数据" class="headerlink" title="1.2 过滤数据"></a>1.2 过滤数据</h2><p><strong><font color=tomato>Print 指令</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##过滤网卡IP地址</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;/IPADDR/p&#x27; /etc/sysconfig/network-scripts/ifcfg-ens33</span></span><br><span class="line">IPADDR=192.168.4.5</span><br><span class="line"><span class="comment">##过滤内存信息</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># free | sed -n &#x27;/Mem/p&#x27;</span></span><br><span class="line">Mem: 1865280 373344 1072176 10544 419760 1278920</span><br><span class="line"><span class="comment">##过滤磁盘根分区信息(根分区是以/ 结尾的分区)</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># df -h | sed -n &#x27;/\/$/p&#x27;</span></span><br><span class="line">/dev/mapper/centos-root 50G 3.4G 47G 7% /</span><br><span class="line"><span class="comment">##显示第1、3、6行内容</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;1p;3p;6p&#x27; /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">sync:x:5:0:sync:/sbin:/bin/sync</span><br><span class="line"><span class="comment">##打印第2行以外的所有其他行内容</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;2!p&#x27; /etc/hosts</span></span><br><span class="line">127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br></pre></td></tr></table></figure>


<h2 id="1-3-删除数据"><a href="#1-3-删除数据" class="headerlink" title="1.3 删除数据"></a><font color=red>1.3 删除数据</font></h2><p><strong><font color=blue>Delete 指令 (不使用-i 选项，源文件不会被修改)</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##删除/etc/hosts全文，没有定位条件等于匹配所有行</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed ‘d’ /etc/hosts</span></span><br><span class="line"><span class="comment">##删除/tmp/fstab 的1到3行</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># cat /etc/fstab &gt; /tmp/fstab</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &quot;1,3d&quot; /tmp/fstab</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># vim /tmp/fstab</span></span><br><span class="line"><span class="comment">##删除不包含dev的行</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;/dev/!d&#x27; /tmp/fstab</span></span><br><span class="line"><span class="comment">##删除所有以 # 符号开头的行</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;/^#/d&#x27; /tmp/fstab</span></span><br><span class="line"><span class="comment">##删除空白行</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;/^$/d&#x27; /tmp/fstab</span></span><br></pre></td></tr></table></figure>


<h2 id="1-4-替换行"><a href="#1-4-替换行" class="headerlink" title="1.4 替换行"></a><font color=yellowgreen>1.4 替换行</font></h2><p><strong><font color=plum>Replace 指令(不使用 -i 选项，源文件不会被修改)</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##所有行替换为 123456</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;c 123456&#x27; /tmp/fstab</span></span><br><span class="line">123456</span><br><span class="line">123456</span><br><span class="line">123456</span><br><span class="line">123456</span><br><span class="line">123456</span><br><span class="line">123456</span><br><span class="line">123456</span><br><span class="line">123456</span><br><span class="line">123456</span><br><span class="line">123456</span><br><span class="line">123456</span><br><span class="line">123456</span><br><span class="line"><span class="comment">##替换IP地址为 1.1.1.1</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># file=/etc/sysconfig/network-scripts/ifcfg-ens33</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;/IPADDR/c IPADDR=1.1.1.1&#x27; $file</span></span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=none</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens33</span><br><span class="line">UUID=314ef20c-394e-4ef6-ba3b-0c6aaf47d1fc</span><br><span class="line">DEVICE=ens33</span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=1.1.1.1</span><br><span class="line">PREFIX=24</span><br><span class="line"><span class="comment">##替换/etc/hosts中包含127的行为 127.0.0.1</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># cat /etc/hosts</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;/127/c 127.0.0.1&#x27; /etc/hosts</span></span><br><span class="line">127.0.0.1</span><br><span class="line">::1 localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line"><span class="comment">##替换文件的第四行为 xxxx</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;4c xxxx&#x27; /etc/shells</span></span><br><span class="line">/bin/sh</span><br><span class="line">/bin/bash</span><br><span class="line">/sbin/nologin</span><br><span class="line">xxxx</span><br><span class="line">/usr/bin/bash</span><br><span class="line">/usr/sbin/nologin</span><br><span class="line">/bin/tcsh</span><br><span class="line">/bin/csh</span><br></pre></td></tr></table></figure>
<h2 id="1-5-替换关键词"><a href="#1-5-替换关键词" class="headerlink" title="1.5 替换关键词"></a><font color=amber>1.5 替换关键词</font></h2><p><strong><font color=seagreen>Substitution指令(不使用 -i 选项，源文件不会被修改)</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##通过echo命令定义测试文件</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;2046 2048 2046 2046</span></span><br><span class="line">&gt; 1001 2046 2999 1888</span><br><span class="line">&gt; 2046 2046 2046 2046<span class="string">&quot; &gt; test.txt</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##查看测试文件的内容</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># cat test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line"><span class="comment">##把每一行的第一个2046替换为xxxx</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;s/2046/xxxx/&#x27; test.txt</span></span><br><span class="line">xxxx 2048 2046 2046</span><br><span class="line">1001 xxxx 2999 1888</span><br><span class="line">xxxx 2046 2046 2046</span><br><span class="line"><span class="comment">##把每行中的所有的2046替换为xxxx</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;s/2046/xxxx/g&#x27; test.txt</span></span><br><span class="line">xxxx 2048 xxxx xxxx</span><br><span class="line">1001 xxxx 2999 1888</span><br><span class="line">xxxx xxxx xxxx xxxx</span><br><span class="line"><span class="comment">##把每行中的第2个2046替换为xxxx</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;s/2046/xxxx/2&#x27; test.txt</span></span><br><span class="line">2046 2048 xxxx 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">2046 xxxx 2046 2046</span><br><span class="line"><span class="comment">##把每行中的所有2046替换为(2046); &amp;就代表被替换的参数</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;s/2046/(&amp;)/g&#x27; test.txt</span></span><br><span class="line">(2046) 2048 (2046) (2046)</span><br><span class="line">1001 (2046) 2999 1888</span><br><span class="line">(2046) (2046) (2046) (2046)</span><br><span class="line"><span class="comment">##把每行中的所有2046替换为2046-1111;&amp;就代表被替换的参数</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;s/2046/&amp;-1111/&#x27; test.txt</span></span><br><span class="line">2046-1111 2048 2046 2046</span><br><span class="line">1001 2046-1111 2999 1888</span><br><span class="line">2046-1111 2046 2046 2046</span><br><span class="line"><span class="comment">##把第2行中的所有2046替换为xxxx</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;2s/2046/xxxx/g&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 xxxx 2999 1888</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line"><span class="comment">##把第2行中的所有2046替换为空，等同于删除操作</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;2s/2046//g&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2999 1888</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line"><span class="comment">##只输出修改过的行</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;2s/2046/xxxx/p&#x27; test.txt</span></span><br><span class="line">1001 xxxx 2999 1888</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><font color=orange>正则符号() 具有保留的功能</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;hello the world&quot; | sed -r &#x27;s/^(.)(.*)(.)$/\3\2\1/&#x27;</span></span><br><span class="line">dello the worlh</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;hello the world&quot; | sed -r &#x27;s/^(.)(.*)(.)$/\3\1\2/&#x27;</span></span><br><span class="line">dhello the worl</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;hello the world&quot; | sed -r &#x27;s/^(.)(.*)(.)$/\3\3/&#x27;</span></span><br><span class="line">dd</span><br><span class="line">[root@liruilong ~]<span class="comment"># echo &quot;hello the world&quot; | sed -r &#x27;s/^(.)(.*)(.)$/\3\3\2\1\1/&#x27;</span></span><br><span class="line">ddello the worlhh</span><br></pre></td></tr></table></figure>

<h2 id="1-8-打印行号"><a href="#1-8-打印行号" class="headerlink" title="1.8 打印行号"></a><font color=green>1.8 打印行号</font></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##打印第2行的行号</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;2=&#x27; /etc/passwd</span></span><br><span class="line">2</span><br><span class="line"><span class="comment">##打印包含root的行号</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;/root/=&#x27; /etc/passwd</span></span><br><span class="line">1</span><br><span class="line">10</span><br><span class="line"><span class="comment">##打印bash结尾的行的行号</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;/bash$/=&#x27; /etc/passwd</span></span><br><span class="line">1</span><br><span class="line">42</span><br><span class="line"><span class="comment">##$代表最后一行，打印最后一行的行号</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;$=&#x27; /etc/passwd</span></span><br><span class="line">42</span><br></pre></td></tr></table></figure>
<h1 id="二、sed-多行文本处理"><a href="#二、sed-多行文本处理" class="headerlink" title="二、sed 多行文本处理"></a><font color=red>二、sed 多行文本处理</font></h1><h2 id="2-1-文本块指令"><a href="#2-1-文本块指令" class="headerlink" title="2.1 文本块指令"></a><font color=chocolate>2.1 文本块指令</font></h2><table>
<thead>
<tr>
<th><font color=seagreen>文本块指令</font></th>
</tr>
</thead>
<tbody><tr>
<td>i (insert): 插入</td>
</tr>
<tr>
<td>a (append): 追加</td>
</tr>
<tr>
<td>r (read): 读 取文件</td>
</tr>
<tr>
<td>w (write): 文件另存为</td>
</tr>
</tbody></table>
<h3 id="插入指令-Insert-插入，行前写入"><a href="#插入指令-Insert-插入，行前写入" class="headerlink" title="插入指令 Insert (插入，行前写入)"></a><font color=camel>插入指令 Insert (插入，行前写入)</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##查看test.txt文件内容</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># cat test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line"><span class="comment">##在第2行前插入 ABC_XYZ</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;2i ABC_XYZ&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">ABC_XYZ</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line"><span class="comment">##在第3 行前插入 ABC_XYZ</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;3i ABC_XYZ&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">ABC_XYZ</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line"><span class="comment">##在包含 2046的行前插入两行数据ABC\nXYZ，\n是换行符</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;/2046/i ABC\nXYZ&#x27; test.txt</span></span><br><span class="line">ABC</span><br><span class="line">XYZ</span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">ABC</span><br><span class="line">XYZ</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">ABC</span><br><span class="line">XYZ</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line"><span class="comment">##在包含 1888 的行前插入两行数据ABC\nXYZ，\n是换行符</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;/1888/i ABC\nXYZ&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">ABC</span><br><span class="line">XYZ</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">2046 2046 2046 2046</span><br></pre></td></tr></table></figure>
<h3 id="Append-追加，行后写入"><a href="#Append-追加，行后写入" class="headerlink" title="Append(追加，行后写入)"></a><font color=blue>Append(追加，行后写入)</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##在第2行后面插入 ABC_XYZ</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;2a ABC_XYZ&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">ABC_XYZ</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line"><span class="comment">##在第3行后面插入 ABC_XYZ</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;3a ABC_XYZ&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line">ABC_XYZ</span><br><span class="line"><span class="comment">##在包含 2046的行后面插入两行数据ABC\nXYZ，\n是换行符</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;/2046/a ABC\nXYZ&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">ABC</span><br><span class="line">XYZ</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">ABC</span><br><span class="line">XYZ</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line">ABC</span><br><span class="line">XYZ</span><br><span class="line"><span class="comment">##在包含 1888 的行后面插入两行数据ABC\nXYZ，\n是换行符</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;/1888/a ABC\nXYZ&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">ABC</span><br><span class="line">XYZ</span><br><span class="line">2046 2046 2046 2046</span><br></pre></td></tr></table></figure>

<h3 id="导入指令-Read-将其他文件的内容导入"><a href="#导入指令-Read-将其他文件的内容导入" class="headerlink" title="导入指令:Read (将其他文件的内容导入)"></a><font color=seagreen>导入指令:Read (将其他文件的内容导入)</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##将/etc/hosts中的内容读入到 test.txt 文件第2行的后面</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;2r /etc/hosts&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1 localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line"><span class="comment">##将/etc/hosts中的内容读入到 test.txt 文件每一行数据的后面</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;r /etc/hosts&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1 localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1 localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line">127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1 localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line"><span class="comment">##将/etc/hosts中的内容读入到 test.txt 文件中包含 1888字串所在行的后面</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;/1888/r /etc/hosts&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1 localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">2046 2046 2046 2046</span><br></pre></td></tr></table></figure>

<h3 id="导出指令-Write-将文件内容导出另存到其他文件"><a href="#导出指令-Write-将文件内容导出另存到其他文件" class="headerlink" title="导出指令:Write (将文件内容导出另存到其他文件)"></a>导出指令:Write (将文件内容导出另存到其他文件)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##将test.txt 文件的所有内容另存为一个新文件 copy_test.txt</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;w copy_test.txt&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line">[root@liruilong ~]<span class="comment"># cat copy_test.txt #查看文件的内容</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line"><span class="comment">##将test.txt 文件的 2到3行另存为新文件line.txt</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;2,3w line.txt&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line">[root@liruilong ~]<span class="comment"># cat line.txt #查看新文件的内容</span></span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line"><span class="comment">##将test.txt 文件中所有包含1888的行另存为新文件 1888.txt</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed &#x27;/1888/w /opt/1888.txt&#x27; test.txt</span></span><br><span class="line">2046 2048 2046 2046</span><br><span class="line">1001 2046 2999 1888</span><br><span class="line">2046 2046 2046 2046</span><br><span class="line">[root@liruilong ~]<span class="comment"># cat /opt/1888.txt #查看文件的内容</span></span><br><span class="line">1001 2046 2999 1888</span><br></pre></td></tr></table></figure>
<h1 id="三、sed综合案例"><a href="#三、sed综合案例" class="headerlink" title="三、sed综合案例"></a><font color=tomato>三、sed综合案例</font></h1><p><strong><font color=amber>点名器</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@svr5 ~]<span class="comment"># mkdir -p /root/shell/day04/</span></span><br><span class="line">[root@svr5 ~]<span class="comment"># vim /root/shell/day04/name.txt</span></span><br><span class="line">李白</span><br><span class="line">杜甫</span><br><span class="line">白居易</span><br><span class="line">孟浩然</span><br><span class="line">苏轼</span><br></pre></td></tr></table></figure>
<p><strong><font color=camel>编写随机点名脚本</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@svr5 ~]<span class="comment"># cd /root/shell/day04</span></span><br><span class="line">[root@svr5 day04]<span class="comment"># vim roll.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">##功能描述(Description):随机点名抽奖器，按ctrl+c结束脚本.</span></span><br><span class="line">name_file=<span class="string">&quot;name.txt&quot;</span></span><br><span class="line"><span class="comment"># 获取最后一行行号</span></span><br><span class="line">line_file=$(sed -n <span class="string">&#x27;$=&#x27;</span> <span class="variable">$name_file</span>)</span><br><span class="line"><span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">clear</span><br><span class="line">tmp=$(sed -n <span class="string">&quot;$[RANDOM%<span class="variable">$line_file</span>+1]p&quot;</span> <span class="variable">$name_file</span>)</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m 随机点名器(按ctrl+c停止)：\033[0m&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m##############################\033[0m&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m \033[0m&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m <span class="variable">$tmp</span> \033[0m&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m \033[0m&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m##############################\033[0m&quot;</span></span><br><span class="line">sleep 0.1</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h1 id="一、awk基础语法"><a href="#一、awk基础语法" class="headerlink" title="一、awk基础语法"></a><font color=tomato>一、awk基础语法</font></h1><p>awk 编程语言&#x2F;数据处理引擎,创造者：Aho、Weinberger、Kernighan,基于模式匹配检查输入文本，逐行处理并输出,通常用于在 Shell 脚本中，获取指定的数据,单独用时，可对文本数据做统计</p>
<h1 id="awk-流程控制"><a href="#awk-流程控制" class="headerlink" title="awk 流程控制"></a><font color=red>awk 流程控制</font></h1><p>格式1:前置命令| awk [选项] , [条件] (指令)’<br>格式2: awk [选项] ‘ [条件] {指令}, 文件….<br>格式3: awk ,BEGIN{} [条件]{} END{}’ 文件….</p>
<h2 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a><font color=seagreen>if语句</font></h2><h3 id="单分支if判断"><a href="#单分支if判断" class="headerlink" title="单分支if判断"></a><font color=camel>单分支if判断</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;指令&#125;&#x27;</span> 文件</span><br></pre></td></tr></table></figure>
<p><code>-F: </code>: awk 指定分割符为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###if是指令必须放到&#123; if()&#123;&#125; &#125;中</span></span><br><span class="line"><span class="comment">#如果UID大于等于1000时，i自加1；最后输出i的值，i作为变量默认值为0</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># awk -F: &#x27;&#123;if($3&gt;=1000)&#123;i++&#125;&#125; END&#123;print i&#125;&#x27; /etc/passwd</span></span><br><span class="line">2</span><br><span class="line"><span class="comment">###当$1 用户名为root时，打印用户名和UID</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># awk -F: &#x27;&#123;if($1==&quot;root&quot;)&#123;print $1,$3&#125;&#125;&#x27; /etc/passwd</span></span><br><span class="line">root 0</span><br><span class="line"><span class="comment">###查看CPU的负载情况</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># uptime</span></span><br><span class="line">10:53:35 up 2 min, 1 user, load average: 0.33, 0.33, 0.14</span><br><span class="line"><span class="comment">###当cpu 15分钟的负载大于0.01时，打印15分钟的负载信息</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># uptime | awk &#x27;&#123;if($NF&gt;0.01)&#123;print &quot;CPUload:&quot;,$NF&#125;&#125;&#x27;</span></span><br><span class="line">CPUload: 0.13</span><br></pre></td></tr></table></figure>
<h3 id="双分支if判断"><a href="#双分支if判断" class="headerlink" title="双分支if判断"></a>双分支if判断</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;指令&#125;&#x27;</span> 文件</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####统计普通用户和系统用户的个数</span></span><br><span class="line"><span class="comment">##普通用户的UID号大于等于1000;系统用户的UID小于1000</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># awk -F: &#x27;&#123;if($3&gt;=1000)&#123;i++&#125; else&#123;j++&#125;&#125; END&#123;print &quot;普通用户:&quot;i,&quot;系统用户:&quot;j&#125;&#x27; /etc/passwd</span></span><br><span class="line">普通用户:3 系统用户:34</span><br><span class="line">[root@liruilong ~]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#### 统计普通文件和目录的个数</span></span><br><span class="line"><span class="comment">## 普通文件的属性以“-”开头，非“-”开头的也是目录也可以是快捷方式</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># ls -l /etc/ | awk &#x27;&#123; if($1~/^-/)&#123;x++&#125; else&#123;y++&#125; &#125; END&#123;print &quot;普通文件个数:&quot;x,&quot;目录个数:&quot;y&#125;&#x27;</span></span><br><span class="line">普通文件个数:122 目录个数:148</span><br></pre></td></tr></table></figure>
<h3 id="多分支if判断"><a href="#多分支if判断" class="headerlink" title="多分支if判断"></a>多分支if判断</h3><p><code>awk &#39;&#123; if()&#123;&#125; else if()&#123;&#125; else&#123;&#125; &#125; END&#123;&#125;&#39;</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123; if()&#123;&#125; else if()&#123;&#125; else&#123;&#125; &#125; END&#123;&#125;&#x27;</span> 文件</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###awk &#x27;&#123; if()&#123;&#125; else if()&#123;&#125; else&#123;&#125; &#125; END&#123;&#125;&#x27;</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># ls -l /etc/ | awk &#x27;&#123; if($1~/^-/)&#123;x++&#125; else if($1~/^d/)&#123;y++&#125; else&#123;z++&#125; &#125; END&#123;print &quot;普通文件:&quot;x,&quot;\n目录个数:&quot;,y,&quot;\n其他:&quot;,z&#125;&#x27;</span></span><br><span class="line">普通文件:118</span><br><span class="line">目录个数: 106</span><br><span class="line">其他: 17</span><br><span class="line">[root@liruilong ~]<span class="comment">#</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h2><p>awk 的for 循环采用与C语言一样的语法格式: <code>for(表达式1；表达式2；表达式3) &#123;指令&#125;</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##i=1，每循环一次i的值加1</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># awk &#x27;BEGIN&#123; for(i=1;i&lt;=5;i++) &#123;print i&#125; &#125;&#x27;</span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line"><span class="comment">##i=5,每循环一次i的值减1</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># awk &#x27;BEGIN&#123; for(i=5;i&gt;=1;i--)&#123;print i&#125; &#125;&#x27;</span></span><br><span class="line">5</span><br><span class="line">4</span><br><span class="line">3</span><br><span class="line">2</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="awk-数组与应用案例"><a href="#awk-数组与应用案例" class="headerlink" title="awk 数组与应用案例"></a><font color=seagreen>awk 数组与应用案例</font></h1><h2 id="awk-数组的定义及使用"><a href="#awk-数组的定义及使用" class="headerlink" title="awk 数组的定义及使用"></a><font color=purple>awk 数组的定义及使用</font></h2><p>数组的下标可以是数字，也可以是字符串</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###给数组name添加两个值，并打印数值</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># awk &#x27;BEGIN&#123;</span></span><br><span class="line">&gt; name[0]=<span class="string">&quot;jim&quot;</span>;name[1]=<span class="string">&quot;tom&quot;</span>;<span class="built_in">print</span> name[1],name[0]</span><br><span class="line">&gt; &#125;<span class="string">&#x27;</span></span><br><span class="line"><span class="string">tom jim</span></span><br></pre></td></tr></table></figure>
<h3 id="给数组name添加两个值，调用数组中的值"><a href="#给数组name添加两个值，调用数组中的值" class="headerlink" title="给数组name添加两个值，调用数组中的值"></a><font color=amber>给数组name添加两个值，调用数组中的值</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># awk &#x27;BEGIN&#123;</span></span><br><span class="line">&gt; name[0]=<span class="string">&quot;jim&quot;</span>;name[1]=<span class="string">&quot;tom&quot;</span>;<span class="built_in">print</span> name[1],name[1],name[0]</span><br><span class="line">&gt; &#125;<span class="string">&#x27;</span></span><br><span class="line"><span class="string">tom tom jim</span></span><br></pre></td></tr></table></figure>
<p><strong><font color=yellowgreen>定义数组age，age[tom]的值为22，age[jim]的值为18</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># awk &#x27;BEGIN&#123;</span></span><br><span class="line">&gt; age[<span class="string">&quot;tom&quot;</span>]=22;age[<span class="string">&quot;jim&quot;</span>]=18;<span class="built_in">print</span> age[<span class="string">&quot;tom&quot;</span>],age[<span class="string">&quot;jim&quot;</span>]</span><br><span class="line">&gt; &#125;<span class="string">&#x27;</span></span><br><span class="line"><span class="string">22 18</span></span><br></pre></td></tr></table></figure>
<p><strong><font color=red>遍历数组的值</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###定义数组x,赋值，用for循环取数组中的值</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># awk &#x27;BEGIN&#123; x[0]=0;x[1]=11;x[2]=12;x[3]=13;x[4]=14;</span></span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> x)&#123;<span class="built_in">print</span> i,x[i]&#125;</span><br><span class="line">&gt; &#125;<span class="string">&#x27;</span></span><br><span class="line"><span class="string">4 14</span></span><br><span class="line"><span class="string">0 0</span></span><br><span class="line"><span class="string">1 11</span></span><br><span class="line"><span class="string">2 12</span></span><br><span class="line"><span class="string">3 13</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<h2 id="应用案例"><a href="#应用案例" class="headerlink" title="应用案例"></a><font color=chocolate>应用案例</font></h2><p><strong><font color=blue>分组统计</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###IP为数组，数组的下表为access_log 第一列的ip地址; 数组对应的值为 ip地址出现的次数</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># awk &#x27;&#123;IP[$1]++&#125; END&#123; for(i in IP)&#123;print i,IP[i]&#125; &#125;&#x27;</span></span><br><span class="line">/root/access_log</span><br><span class="line">172.40.1.14 1</span><br><span class="line">172.40.1.1 1</span><br><span class="line">172.40.1.16 4</span><br><span class="line">172.40.1.17 6</span><br><span class="line">172.40.1.18 3</span><br></pre></td></tr></table></figure>
<p>统计每个系统账户登录的次数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment">#  who | awk &#x27;&#123;wh[$1]++&#125; END&#123;for(i in wh)&#123;print i,wh[i]&#125; &#125;&#x27;</span></span><br><span class="line">root 2</span><br><span class="line">[root@liruilong ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="awk-综合案例"><a href="#awk-综合案例" class="headerlink" title="awk 综合案例"></a>awk 综合案例</h2><h3 id="ss命令"><a href="#ss命令" class="headerlink" title="ss命令"></a>ss命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># ss -at</span></span><br><span class="line">State       Recv-Q Send-Q                 Local Address:Port                                  Peer Address:Port</span><br><span class="line">LISTEN      0      128                        127.0.0.1:webcache                                         *:*</span><br><span class="line">LISTEN      0      128                                *:ssh                                              *:*</span><br><span class="line">LISTEN      0      128 </span><br><span class="line">[root@liruilong ~]<span class="comment"># ss -atu #查看tcp和udp协议 </span></span><br><span class="line"><span class="comment">#查看tcp和udp协议,以数字显示，端口都变成了数字模式</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># ss -atun  </span></span><br><span class="line"><span class="comment">#查看tcp和udp协议,以数字显示，端口都变成了数字模式,显示进程名和PID号</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># ss -atunp  </span></span><br><span class="line"><span class="comment">#查看tcp和udp协议,以数字显示，端口都变成了数字模式,显示进程名和PID号,不显示标题行</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># ss -atunpH </span></span><br><span class="line">[root@liruilong ~]<span class="comment"># ss -s ##汇总所有的结果</span></span><br></pre></td></tr></table></figure>


<p><strong><font color=royalblue>过滤连接状态</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># mkdir -p /root/shell/day05/</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day05/net.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">##所有TCP连接的个数</span></span><br><span class="line">TCP_Total=$(ss -s | awk <span class="string">&#x27;$1==&quot;TCP&quot;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line"><span class="comment">##所有UDP连接的个数</span></span><br><span class="line">UDP_Total=$(ss -s | awk <span class="string">&#x27;$1==&quot;UDP&quot;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line"><span class="comment">##所有处于 Listen 监听状态的 TCP 端口个数</span></span><br><span class="line">TCP_Listen_Total=$(ss -antlpH | awk <span class="string">&#x27;BEGIN&#123;count=0&#125; &#123;count++&#125; END&#123;print count&#125;&#x27;</span>)</span><br><span class="line"><span class="comment">##所有处于 ESTABLISHED 状态的TCP连接个数</span></span><br><span class="line">TCP_Estab_Total=$(ss -antpH | awk <span class="string">&#x27;BEGIN&#123;count=0&#125; /^ESTAB/&#123;count++&#125; END&#123;print</span></span><br><span class="line"><span class="string">count&#125;&#x27;</span>)</span><br><span class="line"><span class="comment">##所有处于 TIME-WAIT 状态的 tcp 连接个数</span></span><br><span class="line">TCP_TIME_WAIT_Total=$(ss -antpH | awk <span class="string">&#x27;BEGIN&#123;count=0&#125; /^TIME-WAIT/&#123;count++&#125;</span></span><br><span class="line"><span class="string">END&#123;print count&#125;&#x27;</span>)</span><br><span class="line"><span class="comment">##显示TCP连接总数</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;TCP连接总数:<span class="variable">$TCP_Total</span>&quot;</span></span><br><span class="line"><span class="comment">##显示UDP连接总数</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;UDP连接总数:<span class="variable">$UDP_Total</span>&quot;</span></span><br><span class="line"><span class="comment">##显示处于LISTEN状态的TCP端口个数</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;处于LISTEN状态的TCP端口个数:<span class="variable">$TCP_Listen_Total</span>&quot;</span></span><br><span class="line"><span class="comment">##显示处于ESTABLISHED状态的TCP连接个数</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;处于ESTAB状态的TCP连接个数:<span class="variable">$TCP_Estab_Total</span>&quot;</span></span><br><span class="line"><span class="comment">##显示处于TIME-WAIT状态的TCP连接个数</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;处于TIME-WAIT状态的TCP连接个数:<span class="variable">$TCP_TIME_WAIT_Total</span>&quot;</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day05/net.sh</span></span><br><span class="line">TCP连接总数:15</span><br><span class="line">UDP连接总数:10</span><br><span class="line">处于LISTEN状态的TCP端口个数:15</span><br><span class="line">处于ESTAB状态的TCP连接个数:2</span><br><span class="line">处于TIME-WAIT状态的TCP连接个数:0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="循环嵌套"><a href="#循环嵌套" class="headerlink" title="循环嵌套"></a><font color=royalblue>循环嵌套</font></h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># mkdir /root/shell/day06</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day06/star.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"><span class="comment">#此循环的作用是输出5个*在同一行</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;*&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="comment">########################</span></span><br><span class="line"><span class="comment">#内层for循环在一行输出5个*；外层for循环，将内层循环执行5遍</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> &#123;1..5&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;*&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#####执行脚本</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day06/star.sh</span></span><br><span class="line">*****</span><br><span class="line">*****</span><br><span class="line">*****</span><br><span class="line">*****</span><br><span class="line">*****</span><br><span class="line">*****</span><br></pre></td></tr></table></figure>


<h1 id="循环嵌套-1"><a href="#循环嵌套-1" class="headerlink" title="循环嵌套"></a><font color=brown>循环嵌套</font></h1><p>打印星星矩阵</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># mkdir -p /root/shell/day06</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day06/star.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"><span class="comment">#此循环的作用是输出5个*在同一行</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;*&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="comment">########################</span></span><br><span class="line"><span class="comment">#内层for循环在一行输出5个*；外层for循环，将内层循环执行5遍</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> &#123;1..5&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;*&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#####执行脚本</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day06/star.sh</span></span><br><span class="line">*****</span><br><span class="line">*****</span><br><span class="line">*****</span><br><span class="line">*****</span><br><span class="line">*****</span><br><span class="line">*****</span><br></pre></td></tr></table></figure>
<h2 id="排列与组合"><a href="#排列与组合" class="headerlink" title="排列与组合"></a><font color=chocolate>排列与组合</font></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day06/compose.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">###打印1-3的所有两位数的排列组合方式</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..3&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> &#123;1..3&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;i&#125;</span><span class="variable">$&#123;j&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="打印形状"><a href="#打印形状" class="headerlink" title="打印形状"></a><font color=chocolate>打印形状</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day06/sharp1.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">####打印出上述图片形状</span></span><br><span class="line"><span class="keyword">for</span>((i=1;i&lt;=6;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">for</span>((j=1;j&lt;=i;j++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> -ne <span class="string">&quot;\033[46m \033[0m&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">############</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day06/sharp2.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">####打印出上述图片形状</span></span><br><span class="line"><span class="keyword">for</span>((i=1;i&lt;=6;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">for</span>((j=6;j&gt;=i;j--))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> -ne <span class="string">&quot;\033[46m \033[0m&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="带菜单的脚本"><a href="#带菜单的脚本" class="headerlink" title="带菜单的脚本"></a><font color=red>带菜单的脚本</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day06/menu.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;1.查看剩余内存容量.&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;2.查看根分区剩余容量.&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;3.查看cpu十五分钟负载.&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;4.查看系统进程数量.&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;5.查看系统账户数量.&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;6.退出.&quot;</span></span><br><span class="line"><span class="comment">###while死循环，查看过程不退出，不需要继续查看可以按6选择退出</span></span><br><span class="line"><span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入选项[1-6]:&quot;</span> key</span><br><span class="line"><span class="comment">###case语句，对用户输入key进行判断给出相应的结果</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$key</span> <span class="keyword">in</span></span><br><span class="line">1)</span><br><span class="line">   free| awk <span class="string">&#x27;/Mem/&#123;print $NF&#125;&#x27;</span>;;</span><br><span class="line">2)</span><br><span class="line">   df | awk <span class="string">&#x27;/\/$/&#123;print $4&#125;&#x27;</span>;;</span><br><span class="line">3)</span><br><span class="line">uptime | awk <span class="string">&#x27;&#123;print $NF&#125;&#x27;</span>;;</span><br><span class="line">4)</span><br><span class="line">ps -aux | wc -l;;</span><br><span class="line">5)</span><br><span class="line">sed -n <span class="string">&#x27;$=&#x27;</span> /etc/passwd;;</span><br><span class="line">6)</span><br><span class="line"><span class="built_in">exit</span>;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="备份数据"><a href="#备份数据" class="headerlink" title="备份数据"></a><font color=camel>备份数据</font></h1><h2 id="备份日志"><a href="#备份日志" class="headerlink" title="备份日志"></a><font color=brown>备份日志</font></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day06/bak_log.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">###此脚本运用日期定义备份的文件名，方便与每天进行备份不重复</span></span><br><span class="line">date=`date +<span class="string">&quot;%Y%m%d&quot;</span>`</span><br><span class="line"><span class="keyword">if</span> [ ! -f /tmp/<span class="built_in">log</span>-<span class="variable">$date</span>.tar.gz ];<span class="keyword">then</span></span><br><span class="line">tar -zcPf /tmp/<span class="built_in">log</span>-<span class="variable">$date</span>.tar.gz /var/<span class="built_in">log</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment">###执行脚本并检查输出结果</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day06/bak_log.sh</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># ls /tmp/log-*</span></span><br><span class="line">/tmp/log-20200718.tar.gz</span><br></pre></td></tr></table></figure>

<h2 id="备份数据库"><a href="#备份数据库" class="headerlink" title="备份数据库"></a>备份数据库</h2><h3 id="逻辑备份"><a href="#逻辑备份" class="headerlink" title="逻辑备份"></a><font color=seagreen>逻辑备份</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###安装mariadb数据库，重启服务</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># yum -y install mariadb mariadb-server</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># systemctl restart mariadb</span></span><br><span class="line"><span class="comment">####查看数据库服务的进程信息</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># ss -ntulpa | grep mysql</span></span><br><span class="line">tcp LISTEN 0 50 *:3306 *:*</span><br><span class="line">users:((<span class="string">&quot;mysqld&quot;</span>,pid=9561,fd=14)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##mysqldump可以对数据库中的库进行备份</span></span><br><span class="line"><span class="comment">##格式： mysqldump -u&quot;用户名&quot; --password=&quot;&quot; 数据库名 &gt; 备份名.sql</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># mysqldump mysql &gt; mysql.sql</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day06/mysqldump.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">###date 指定备份数据名；iuser 指定登录数据库的用户</span></span><br><span class="line"><span class="comment">###ipass 指定登录密码，默认为空；db 指定要备份的数据库</span></span><br><span class="line">date=$(date +<span class="string">&quot;%Y%m%d&quot;</span>)</span><br><span class="line">iuser=root</span><br><span class="line">ipass=</span><br><span class="line">db=mysql</span><br><span class="line"><span class="comment">###文件在/tmp 下不存在时才会进行备份</span></span><br><span class="line"><span class="keyword">if</span> [ ! -f /tmp/<span class="variable">$db</span>-<span class="variable">$date</span>.sql ];<span class="keyword">then</span></span><br><span class="line">mysqldump -u<span class="variable">$iuser</span> --password=<span class="string">&quot;<span class="variable">$ipass</span>&quot;</span> <span class="variable">$db</span> &gt; /tmp/<span class="variable">$db</span>-<span class="variable">$date</span>.sql</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###运行脚本</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day06/mysqldump.sh</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># ls -l /tmp/mysql-*</span></span><br><span class="line">-rw-r--r-- 1 root root 514619 7月 18 12:54 /tmp/mysql-20200718.sql</span><br></pre></td></tr></table></figure>

<h3 id="物理备份-buttaidong"><a href="#物理备份-buttaidong" class="headerlink" title="物理备份(buttaidong)"></a><font color=amber>物理备份(buttaidong)</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day06/bak_mysql.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">###对数据库中的mysql库下每一个表都进行打包备份；备份文件存放在/tmp/mysql目录下</span></span><br><span class="line">date=$(date +<span class="string">&quot;%Y%m%d&quot;</span>)</span><br><span class="line">db_dir=<span class="string">&quot;/var/lib/mysql&quot;</span></span><br><span class="line">db=mysql</span><br><span class="line">[ ! -d /tmp/<span class="variable">$db</span> ] &amp;&amp; mkdir /tmp/<span class="variable">$db</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(ls <span class="variable">$db_dir</span>/<span class="variable">$db</span>)</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">tar -zcf /tmp/<span class="variable">$db</span>/<span class="variable">$i</span>-<span class="variable">$date</span>.tar.gz <span class="variable">$db_dir</span>/<span class="variable">$db</span>/<span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">###运行脚本</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day06/bak_mysql.sh</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># ls /tmp/mysql</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases</span><br><span class="line">    -&gt; ;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; create databases liruilong;</span><br><span class="line">ERROR 1064 (42000): You have an error <span class="keyword">in</span> your SQL syntax; check the manual that corresponds to your MySQL server version <span class="keyword">for</span> the right syntax to use near <span class="string">&#x27;databases liruilong&#x27;</span> at line 1</span><br><span class="line">mysql&gt; create database liruilong;</span><br><span class="line">Query OK, 1 row affected (0.02 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; use liruilong;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; create table demo(id int(2),name varchar(20));</span><br><span class="line">Query OK, 0 rows affected (0.04 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="差异备份"><a href="#差异备份" class="headerlink" title="差异备份"></a><font color=purple>差异备份</font></h3><p>嗯，这个有些复杂。。。</p>
<h4 id="部署安装rsync同步软件、inotifywait-监听软件"><a href="#部署安装rsync同步软件、inotifywait-监听软件" class="headerlink" title="部署安装rsync同步软件、inotifywait 监听软件"></a><font color=plum>部署安装rsync同步软件、inotifywait 监听软件</font></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[/var/www/html]</span><br><span class="line">└─$ yum -y install rsync</span><br><span class="line">┌──[root@liruilongs.github.io]-[/mysql]</span><br><span class="line">└─$ yum search inotify-tools</span><br><span class="line">已加载插件：fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">============================================== N/S matched: inotify-tools ===============================================</span><br><span class="line">inotify-tools.x86_64 : Command line utilities <span class="keyword">for</span> inotify</span><br><span class="line">inotify-tools-devel.x86_64 : Headers and libraries <span class="keyword">for</span> building apps that use libinotifytools</span><br><span class="line"></span><br><span class="line">  名称和简介匹配 only，使用“search all”试试。</span><br><span class="line">┌──[root@liruilongs.github.io]-[/mysql]</span><br><span class="line">└─$ yum -y install inotify-tools</span><br><span class="line">┌──[root@liruilongs.github.io]-[/mysql]</span><br><span class="line">└─$  rpm -qal  inotify-tools</span><br><span class="line">/usr/bin/inotifywait</span><br><span class="line">/usr/bin/inotifywatch</span><br><span class="line">/usr/lib64/libinotifytools.so.0</span><br><span class="line">/usr/lib64/libinotifytools.so.0.4.1</span><br><span class="line">/usr/share/doc/inotify-tools-3.14</span><br><span class="line">/usr/share/doc/inotify-tools-3.14/AUTHORS</span><br><span class="line">/usr/share/doc/inotify-tools-3.14/COPYING</span><br><span class="line">/usr/share/doc/inotify-tools-3.14/ChangeLog</span><br><span class="line">/usr/share/doc/inotify-tools-3.14/NEWS</span><br><span class="line">/usr/share/doc/inotify-tools-3.14/README</span><br><span class="line">/usr/share/man/man1/inotifywait.1.gz</span><br><span class="line">/usr/share/man/man1/inotifywatch.1.gz</span><br></pre></td></tr></table></figure>



<h3 id="差异备份【inotify-rsync】"><a href="#差异备份【inotify-rsync】" class="headerlink" title="差异备份【inotify+rsync】"></a>差异备份【inotify+rsync】</h3><p><strong><font color=tomato>所谓差异备份，即通过inotify 来监听文件变化，通rsync来增量同步数据。</font></strong><br><strong><font color=blue>这里我们本机模拟一下，一般是备份到远程机器上的，备份前一定做ssh免密 <code>ssh-copy-id root@192.168.26.55</code></font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$ mkdir rsync;<span class="built_in">cd</span> rsync</span><br><span class="line">┌──[root@liruilongs.github.io]-[~/rsync]</span><br><span class="line">└─$ vim isync.sh</span><br><span class="line">┌──[root@liruilongs.github.io]-[~/rsync]</span><br><span class="line">└─$ mkdir /root/liruilong</span><br><span class="line">┌──[root@liruilongs.github.io]-[~/rsync]</span><br><span class="line">└─$ sh isync.sh &amp;</span><br><span class="line">[1] 17575</span><br><span class="line">┌──[root@liruilongs.github.io]-[~/rsync]</span><br><span class="line">└─$ <span class="built_in">cd</span> /root/liruilong/</span><br><span class="line">┌──[root@liruilongs.github.io]-[~/liruilong]</span><br><span class="line">└─$ ls</span><br><span class="line">┌──[root@liruilongs.github.io]-[~/liruilong]</span><br><span class="line">└─$ <span class="built_in">cd</span> /var/www/html/</span><br><span class="line">┌──[root@liruilongs.github.io]-[/var/www/html]</span><br><span class="line">└─$ <span class="built_in">echo</span> <span class="string">&quot;123456&quot;</span> &gt; liruilong.txt</span><br><span class="line">┌──[root@liruilongs.github.io]-[/var/www/html]</span><br><span class="line">└─$ cat liruilong.txt</span><br><span class="line">123456</span><br><span class="line">┌──[root@liruilongs.github.io]-[/var/www/html]</span><br><span class="line">└─$ <span class="built_in">cd</span> /root/liruilong/</span><br><span class="line">┌──[root@liruilongs.github.io]-[~/liruilong]</span><br><span class="line">└─$ ls</span><br><span class="line">liruilong.txt</span><br><span class="line">┌──[root@liruilongs.github.io]-[~/liruilong]</span><br><span class="line">└─$ cat liruilong.txt</span><br><span class="line">123456</span><br><span class="line">┌──[root@liruilongs.github.io]-[~/liruilong]</span><br><span class="line">└─$ <span class="built_in">jobs</span></span><br><span class="line">[1]+  运行中               sh isync.sh &amp;(工作目录：~/rsync)</span><br><span class="line">┌──[root@liruilongs.github.io]-[~/liruilong]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>
<p><strong><font color=chocolate>备份脚本</font></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~/rsync]</span><br><span class="line">└─$ ls</span><br><span class="line">isync.sh</span><br><span class="line">┌──[root@liruilongs.github.io]-[~/rsync]</span><br><span class="line">└─$ cat isync.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">##from_dir 为要被同步的目录</span></span><br><span class="line">from_dir=<span class="string">&quot;/var/www/html/&quot;</span></span><br><span class="line"><span class="comment">##将$from_dir下的内容，同步到本机的/root/liruilong/目录下</span></span><br><span class="line">rsync_cmd=<span class="string">&quot;rsync -az --delete <span class="variable">$from_dir</span> root@192.168.26.55:/root/liruilong&quot;</span></span><br><span class="line"><span class="comment">##inotifywait监听 $from_dir 目录，目录下发生文件的变化时，执行同步操作，脚本后台运行</span></span><br><span class="line"><span class="keyword">while</span> inotifywait -rqq -e modify,move,create,delete,attrib <span class="variable">$from_dir</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="variable">$rsync_cmd</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">┌──[root@liruilongs.github.io]-[~/rsync]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<h1 id="安全脚本"><a href="#安全脚本" class="headerlink" title="安全脚本"></a>安全脚本</h1><h2 id="HASH值"><a href="#HASH值" class="headerlink" title="HASH值"></a>HASH值</h2><h3 id="HASH值-1"><a href="#HASH值-1" class="headerlink" title="HASH值"></a>HASH值</h3><ul>
<li>HASH 值与文件名称、时间、大小等信息无关，仅与内容有关</li>
<li>MD5</li>
<li>SHA256</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">######文件的内容只要不发生变化，HASH值就是唯一的</span></span><br><span class="line"><span class="comment">##计算文件的hash值</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># md5sum /etc/passwd</span></span><br><span class="line">6218010e73619a856999d39590a533f8 /etc/passwd</span><br><span class="line"><span class="comment">##只要文件内容不变，hash值一样</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># cp /etc/passwd /root/pass</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># md5sum /root/pass</span></span><br><span class="line">6218010e73619a856999d39590a533f8 /root/pass</span><br><span class="line"><span class="comment">##删除了文件第5行，内容发生变化，hash值改变</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -i &#x27;5d&#x27; /root/pass</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># md5sum /root/pass</span></span><br><span class="line">449a721dd0449390377ae5216922faa7 /root/pass</span><br><span class="line"><span class="comment">###sha256sum和sha512sum都是计算hash值的，区别是长度不同</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sha256sum /etc/passwd</span></span><br><span class="line">db5560c8d21a9a4558272a2781ed1636eb40e7ebd709d5bca6751eb09db43383 /etc/passwd</span><br><span class="line">[root@liruilong ~]<span class="comment"># sha512sum /etc/passwd</span></span><br><span class="line">c42b1c3531cd9d45c669845906f033c19cb40d626febdccd1e4834f1feb40730e4d52e0317dfd3f5</span><br><span class="line">7f7406a23c10901be8d65787398beeae4513d71838f34803 /etc/passwd</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="数据安全检测脚本"><a href="#数据安全检测脚本" class="headerlink" title="数据安全检测脚本"></a>数据安全检测脚本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day06/data.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">###为/etc/下所有以 .conf 结尾的文件生成hash值，保存到/tmp/data.log文件中</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(ls /etc/*.conf)</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">md5sum <span class="variable">$i</span> &gt;&gt; /tmp/data.log</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##运行脚本，查看结果</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day06/data.sh</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># cat /tmp/data.log</span></span><br></pre></td></tr></table></figure>
<h2 id="SSH配置"><a href="#SSH配置" class="headerlink" title="SSH配置"></a>SSH配置</h2><h3 id="sshd配置"><a href="#sshd配置" class="headerlink" title="sshd配置"></a>sshd配置</h3><p>sshd主配置文件：<br><img src="https://img-blog.csdnimg.cn/7ac6f3d31fe04999aad3da60f0785d80.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<ul>
<li>Port 3389 &#x2F;&#x2F; 改用非标准端口</li>
<li>PermitRootLogin no  &#x2F;&#x2F; 禁止root登录</li>
<li>UseDNS no     &#x2F;&#x2F;不解析客户机地址  </li>
<li>AllowUsers 账户名 &#x2F;&#x2F;设置远程连接的白名单,多个用户空格分割</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###拷贝远程服务 sshd 的主配置文件</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># cp /etc/ssh/sshd_config /opt/</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># ls -l /opt/sshd_config</span></span><br><span class="line">-rw------- 1 root root 3907 7月 20 10:00 /opt/sshd_config</span><br><span class="line"><span class="comment">###过滤包含 port 的行</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># grep -i &quot;port&quot; /opt/sshd_config</span></span><br><span class="line"><span class="comment">###使用sed删除对应行的注释</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;/^#Port/s/#//p&#x27; /opt/sshd_config</span></span><br><span class="line">Port 22</span><br><span class="line"><span class="comment">###过滤包含 permitrootlogin 的行</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># grep -i &#x27;permitrootlogin&#x27; /opt/sshd_config</span></span><br><span class="line"><span class="comment">###使用sed删除对应行的注释</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;/^#PermitRootLogin/s/#//p&#x27; /opt/sshd_config</span></span><br><span class="line">PermitRootLogin yes</span><br><span class="line"><span class="comment">###过滤包含 usedns 的行</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># grep -i &quot;usedns&quot; /opt/sshd_config</span></span><br><span class="line"><span class="comment">###使用sed删除对应行的注释</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;/^#UseDNS/s/#//p&#x27; /opt/sshd_config</span></span><br><span class="line">UseDNS yes</span><br><span class="line"><span class="comment">###上述操作只是打印出来，-i 直接修改配置文件</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -i &#x27;/^#Port/s/#//&#x27; /opt/sshd_config</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -i &#x27;/^#PermitRootLogin/s/#//&#x27; /opt/sshd_config</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -i &#x27;/^#UseDNS/s/#//&#x27; /opt/sshd_config</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day06/ssh_conf.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">####安全的远程配置脚本</span></span><br><span class="line">conf=<span class="string">&quot;/opt/sshd_config&quot;</span></span><br><span class="line">sed -i <span class="string">&#x27;/^Port/s/22/1122/&#x27;</span> <span class="variable">$conf</span></span><br><span class="line">sed -i <span class="string">&#x27;/^PermitRootLogin/s/yes/no/&#x27;</span> <span class="variable">$conf</span></span><br><span class="line">sed -i <span class="string">&#x27;/^UseDNS/s/yes/no/&#x27;</span> <span class="variable">$conf</span></span><br><span class="line">sed -i <span class="string">&#x27;$a AllowUsers tom&#x27;</span> <span class="variable">$conf</span></span><br><span class="line">systemctl restart sshd</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###运行脚本</span></span><br><span class="line">[root@liruilong opt]<span class="comment"># sh /root/shell/day06/ssh_conf.sh</span></span><br><span class="line"><span class="comment">###查看结果</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;/^Port/p&#x27; /opt/sshd_config</span></span><br><span class="line">Port 1122</span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;/^PermitRootLogin/p&#x27; /opt/sshd_config</span></span><br><span class="line">PermitRootLogin no</span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;/^UseDNS/p&#x27; /opt/sshd_config</span></span><br><span class="line">UseDNS no</span><br><span class="line">[root@liruilong ~]<span class="comment"># sed -n &#x27;$p&#x27; /opt/sshd_config</span></span><br><span class="line">AllowUsers tom</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="、格式化输出passwd"><a href="#、格式化输出passwd" class="headerlink" title="、格式化输出passwd"></a>、格式化输出passwd</h1><h2 id="格式输出"><a href="#格式输出" class="headerlink" title="格式输出"></a>格式输出</h2><h3 id="格式化输出各式化输出-x2F-etc-x2F-passwd-效果如下"><a href="#格式化输出各式化输出-x2F-etc-x2F-passwd-效果如下" class="headerlink" title="格式化输出各式化输出&#x2F;etc&#x2F;passwd,效果如下 :"></a>格式化输出各式化输出&#x2F;etc&#x2F;passwd,效果如下 :</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###打印 用户名，UID和家目录</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># awk -F: &#x27;BEGIN&#123;print &quot;用户名 UID 家目录&quot;&#125; &#123;print $1,$3,$6&#125;&#x27;  /etc/passwd</span></span><br><span class="line">用户名 UID 家目录</span><br><span class="line">root 0 /root</span><br><span class="line">bin 1 /bin</span><br><span class="line">daemon 2 /sbin</span><br><span class="line">......</span><br><span class="line"><span class="comment">###column -t 作用是对打印的内容进行排版</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># awk -F: &#x27;BEGIN&#123;print &quot;用户名 UID 家目录&quot;&#125; &#123;print $1,$3,$6&#125;&#x27;</span></span><br><span class="line">/etc/passwd | column -t</span><br><span class="line">用户名 UID 家目录</span><br><span class="line">root 0 /root</span><br><span class="line">bin 1 /bin</span><br><span class="line">daemon 2 /sbin</span><br></pre></td></tr></table></figure>

<h3 id="过滤系统账户对应的密码"><a href="#过滤系统账户对应的密码" class="headerlink" title="过滤系统账户对应的密码"></a>过滤系统账户对应的密码</h3><ul>
<li>在 awk中可以通过 -v 选项调用 shell 中的变量<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###定义变量 hello</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># hello=&quot;nihao&quot;</span></span><br><span class="line"><span class="comment">### -v 选项，可以引用shell中的变量，将变量hello的值赋予tmp</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># awk -v tmp=$hello &#x27;BEGIN&#123;print tmp&#125;&#x27;</span></span><br><span class="line">nihao</span><br></pre></td></tr></table></figure></li>
<li>从 &#x2F;etc&#x2F;passwd 中将所有能登陆的账户名提取出来</li>
<li>从 &#x2F;etc&#x2F;shadow 中提取账户对应的密码</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day06/userpass.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">###过滤出以bash结尾的用户，赋予变量USER</span></span><br><span class="line">USER=$(awk -F: <span class="string">&#x27;/bash$/&#123;print $1&#125;&#x27;</span> /etc/passwd)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$USER</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">awk -F: -v iuser=<span class="variable">$i</span> <span class="string">&#x27;$1==iuser&#123;print $1,$2&#125;&#x27;</span> /etc/shadow</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">##注意单独使用时，$1==&quot;root&quot;，要加双引号，代表字符串</span></span><br><span class="line"><span class="comment">## awk -F: &#x27;$1==&quot;root&quot;&#123;print $1,$2&#125;&#x27; /etc/shadow</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/64b41618d0f14d95aa7f84431f99957e.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###运行脚本</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day06/userpass.sh</span></span><br><span class="line">root</span><br><span class="line">$6$pAL3P7fovbgv4LEv<span class="variable">$zwO6BZTMSfyfFcIZHO8S</span>.TQc8RDuBtj4dj3wJ5CdH0clUue3G15.0C0PpytA</span><br><span class="line">wh9Lo.Dcxl1q0j6.z09yOGH32/</span><br><span class="line">zhangzhao</span><br><span class="line">$6<span class="variable">$mcBYSo</span>/SxmOFm8l.<span class="variable">$NxqB4us2UerMMPRPHn4u2v4BdFqkPBza</span>/5NA1IV/Z3.knseF7sNS8.171OPx</span><br><span class="line">KULoW7KBYY6qyM0VNxF2r6I.h0</span><br></pre></td></tr></table></figure>

<h1 id="、综合案例"><a href="#、综合案例" class="headerlink" title="、综合案例"></a>、综合案例</h1><h2 id="一键PXE-kickstart"><a href="#一键PXE-kickstart" class="headerlink" title="一键PXE+kickstart"></a>一键PXE+kickstart</h2><h3 id="PXE"><a href="#PXE" class="headerlink" title="PXE:"></a>PXE:</h3><ul>
<li>PXE，全名Pre-boot Execution Environment，预启动执行环境；</li>
<li>通过网络接口启动计算机，不依赖本地存储设备(如硬盘)或本地已安装的操作系统；由Intel和Systemsoft公司于1999年9月20日公布的技术；</li>
<li>lient&#x2F;Server的工作模式；PXE客户端会调用网际协议(IP)、用户数据报协议(UDP)、动态主机设定协议(DHCP)、小型文件传输协议(TFTP)等网络协议；</li>
<li>PXE客户端(client)这个术语是指机器在PXE启动过程中的角色。一个PXE客户端可以是一台服务器、笔记本电脑或者其他装有PXE启动代码的机器(我们电脑的网卡)。</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/bc9f271adaf9411db683a40479e8f35b.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Nhbmhld3V5YW5n,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="1、启动步骤详解"><a href="#1、启动步骤详解" class="headerlink" title="1、启动步骤详解"></a>1、启动步骤详解</h3><p>1、服务器加电启动，从DHCP服务器获取IP地址并加载(PXEClient)。<br>2、通过TFTP服务器获取网络引导程序(pxelinux.0)。<br>3、引导程序读取配置文件(pxelinux.cfg本例中文件名为：default)。<br>4、引导程序加载文件系统初始化(initrd)程序和内核初始镜像(vmlinuz)、自动应答程序(ks.cfg)。<br>5、按自动应答文件中指定的网络安装方式，以FTP方式安装linux系统。</p>
<h3 id="一键PXE-kickstart-1"><a href="#一键PXE-kickstart-1" class="headerlink" title="一键PXE+kickstart"></a>一键PXE+kickstart</h3><ul>
<li>部署 PXE+kickstart 环境<ul>
<li>dhcp 服务</li>
<li>tftp 服务</li>
<li>http 服务</li>
<li>kickstart 配置</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###输出多行文本</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># cat &lt;&lt; EOF</span></span><br><span class="line">&gt; hello world</span><br><span class="line">&gt; i am come here</span><br><span class="line">&gt; i love the world</span><br><span class="line">&gt; EOF</span><br><span class="line">hello world</span><br><span class="line">i am come here</span><br><span class="line">i love the world</span><br><span class="line"><span class="comment">###将多行文本保存到文件/opt/password中</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># cat &gt; /opt/password &lt;&lt; EOF</span></span><br><span class="line">&gt; hello world</span><br><span class="line">&gt; i am come here</span><br><span class="line">&gt; i love the world</span><br><span class="line">&gt; EOF</span><br><span class="line"><span class="comment">###查看文件内容跟</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># cat /opt/password</span></span><br><span class="line">hello world</span><br><span class="line">i am come here</span><br><span class="line">i love the world</span><br><span class="line">[root@liruilong ~]<span class="comment"># vim /root/shell/day06/pxe.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">##定义变量，让方便后面的调用，和提高适用性</span></span><br><span class="line">DHCP_NET=192.168.4.0</span><br><span class="line">DHCP_NETMASK=255.255.255.0</span><br><span class="line">DHCP_MINIP=192.168.4.100</span><br><span class="line">DHCP_MAXIP=192.168.4.200</span><br><span class="line">DHCP_ROUTER=192.168.4.254</span><br><span class="line">DHCP_NEXT_SERVER=192.168.4.5</span><br><span class="line">HTTP_IP=192.168.4.5</span><br><span class="line"><span class="comment">##安装软件包</span></span><br><span class="line">yum -y install httpd dhcp tftp-server syslinux</span><br><span class="line"><span class="comment">##临时停用SELinux</span></span><br><span class="line">setenforce 0</span><br><span class="line"><span class="comment">##配置 DHCP 服务</span></span><br><span class="line">cat &gt; /etc/dhcp/dhcpd.conf &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">subnet $DHCP_NET netmask $DHCP_NETMASK &#123;</span></span><br><span class="line"><span class="string">range $DHCP_MINIP $DHCP_MAXIP;</span></span><br><span class="line"><span class="string">option routers $DHCP_ROUTER;</span></span><br><span class="line"><span class="string">default-lease-time 600;</span></span><br><span class="line"><span class="string">max-lease-time 7200;</span></span><br><span class="line"><span class="string">next-server $DHCP_NEXT_SERVER;</span></span><br><span class="line"><span class="string">filename &quot;pxelinux.0&quot;;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">systemctl restart dhcpd</span><br><span class="line">systemctl <span class="built_in">enable</span> dhcpd</span><br><span class="line"><span class="comment">##配置httpd共享服务器</span></span><br><span class="line"><span class="keyword">if</span> [ ! -e /dev/cdrom ];<span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;未检测到系统光盘/dev/cdrom，请插入光盘后再试&quot;</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">[ -d /var/www/html/cdrom ] || mkdir /var/www/html/cdrom</span><br><span class="line">mount /dev/cdrom /var/www/html/cdrom</span><br><span class="line">systemctl start httpd</span><br><span class="line"><span class="comment">##配置kickstart 文件</span></span><br><span class="line">cat &gt; /var/www/html/ks.cfg &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">install</span></span><br><span class="line"><span class="string">keyboard &#x27;us&#x27;</span></span><br><span class="line"><span class="string">rootpw --plaintext redhat</span></span><br><span class="line"><span class="string">url --url=&quot;http://$HTTP_IP/cdrom&quot;</span></span><br><span class="line"><span class="string">lang en_US</span></span><br><span class="line"><span class="string">firewall --disabled</span></span><br><span class="line"><span class="string">auth --useshadow --passalgo=sha512</span></span><br><span class="line"><span class="string">text</span></span><br><span class="line"><span class="string">selinux --disabled</span></span><br><span class="line"><span class="string">network --bootproto=dhcp --device=eth0</span></span><br><span class="line"><span class="string">reboot</span></span><br><span class="line"><span class="string">timezone Asia/Shanghai</span></span><br><span class="line"><span class="string">bootloader --location=mbr</span></span><br><span class="line"><span class="string">zerombr</span></span><br><span class="line"><span class="string">clearpart --all --initlabel</span></span><br><span class="line"><span class="string">part /boot --fstype=&quot;xfs&quot; --size=500</span></span><br><span class="line"><span class="string">part / --fstype=&quot;xfs&quot; --grow --size=1</span></span><br><span class="line"><span class="string">%packages</span></span><br><span class="line"><span class="string">@base</span></span><br><span class="line"><span class="string">%end</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="comment">####配置tftp服务</span></span><br><span class="line">cp /usr/share/syslinux/pxelinux.0 /var/lib/tftpboot/</span><br><span class="line">cp /var/www/html/cdrom/isolinux/* /var/lib/tftpboot/</span><br><span class="line">[ -d /var/lib/tftpboot/pxelinux.cfg ] || mkdir /var/lib/tftpboot/pxelinux.cfg</span><br><span class="line"><span class="comment">##部署菜单文件</span></span><br><span class="line">cat &gt; /var/lib/tftpboot/pxelinux.cfg/default &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">default vesamenu.c32</span></span><br><span class="line"><span class="string">timeout 100</span></span><br><span class="line"><span class="string">label linux</span></span><br><span class="line"><span class="string">menu label ^Install CentOS 7</span></span><br><span class="line"><span class="string">kernel vmlinuz</span></span><br><span class="line"><span class="string">append initrd=initrd.img ks=http://$HTTP_IP/ks.cfg</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">systemctl start tftp</span><br><span class="line"><span class="comment">##临时清空防火墙规则</span></span><br><span class="line">iptables -F</span><br><span class="line"><span class="comment">###执行脚本</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># sh /root/shell/day06/pxe.sh</span></span><br><span class="line"><span class="comment">###检查三个服务【dhcpd,httpd,tftp】是否已经运行</span></span><br><span class="line">[root@liruilong ~]<span class="comment"># systemctl status dhcpd | grep Active</span></span><br><span class="line">Active: active (running) since 一 2020-07-20 12:06:31 CST; 16min ago</span><br><span class="line">[root@liruilong ~]<span class="comment"># systemctl status tftp | grep Active</span></span><br><span class="line">Active: active (running) since 一 2020-07-20 12:05:35 CST; 17min ago</span><br><span class="line">[root@liruilong ~]<span class="comment"># systemctl status httpd | grep Active</span></span><br><span class="line">Active: active (running) since 一 2020-07-20 12:05:34 CST; 17min ago</span><br></pre></td></tr></table></figure></div><div class="article-licensing box"><div class="licensing-title"><p>关于 linux中 shell等知识的一些笔记</p><p><a href="https://liruilongs.github.io/2021/07/30/Linux/关于 Linux中 shell等知识的一些笔记/">https://liruilongs.github.io/2021/07/30/Linux/关于 Linux中 shell等知识的一些笔记/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="https://liruilongs.github.io"><p>山河已无恙</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-07-30</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2023-06-21</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/2021/08/18/Java/%E5%85%B3%E4%BA%8E%E9%A1%B9%E7%9B%AE%E4%B8%AD%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86/" target="_blank">关于项目中启动脚本编写的一些笔记整理</a><br></span></div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 推荐文章</span><br><span>  1.<a class="is-size-6" href="/2021/08/27/K8s/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AKubernetes%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97-%E4%BB%8EDocker%E5%88%B0Kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A8%E6%8E%A5%E8%A7%A6%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" target="_blank">《Kubernetes权威指南:从Docker到Kubernetes实践全接触》读书笔记</a><br></span><span>  2.<a class="is-size-6" href="/2022/11/19/Git/%E5%85%B3%E4%BA%8E-Git-%E9%87%8D%E5%86%99%E5%8E%86%E5%8F%B2%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于 Git 重写历史的一些笔记</a><br></span><span>  3.<a class="is-size-6" href="/2023/02/19/Git/%E5%85%B3%E4%BA%8EGit%E9%AB%98%E7%BA%A7%E5%90%88%E5%B9%B6%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86/" target="_blank">关于Git分支高级合并的一些笔记整理</a><br></span><span>  4.<a class="is-size-6" href="/2022/03/11/Go/GO%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98%E4%B9%8B%E5%87%BD%E6%95%B0%E4%B8%8E%E6%96%B9%E6%B3%95/" target="_blank">GO语言实战之函数与方法</a><br></span><span>  5.<a class="is-size-6" href="/2022/04/14/Go/GO%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98%E4%B9%8B%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%9C%AC%E8%B4%A8/" target="_blank">Go语言实战之类型的本质</a><br></span><span>  6.<a class="is-size-6" href="/2022/08/02/Git/%E5%85%B3%E4%BA%8EGit%E5%88%86%E6%94%AF%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于Git分支工作流的一些笔记</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/alipay%EF%BF%A5.png" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/wechat%EF%BF%A5.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/07/30/Linux/%E5%85%B3%E4%BA%8E%20Linux%20%E4%B8%AD%E5%AE%89%E5%85%A8%E6%96%B9%E9%9D%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">关于 Linux 中安全方面的一些笔记</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/07/27/docker/Docker%E3%80%81Podman%20%E5%AE%B9%E5%99%A8%E2%80%9C%E6%89%AB%E7%9B%B2%E2%80%9C%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="level-item">Docker、Podman 容器“扫盲“ 学习笔记</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><div class="card"><div class="card-content"><div class="title is-5">评论</div><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            language:'zh-CN',
            id: '53df322dbbeca86c07798866c46fa4d9',
            repo: 'blog_comment',
            owner: 'LIRUILONGS',
            clientID: '9fdc9739266d48d5f62e',
            clientSecret: 'c1cc33697d099a2197650ec9dadcb16bd4904655',
            admin: ["LIRUILONGS"],
            createIssueManually: true,
            distractionFreeMode: true,
            perPage: 10,
            pagerDirection: 'last',
            proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token',
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><ul class="menu-list"><li><a class="is-flex is-mobile" href="#写在前面"><span class="mr-2">1.1</span><span>写在前面</span></a></li></ul><li><a class="is-flex is-mobile" href="#一、Shell-基础知识"><span class="mr-2">2</span><span>一、Shell 基础知识</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#1-1-什么是-Shell"><span class="mr-2">2.1</span><span>1.1 什么是 Shell</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#Bash基本特性"><span class="mr-2">2.1.1</span><span>Bash基本特性</span></a></li><li><a class="is-flex is-mobile" href="#管道"><span class="mr-2">2.1.2</span><span>管道 ( | )</span></a></li><li><a class="is-flex is-mobile" href="#Shell-执行命令的方式"><span class="mr-2">2.1.3</span><span>Shell 执行命令的方式</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#二、脚本设计与运行"><span class="mr-2">3</span><span>二、脚本设计与运行</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#2-1-编写Shell-脚本"><span class="mr-2">3.1</span><span>2.1 编写Shell 脚本</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#规范脚本的构成"><span class="mr-2">3.1.1</span><span>规范脚本的构成</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#2-2-执行-Shell-脚本"><span class="mr-2">3.2</span><span>2.2 执行 Shell 脚本</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#三、变量"><span class="mr-2">4</span><span>三、变量</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#3-1-自定义变量"><span class="mr-2">4.1</span><span>3.1 自定义变量</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#查看变量"><span class="mr-2">4.1.1</span><span>查看变量</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#3-2系统预设变量"><span class="mr-2">4.2</span><span>3.2系统预设变量</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#预定义变量"><span class="mr-2">4.2.1</span><span>预定义变量</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#四、变量的扩展应用"><span class="mr-2">5</span><span>四、变量的扩展应用</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#4-1-各种引号"><span class="mr-2">5.1</span><span>4.1 各种引号</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#多种引号的区别"><span class="mr-2">5.1.1</span><span>多种引号的区别</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#4-2-read-命令定义变量"><span class="mr-2">5.2</span><span>4.2 read 命令定义变量</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#read-标准输入取值"><span class="mr-2">5.2.1</span><span>read 标准输入取值</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#4-3-全局变量-or-局部变量"><span class="mr-2">5.3</span><span>4.3 全局变量 or 局部变量</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#变量的作用范围"><span class="mr-2">5.3.1</span><span>变量的作用范围</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#五、Shell-中的运算"><span class="mr-2">6</span><span>五、Shell 中的运算</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#5-1-整数运算"><span class="mr-2">6.1</span><span>5.1 整数运算</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#let-指定算术运算"><span class="mr-2">6.1.1</span><span>let 指定算术运算</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#5-2-小数运算"><span class="mr-2">6.2</span><span>5.2 小数运算</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#小数的比较"><span class="mr-2">6.2.1</span><span>小数的比较</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#六、综合案例"><span class="mr-2">7</span><span>六、综合案例</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#6-1-监控脚本之显示硬件信息"><span class="mr-2">7.1</span><span>6.1 监控脚本之显示硬件信息</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#配置-YUM-源脚本"><span class="mr-2">7.1.1</span><span>配置 YUM 源脚本</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#七、字符串处理与变量初始化"><span class="mr-2">8</span><span>七、字符串处理与变量初始化</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#字符串处理机制"><span class="mr-2">8.1</span><span>字符串处理机制</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#字串去尾"><span class="mr-2">8.1.1</span><span>字串去尾</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#一、使用sed修改配置"><span class="mr-2">9</span><span>一、使用sed修改配置</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#1-1-常用sed指令"><span class="mr-2">9.1</span><span>1.1 常用sed指令</span></a></li><li><a class="is-flex is-mobile" href="#1-2-过滤数据"><span class="mr-2">9.2</span><span>1.2 过滤数据</span></a></li><li><a class="is-flex is-mobile" href="#1-3-删除数据"><span class="mr-2">9.3</span><span>1.3 删除数据</span></a></li><li><a class="is-flex is-mobile" href="#1-4-替换行"><span class="mr-2">9.4</span><span>1.4 替换行</span></a></li><li><a class="is-flex is-mobile" href="#1-5-替换关键词"><span class="mr-2">9.5</span><span>1.5 替换关键词</span></a></li><li><a class="is-flex is-mobile" href="#1-8-打印行号"><span class="mr-2">9.6</span><span>1.8 打印行号</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#二、sed-多行文本处理"><span class="mr-2">10</span><span>二、sed 多行文本处理</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#2-1-文本块指令"><span class="mr-2">10.1</span><span>2.1 文本块指令</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#插入指令-Insert-插入，行前写入"><span class="mr-2">10.1.1</span><span>插入指令 Insert (插入，行前写入)</span></a></li><li><a class="is-flex is-mobile" href="#Append-追加，行后写入"><span class="mr-2">10.1.2</span><span>Append(追加，行后写入)</span></a></li><li><a class="is-flex is-mobile" href="#导入指令-Read-将其他文件的内容导入"><span class="mr-2">10.1.3</span><span>导入指令:Read (将其他文件的内容导入)</span></a></li><li><a class="is-flex is-mobile" href="#导出指令-Write-将文件内容导出另存到其他文件"><span class="mr-2">10.1.4</span><span>导出指令:Write (将文件内容导出另存到其他文件)</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#三、sed综合案例"><span class="mr-2">11</span><span>三、sed综合案例</span></a></li><li><a class="is-flex is-mobile" href="#一、awk基础语法"><span class="mr-2">12</span><span>一、awk基础语法</span></a></li><li><a class="is-flex is-mobile" href="#awk-流程控制"><span class="mr-2">13</span><span>awk 流程控制</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#if语句"><span class="mr-2">13.1</span><span>if语句</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#单分支if判断"><span class="mr-2">13.1.1</span><span>单分支if判断</span></a></li><li><a class="is-flex is-mobile" href="#双分支if判断"><span class="mr-2">13.1.2</span><span>双分支if判断</span></a></li><li><a class="is-flex is-mobile" href="#多分支if判断"><span class="mr-2">13.1.3</span><span>多分支if判断</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#for循环"><span class="mr-2">13.2</span><span>for循环</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#awk-数组与应用案例"><span class="mr-2">14</span><span>awk 数组与应用案例</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#awk-数组的定义及使用"><span class="mr-2">14.1</span><span>awk 数组的定义及使用</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#给数组name添加两个值，调用数组中的值"><span class="mr-2">14.1.1</span><span>给数组name添加两个值，调用数组中的值</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#应用案例"><span class="mr-2">14.2</span><span>应用案例</span></a></li><li><a class="is-flex is-mobile" href="#awk-综合案例"><span class="mr-2">14.3</span><span>awk 综合案例</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#ss命令"><span class="mr-2">14.3.1</span><span>ss命令</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#循环嵌套"><span class="mr-2">15</span><span>循环嵌套</span></a></li><li><a class="is-flex is-mobile" href="#循环嵌套-1"><span class="mr-2">16</span><span>循环嵌套</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#排列与组合"><span class="mr-2">16.1</span><span>排列与组合</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#打印形状"><span class="mr-2">16.1.1</span><span>打印形状</span></a></li><li><a class="is-flex is-mobile" href="#带菜单的脚本"><span class="mr-2">16.1.2</span><span>带菜单的脚本</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#备份数据"><span class="mr-2">17</span><span>备份数据</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#备份日志"><span class="mr-2">17.1</span><span>备份日志</span></a></li><li><a class="is-flex is-mobile" href="#备份数据库"><span class="mr-2">17.2</span><span>备份数据库</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#逻辑备份"><span class="mr-2">17.2.1</span><span>逻辑备份</span></a></li><li><a class="is-flex is-mobile" href="#物理备份-buttaidong"><span class="mr-2">17.2.2</span><span>物理备份(buttaidong)</span></a></li><li><a class="is-flex is-mobile" href="#部署安装rsync同步软件、inotifywait-监听软件"><span class="mr-2">17.2.3</span><span>部署安装rsync同步软件、inotifywait 监听软件</span></a></li><li><a class="is-flex is-mobile" href="#差异备份【inotify-rsync】"><span class="mr-2">17.2.4</span><span>差异备份【inotify+rsync】</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#安全脚本"><span class="mr-2">18</span><span>安全脚本</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#HASH值"><span class="mr-2">18.1</span><span>HASH值</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#HASH值-1"><span class="mr-2">18.1.1</span><span>HASH值</span></a></li><li><a class="is-flex is-mobile" href="#数据安全检测脚本"><span class="mr-2">18.1.2</span><span>数据安全检测脚本</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#SSH配置"><span class="mr-2">18.2</span><span>SSH配置</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#sshd配置"><span class="mr-2">18.2.1</span><span>sshd配置</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#、格式化输出passwd"><span class="mr-2">19</span><span>、格式化输出passwd</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#格式输出"><span class="mr-2">19.1</span><span>格式输出</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#格式化输出各式化输出-x2F-etc-x2F-passwd-效果如下"><span class="mr-2">19.1.1</span><span>格式化输出各式化输出/etc/passwd,效果如下 :</span></a></li><li><a class="is-flex is-mobile" href="#过滤系统账户对应的密码"><span class="mr-2">19.1.2</span><span>过滤系统账户对应的密码</span></a></li></ul></li></ul></li><li><a class="is-flex is-mobile" href="#、综合案例"><span class="mr-2">20</span><span>、综合案例</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#一键PXE-kickstart"><span class="mr-2">20.1</span><span>一键PXE+kickstart</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#PXE"><span class="mr-2">20.1.1</span><span>PXE:</span></a></li><li><a class="is-flex is-mobile" href="#1、启动步骤详解"><span class="mr-2">20.1.2</span><span>1、启动步骤详解</span></a></li><li><a class="is-flex is-mobile" href="#一键PXE-kickstart-1"><span class="mr-2">20.1.3</span><span>一键PXE+kickstart</span></a></li></ul></li></ul></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class=""><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7.jpg" alt="山河已无恙"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">山河已无恙</p><p class="is-size-6 is-block">爱自己，是终生浪漫的开始</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国·呼和浩特</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">276</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">86</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">137</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://liruilong.blog.csdn.net/?t=1&amp;type=blog" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/LIRUILONGS"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="CSDN" href="https://liruilong.blog.csdn.net/"><i class="fa fa-code"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:1224965096@qq.com"><i class="fa fa-envelope"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://liruilong.blog.csdn.net/?t=1&amp;type=blog" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CSDN</span></span><span class="level-right"><span class="level-item tag">liruilong.blog.csdn.net</span></span></a></li><li><a class="level is-mobile" href="https://www.cnblogs.com/liruilong/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">博客园</span></span><span class="level-right"><span class="level-item tag">www.cnblogs.com</span></span></a></li><li><a class="level is-mobile" href="https://github.com/LIRUILONGS" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Githup</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li><li><a class="level is-mobile" href="https://gitee.com/liruilonger" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">码云</span></span><span class="level-right"><span class="level-item tag">gitee.com</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-07-02T07:04:36.000Z">2023-07-02</time></p><p class="title"><a href="/2023/07/02/%E5%BE%85%E5%8F%91%E5%B8%83/Kubernetes%20%E8%A7%A6%E5%8F%91%20OOMKilled(%E5%86%85%E5%AD%98%E6%9D%80%E6%89%8B)%E5%A6%82%E4%BD%95%E6%8E%92%E9%99%A4%E6%95%85%E9%9A%9C/">Kubernetes 触发 OOMKilled(内存杀手)如何排除故障</a></p><p class="categories"><a href="/categories/Kubernetes/">Kubernetes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-06-25T09:31:04.000Z">2023-06-25</time></p><p class="title"><a href="/2023/06/25/rhca/CL260/Ceph%EF%BC%9A%E5%85%B3%E4%BA%8ECeph%20%E9%9B%86%E7%BE%A4%E4%B8%AD%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83%E5%92%8C%E5%AE%B9%E7%81%BE%E6%95%B4%E7%90%86%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/">Ceph：关于Ceph 集群中数据分布和容灾整理的一些笔记</a></p><p class="categories"><a href="/categories/Ceph/">Ceph</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-06-20T11:34:31.000Z">2023-06-20</time></p><p class="title"><a href="/2023/06/20/%E5%BE%85%E5%8F%91%E5%B8%83/K8s%EF%BC%9AK8s-20%E4%B8%AA%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E6%B1%87%E6%80%BB/">K8s：K8s 20个常用命令汇总</a></p><p class="categories"><a href="/categories/Kubernetes/">Kubernetes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-06-18T18:22:57.000Z">2023-06-18</time></p><p class="title"><a href="/2023/06/18/%E5%BE%85%E5%8F%91%E5%B8%83/K8s%EF%BC%9AK8s%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4%E6%96%B9%E6%B3%95%E8%AE%BA/">K8s：Kubernetes 故障排除方法论</a></p><p class="categories"><a href="/categories/Kubernetes/">Kubernetes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-06-15T13:57:37.000Z">2023-06-15</time></p><p class="title"><a href="/2023/06/15/%E5%BE%85%E5%8F%91%E5%B8%83/Nvidia%203060%20%E6%98%BE%E5%8D%A1%20CUDA%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA(Ubuntu22.04+Nvidia%20510+Cuda11.6+cudnn8.8)/">Nvidia 3060 显卡 CUDA 环境搭建(Ubuntu22.04+Nvidia 510+Cuda11.6+cudnn8.8)</a></p><p class="categories"><a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Ajax/"><span class="level-start"><span class="level-item">Ajax</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ansible/"><span class="level-start"><span class="level-item">Ansible</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/AppCube/"><span class="level-start"><span class="level-item">AppCube</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CI-CD/"><span class="level-start"><span class="level-item">CI/CD</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CSS/"><span class="level-start"><span class="level-item">CSS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ceph/"><span class="level-start"><span class="level-item">Ceph</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/DAD-3DHeads/"><span class="level-start"><span class="level-item">DAD-3DHeads</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/DNS/"><span class="level-start"><span class="level-item">DNS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/DeepFace/"><span class="level-start"><span class="level-item">DeepFace</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/DevOps/"><span class="level-start"><span class="level-item">DevOps</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2023/07/"><span class="level-start"><span class="level-item">七月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/06/"><span class="level-start"><span class="level-item">六月 2023</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/05/"><span class="level-start"><span class="level-item">五月 2023</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/04/"><span class="level-start"><span class="level-item">四月 2023</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/03/"><span class="level-start"><span class="level-item">三月 2023</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Kubernetes/"><span class="tag">Kubernetes</span><span class="tag is-grey-lightest">86</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag is-grey-lightest">29</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ansible/"><span class="tag">Ansible</span><span class="tag is-grey-lightest">25</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ceph/"><span class="tag">Ceph</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Docker/"><span class="tag">Docker</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JAVA/"><span class="tag">JAVA</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OpenShift/"><span class="tag">OpenShift</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/"><span class="tag">程序人生</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go/"><span class="tag">Go</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OKD/"><span class="tag">OKD</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%B9%E5%99%A8/"><span class="tag">容器</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C/"><span class="tag">网络</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CKA/"><span class="tag">CKA</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/shell/"><span class="tag">shell</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/"><span class="tag">云原生</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"><span class="tag">分布式</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"><span class="tag">微服务</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HCIP/"><span class="tag">HCIP</span><span class="tag is-grey-lightest">2</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="山河已无恙" height="28"></a><p class="size-small"><span>&copy; 2023 山河已无恙</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© <a href="http://www.beian.miit.gov.cn/" target="_blank">备案号</a><br></span><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已运行 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！❤️";
        }var now = new Date();setInterval("createTime('2021/6/26 21:27:00')", 250,"");</script><br></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2364053447" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/katex.min.css"><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/katex.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/contrib/auto-render.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/contrib/mhchem.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdnjs.loli.net/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('9fdc9739266d48d5f62e','c1cc33697d099a2197650ec9dadcb16bd4904655','LIRUILONGS','blog_comment',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('9fdc9739266d48d5f62e','c1cc33697d099a2197650ec9dadcb16bd4904655','LIRUILONGS','blog_comment',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>