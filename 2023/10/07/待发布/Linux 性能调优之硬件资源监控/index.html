<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Linux 性能调优之硬件资源监控 - 山河已无恙</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="山河已无恙"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="山河已无恙"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="对每个人而言，真正的职责只有一个：找到自我。然后在心中坚守其一生，全心全意，永不停息。所有其它的路都是不完整的，是人的逃避方式，是对大众理想的懦弱回归，是随波逐流，是对内心的恐惧 ——赫尔曼·黑塞《德米安》"><meta property="og:type" content="blog"><meta property="og:title" content="山河已无恙"><meta property="og:url" content="https://mp.weixin.qq.com/s?__biz=MzkyNjIxNTYwMw==&amp;mid=2247496480&amp;idx=1&amp;sn=a9971fed3962ef2a1aeda1f0bda65f86&amp;chksm=c2380ffcf54f86eaba8daac6caca72a70f38e61a8d25dc2a66d3a17b87c02530e326dcaea14b#rd"><meta property="og:site_name" content="山河已无恙"><meta property="og:description" content="对每个人而言，真正的职责只有一个：找到自我。然后在心中坚守其一生，全心全意，永不停息。所有其它的路都是不完整的，是人的逃避方式，是对大众理想的懦弱回归，是随波逐流，是对内心的恐惧 ——赫尔曼·黑塞《德米安》"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://mp.weixin.qq.com/img/头像.jpg"><meta property="article:published_time" content="2023-10-06T23:31:04.000Z"><meta property="article:modified_time" content="2023-11-14T01:17:07.986Z"><meta property="article:author" content="LIRUILONGS"><meta property="article:tag" content="Linux"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/头像.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://liruilongs.github.io/2023/10/07/%E5%BE%85%E5%8F%91%E5%B8%83/Linux%20%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E7%A1%AC%E4%BB%B6%E8%B5%84%E6%BA%90%E7%9B%91%E6%8E%A7/"},"headline":"山河已无恙","image":["https://img-blog.csdnimg.cn/fb323ebd880d4d6482824cc167883122.png"],"datePublished":"2023-10-06T23:31:04.000Z","dateModified":"2023-11-14T01:17:07.986Z","author":{"@type":"Person","name":"山河已无恙"},"description":"对每个人而言，真正的职责只有一个：找到自我。然后在心中坚守其一生，全心全意，永不停息。所有其它的路都是不完整的，是人的逃避方式，是对大众理想的懦弱回归，是随波逐流，是对内心的恐惧 ——赫尔曼·黑塞《德米安》"}</script><link rel="canonical" href="https://liruilongs.github.io/2023/10/07/%E5%BE%85%E5%8F%91%E5%B8%83/Linux%20%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E7%A1%AC%E4%BB%B6%E8%B5%84%E6%BA%90%E7%9B%91%E6%8E%A7/"><link rel="alternate" href="/path/to/atom.xml" title="山河已无恙" type="application/atom+xml"><link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Oxanium:wght@300;400;600&amp;family=Roboto+Mono"><link rel="stylesheet" href="/css/cyberpunk.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?3f06f2b732a5b1034c989f74e28d0eea";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css"><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.2"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="山河已无恙" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/media">影音</a><a class="navbar-item" href="/album">相册</a><a class="navbar-item" href="/friend">友链</a><a class="navbar-item" href="/self-talking">生活小记</a><a class="navbar-item" href="/message">留言墙</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Gitee" href="https://gitee.com/liruilonger"><i class="fab fa-git-square fa-1x"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/LIRUILONGS"><i class="fab fa-github fa-1x"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul fa-1x"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search fa-1x"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon fa-1x" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2023-10-07  <a class="commentCountImg" href="/2023/10/07/%E5%BE%85%E5%8F%91%E5%B8%83/Linux%20%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E7%A1%AC%E4%BB%B6%E8%B5%84%E6%BA%90%E7%9B%91%E6%8E%A7/#comment-container"><span class="display-none-class">5ff184878e678bf388c3a205ab5b8792</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="5ff184878e678bf388c3a205ab5b8792">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>30 分钟  <i class="fas fa-pencil-alt"> </i>4.5 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">Linux 性能调优之硬件资源监控</h1><div class="content"><p><strong><font color="009688"> 对每个人而言，真正的职责只有一个：找到自我。然后在心中坚守其一生，全心全意，永不停息。所有其它的路都是不完整的，是人的逃避方式，是对大众理想的懦弱回归，是随波逐流，是对内心的恐惧 ——赫尔曼·黑塞《德米安》</strong></font></p>
<span id="more"></span>
<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><hr>
<ul>
<li>考试整理相关笔记</li>
<li>博文内容涉及 Linux 硬件资源监控常见的命名介绍，涉及</li>
<li>硬件基本信息查看</li>
<li>查看硬件错误信息</li>
<li>查看虚拟环境和云环境资源</li>
<li>理解不足小伙伴帮忙指正</li>
</ul>
<p><strong><font color="009688"> 对每个人而言，真正的职责只有一个：找到自我。然后在心中坚守其一生，全心全意，永不停息。所有其它的路都是不完整的，是人的逃避方式，是对大众理想的懦弱回归，是随波逐流，是对内心的恐惧 ——赫尔曼·黑塞《德米安》</strong></font></p>
<hr>
<p>系统出现问题，或者存在异常的日志信息，某些进程运行缓慢，往往可能需要排除是否存在硬件问题，所以需要对硬件信息进行监控，查看是否存在异常信息</p>
<p>启动系统时会进行系统硬件检测，这些检测信息同时还会被写到 <code>dmesg buffer</code> 中， 在 Linux 系统中 ，<code>dmesg buffer</code> 记录下面一些信息：</p>
<ul>
<li>启动系统<code>硬件检测信息</code></li>
<li><code>驱动程序</code>的信息</li>
<li>查看<code>系统警告</code>或者<code>错误</code></li>
</ul>
<p>使用 <code>dmesg</code> 和 <code>jounalctl -k</code>选项 可以查看 <code>dmesg buffer</code> 的信息。</p>
<p>查看最后 10 行的数据信息,系统事件和操作的信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$dmesg</span>  | tail -f -n 10</span><br><span class="line">[56429.310740] br0: port 3(vnet4) entered blocking state</span><br><span class="line">[56429.310741] br0: port 3(vnet4) entered forwarding state</span><br><span class="line">[56431.360035] privbr0: port 3(vnet3) entered learning state</span><br><span class="line">[56433.408995] privbr0: port 3(vnet3) entered forwarding state</span><br><span class="line">[56433.409013] privbr0: topology change detected, propagating</span><br><span class="line">[56440.853859] kvm [45569]: vcpu0, guest rIP: 0xffffffff9e060e38 disabled perfctr wrmsr: 0xc2 data 0xffff</span><br><span class="line">[59043.415922] device-mapper: uevent: version 1.0.3</span><br><span class="line">[59043.416104] device-mapper: ioctl: 4.39.0-ioctl (2018-04-03) initialised: dm-devel@redhat.com</span><br><span class="line">[59176.644265] kvm [45401]: vcpu0, guest rIP: 0xffffffffa0260e38 disabled perfctr wrmsr: 0xc2 data 0xffff</span><br><span class="line">[59463.089835] bash (2579): drop_caches: 3</span><br></pre></td></tr></table></figure>

<p><code>dmesg -T</code> 可以将时间转化为人类可读的形式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$dmesg</span> -T | tail -f -n 10</span><br><span class="line">[Sun Sep 17 02:19:18 2023] br0: port 3(vnet4) entered blocking state</span><br><span class="line">[Sun Sep 17 02:19:18 2023] br0: port 3(vnet4) entered forwarding state</span><br><span class="line">[Sun Sep 17 02:19:20 2023] privbr0: port 3(vnet3) entered learning state</span><br><span class="line">[Sun Sep 17 02:19:22 2023] privbr0: port 3(vnet3) entered forwarding state</span><br><span class="line">[Sun Sep 17 02:19:22 2023] privbr0: topology change detected, propagating</span><br><span class="line">[Sun Sep 17 02:19:29 2023] kvm [45569]: vcpu0, guest rIP: 0xffffffff9e060e38 disabled perfctr wrmsr: 0xc2 data 0xffff</span><br><span class="line">[Sun Sep 17 03:02:52 2023] device-mapper: uevent: version 1.0.3</span><br><span class="line">[Sun Sep 17 03:02:52 2023] device-mapper: ioctl: 4.39.0-ioctl (2018-04-03) initialised: dm-devel@redhat.com</span><br><span class="line">[Sun Sep 17 03:05:05 2023] kvm [45401]: vcpu0, guest rIP: 0xffffffffa0260e38 disabled perfctr wrmsr: 0xc2 data 0xffff</span><br><span class="line">[Sun Sep 17 03:09:52 2023] bash (2579): drop_caches: 3</span><br></pre></td></tr></table></figure>

<p>查看前 10 行的数据信息.Linux内核启动过程的信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$dmesg</span> -T | head -n 10</span><br><span class="line">[Sat Sep 16 10:38:49 2023] Linux version 4.18.0-193.el8.x86_64 (mockbuild@x86-vm-08.build.eng.bos.redhat.com) (gcc version 8.3.1 20191121 (Red Hat 8.3.1-5) (GCC)) <span class="comment">#1 SMP Fri Mar 27 14:35:58 UTC 2020</span></span><br><span class="line">[Sat Sep 16 10:38:49 2023] Command line: BOOT_IMAGE=(hd0,msdos1)/vmlinuz-4.18.0-193.el8.x86_64 root=UUID=893bf4a5-f929-4a4f-9bb3-f1694d8ad757 ro resume=UUID=56504db0-34ca-458f-970b-1591a6af18bb rhgb quiet rd.shell=0</span><br><span class="line">[Sat Sep 16 10:38:49 2023] x86/fpu: Supporting XSAVE feature 0x001: <span class="string">&#x27;x87 floating point registers&#x27;</span></span><br><span class="line">[Sat Sep 16 10:38:49 2023] x86/fpu: Supporting XSAVE feature 0x002: <span class="string">&#x27;SSE registers&#x27;</span></span><br><span class="line">[Sat Sep 16 10:38:49 2023] x86/fpu: Supporting XSAVE feature 0x004: <span class="string">&#x27;AVX registers&#x27;</span></span><br><span class="line">[Sat Sep 16 10:38:49 2023] x86/fpu: Supporting XSAVE feature 0x020: <span class="string">&#x27;AVX-512 opmask&#x27;</span></span><br><span class="line">[Sat Sep 16 10:38:49 2023] x86/fpu: Supporting XSAVE feature 0x040: <span class="string">&#x27;AVX-512 Hi256&#x27;</span></span><br><span class="line">[Sat Sep 16 10:38:49 2023] x86/fpu: Supporting XSAVE feature 0x080: <span class="string">&#x27;AVX-512 ZMM_Hi256&#x27;</span></span><br><span class="line">[Sat Sep 16 10:38:49 2023] x86/fpu: Supporting XSAVE feature 0x200: <span class="string">&#x27;Protection Keys User registers&#x27;</span></span><br><span class="line">[Sat Sep 16 10:38:49 2023] x86/fpu: xstate_offset[2]:  576, xstate_sizes[2]:  256</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<p>通过  <code>journalctl -k</code> 命令来查看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$ journalctl -k</span><br><span class="line">-- Logs begin at 五 2023-11-10 10:32:56 CST, end at 五 2023-11-10 10:36:16 CST. --</span><br><span class="line">11月 10 10:32:56 vms81.liruilongs.github.io kernel: Initializing cgroup subsys cpuset</span><br><span class="line">11月 10 10:32:56 vms81.liruilongs.github.io kernel: Initializing cgroup subsys cpu</span><br><span class="line">11月 10 10:32:56 vms81.liruilongs.github.io kernel: Initializing cgroup subsys cpuacct</span><br><span class="line">11月 10 10:32:56 vms81.liruilongs.github.io kernel: Linux version 3.10.0-1160.76.1.el7.x86_64 (mockbuild@kbuilder.bsys.c</span><br><span class="line">11月 10 10:32:56 vms81.liruilongs.github.io kernel: Command line: BOOT_IMAGE=/boot/vmlinuz-3.10.0-1160.76.1.el7.x86_64 r</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p>在日常维护中，往往结合 <code>grep</code> 快速定位问题</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$ dmesg -T | grep -i error</span><br><span class="line">[五 11月 10 10:32:57 2023] BERT: Boot Error Record Table support is disabled. Enable it by using bert_enable as kernel parameter.</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$ dmesg -T | grep -i warn</span><br><span class="line">[五 11月 10 10:32:54 2023] Warning: Intel Processor - this hardware has not undergone upstream testing. Please consult http://wiki.centos.org/FAQ <span class="keyword">for</span> more information</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<h2 id="硬件信息查看"><a href="#硬件信息查看" class="headerlink" title="硬件信息查看"></a>硬件信息查看</h2><p>当前系统中一般会使用多个 CPU，每个 CPU 有多个核心，每个内核还可能具备超线程并具备不同级别的共享缓存</p>
<p><code>lscpu</code> 命令可以查看系统的 CPU 的信息</p>
<p>Intel CPU 信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$lscpu</span></span><br><span class="line">Architecture:        x86_64</span><br><span class="line">CPU op-mode(s):      32-bit, 64-bit</span><br><span class="line">Byte Order:          Little Endian</span><br><span class="line">CPU(s):              8</span><br><span class="line">On-line CPU(s) list: 0-7</span><br><span class="line">Thread(s) per core:  1</span><br><span class="line">Core(s) per socket:  4</span><br><span class="line">Socket(s):           2</span><br><span class="line">NUMA node(s):        1</span><br><span class="line">Vendor ID:           GenuineIntel</span><br><span class="line">CPU family:          6</span><br><span class="line">Model:               140</span><br><span class="line">Model name:          11th Gen Intel(R) Core(TM) i5-1135G7 @ 2.40GHz</span><br><span class="line">Stepping:            1</span><br><span class="line">CPU MHz:             2419.226</span><br><span class="line">BogoMIPS:            4838.45</span><br><span class="line">Virtualization:      VT-x</span><br><span class="line">Hypervisor vendor:   VMware</span><br><span class="line">Virtualization <span class="built_in">type</span>: full</span><br><span class="line">L1d cache:           48K</span><br><span class="line">L1i cache:           32K</span><br><span class="line">L2 cache:            1280K</span><br><span class="line">L3 cache:            8192K</span><br><span class="line">NUMA node0 CPU(s):   0-7</span><br><span class="line">Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss ht syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon rep_good nopl xtopology tsc_reliable nonstop_tsc cpuid pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch cpuid_fault invpcid_single ssbd ibrs ibpb stibp ibrs_enhanced tpr_shadow vnmi ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid avx512f avx512dq rdseed adx smap avx512ifma clflushopt clwb avx512cd sha_ni avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves arat avx512vbmi umip pku ospke avx512_vbmi2 gfni vaes vpclmulqdq avx512_vnni avx512_bitalg avx512_vpopcntdq rdpid movdiri movdir64b md_clear flush_l1d arch_capabilities</span><br></pre></td></tr></table></figure>

<p>简单的输出信息说明</p>
<p>系统架构是 <code>x86_64（64 位）</code>，支持 32 位和 64 位的 CPU 操作模式。字节顺序为小端（Little Endian）。系统有 <code>8 个 CPU 核心</code>，每个核心有 <code>1 个线程</code>。每个 CPU 插槽有 4 个核心，共有 2 个插槽。NUMA 节点数为 1。</p>
<p>以下是有关您的 CPU 的信息：</p>
<ul>
<li>厂商 ID：GenuineIntel</li>
<li>CPU 家族：6</li>
<li>型号：140</li>
<li>型号名称：11th Gen Intel(R) Core(TM) i5-1135G7 @ 2.40GHz</li>
<li>步进：1</li>
<li>CPU 频率：2419.226 MHz</li>
<li>BogoMIPS：4838.45</li>
<li>支持虚拟化技术：VT-x</li>
<li>Hypervisor 厂商：VMware</li>
<li>虚拟化类型：full</li>
<li>关于 CPU 缓存的信息：</li>
<li>L1d 缓存：48K</li>
<li>L1i 缓存：32K</li>
<li>L2 缓存：1280K</li>
<li>L3 缓存：8192K</li>
<li>系统具有许多 CPU 功能和特性，包括浮点运算单元（fpu）、虚拟化扩展（vmx）、超线程（ht）、AES 指令集（aes）、AVX 指令集（avx）等等。</li>
</ul>
<p>服务器 CPU 信息查看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@hp-ProLiant-SL270s-Gen8-SE]-[~]</span><br><span class="line">└─$ lscpu</span><br><span class="line">架构：                   x86_64</span><br><span class="line">  CPU 运行模式：         32-bit, 64-bit</span><br><span class="line">  Address sizes:         46 bits physical, 48 bits virtual</span><br><span class="line">  字节序：               Little Endian</span><br><span class="line">CPU:                     32</span><br><span class="line">  在线 CPU 列表：        0-31</span><br><span class="line">厂商 ID：                GenuineIntel</span><br><span class="line">  型号名称：             Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz</span><br><span class="line">    CPU 系列：           6</span><br><span class="line">    型号：               45</span><br><span class="line">    每个核的线程数：     2</span><br><span class="line">    每个座的核数：       8</span><br><span class="line">    座：                 2</span><br><span class="line">    步进：               7</span><br><span class="line">    CPU 最大 MHz：       3300.0000</span><br><span class="line">    CPU 最小 MHz：       1200.0000</span><br><span class="line">    BogoMIPS：           5187.49</span><br><span class="line">    标记：               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fx</span><br><span class="line">                         sr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_go</span><br><span class="line">                         od nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est</span><br><span class="line">                         tm2 ssse3 cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx</span><br><span class="line">                         lahf_lm epb pti ssbd ibrs ibpb stibp tpr_shadow vnmi flexpriority ept vpid xsaveopt dtherm ida</span><br><span class="line">                         arat pln pts md_clear flush_l1d</span><br><span class="line">Virtualization features:</span><br><span class="line">  虚拟化：               VT-x</span><br><span class="line">Caches (sum of all):</span><br><span class="line">  L1d:                   512 KiB (16 instances)</span><br><span class="line">  L1i:                   512 KiB (16 instances)</span><br><span class="line">  L2:                    4 MiB (16 instances)</span><br><span class="line">  L3:                    40 MiB (2 instances)</span><br><span class="line">NUMA:</span><br><span class="line">  NUMA 节点：            2</span><br><span class="line">  NUMA 节点0 CPU：       0-7,16-23</span><br><span class="line">  NUMA 节点1 CPU：       8-15,24-31</span><br><span class="line">Vulnerabilities:</span><br><span class="line">  Itlb multihit:         KVM: Mitigation: VMX disabled</span><br><span class="line">  L1tf:                  Mitigation; PTE Inversion; VMX conditional cache flushes, SMT vulnerable</span><br><span class="line">  Mds:                   Mitigation; Clear CPU buffers; SMT vulnerable</span><br><span class="line">  Meltdown:              Mitigation; PTI</span><br><span class="line">  Mmio stale data:       Unknown: No mitigations</span><br><span class="line">  Retbleed:              Not affected</span><br><span class="line">  Spec store bypass:     Mitigation; Speculative Store Bypass disabled via prctl</span><br><span class="line">  Spectre v1:            Mitigation; usercopy/swapgs barriers and __user pointer sanitization</span><br><span class="line">  Spectre v2:            Mitigation; Retpolines, IBPB conditional, IBRS_FW, STIBP conditional, RSB filling, PBRSB-eIBRS</span><br><span class="line">                         Not affected</span><br><span class="line">  Srbds:                 Not affected</span><br><span class="line">  Tsx async abort:       Not affected</span><br><span class="line">┌──[root@hp-ProLiant-SL270s-Gen8-SE]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<p>基本信息：</p>
<ul>
<li>CPU: Intel Xeon E5-2670, Sandy Bridge-EP微架构,双芯片(Socket)每个Socket 8核心</li>
<li>多线程支持:每个核心支持两个线程</li>
<li>缓存结构:每个核心有512KB L1缓存,4MB L2缓存,两颗CPU共享40MB L3缓存</li>
<li>NUMA结构:有两个NUMA节点,第一个节点CPU为0-7,第二个为8-15</li>
<li>虚拟化支持:支持Intel VT-x虚拟化技术</li>
<li>性能信息:基准指标5187.49 Bogomips</li>
<li>支持特性:SSE,AVX,虚拟化、数据本地性等</li>
<li>漏洞修复:针对Meltdown、Spectre等已修复</li>
</ul>
<p>AMD CPU 信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$ lscpu</span><br><span class="line">Architecture:          x86_64</span><br><span class="line">CPU op-mode(s):        32-bit, 64-bit</span><br><span class="line">Byte Order:            Little Endian</span><br><span class="line">CPU(s):                4</span><br><span class="line">On-line CPU(s) list:   0-3</span><br><span class="line">Thread(s) per core:    1</span><br><span class="line">Core(s) per socket:    2</span><br><span class="line">座：                 2</span><br><span class="line">NUMA 节点：         1</span><br><span class="line">厂商 ID：           AuthenticAMD</span><br><span class="line">CPU 系列：          23</span><br><span class="line">型号：              17</span><br><span class="line">型号名称：        AMD Ryzen 7 2700U with Radeon Vega Mobile Gfx</span><br><span class="line">步进：              0</span><br><span class="line">CPU MHz：             2195.781</span><br><span class="line">BogoMIPS：            4391.56</span><br><span class="line">超管理器厂商：  VMware</span><br><span class="line">虚拟化类型：     完全</span><br><span class="line">L1d 缓存：          32K</span><br><span class="line">L1i 缓存：          64K</span><br><span class="line">L2 缓存：           512K</span><br><span class="line">L3 缓存：           4096K</span><br><span class="line">NUMA 节点0 CPU：    0-3</span><br><span class="line">Flags:                 fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm constant_tsc art rep_good nopl tsc_reliable nonstop_tsc extd_apicid eagerfpu pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm cmp_legacy cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw fsgsbase bmi1 avx2 smep bmi2 rdseed adx smap clflushopt sha_ni xsaveopt xsavec arat overflow_recov succor</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<p><code>dmidecode</code> 可以查看 主板设备信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@hp-ProLiant-SL270s-Gen8-SE]-[~]</span><br><span class="line">└─$ dmidecode | head -n 10</span><br><span class="line"><span class="comment"># dmidecode 3.3</span></span><br><span class="line">Getting SMBIOS data from sysfs.</span><br><span class="line">SMBIOS 2.8 present.</span><br><span class="line">188 structures occupying 5969 bytes.</span><br><span class="line">Table at 0xBFBD8000.</span><br><span class="line"></span><br><span class="line">Handle 0x0000, DMI <span class="built_in">type</span> 0, 24 bytes</span><br><span class="line">BIOS Information</span><br><span class="line">        Vendor: HP</span><br><span class="line">        Version: P75</span><br><span class="line">┌──[root@hp-ProLiant-SL270s-Gen8-SE]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<p>查看 usb 设备信息，通过 <code>-vv</code> 可以查看详细信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$lsusb</span></span><br><span class="line">Bus 004 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub</span><br><span class="line">Bus 003 Device 002: ID 0e0f:0003 VMware, Inc. Virtual Mouse</span><br><span class="line">Bus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span><br><span class="line">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span><br><span class="line">Bus 002 Device 003: ID 0e0f:0002 VMware, Inc. Virtual USB Hub</span><br><span class="line">Bus 002 Device 002: ID 0e0f:0008 VMware, Inc.</span><br><span class="line">Bus 002 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub</span><br></pre></td></tr></table></figure>

<p><code>lspci</code>命令用于列出连接到 PCI 总线的设备信息，它可以显示计算机上安装的 PCI 设备的详细信息，包括网络适配器、显卡、声卡、存储控制器等。 -vv 选项可以查看详细的信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$lspci</span> -vv</span><br><span class="line">00:00.0 Host bridge: Intel Corporation 440BX/ZX/DX - 82443BX/ZX/DX Host bridge (rev 01)</span><br><span class="line">        Subsystem: VMware Virtual Machine Chipset</span><br><span class="line">        Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-</span><br><span class="line">        Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-</span><br><span class="line">        Latency: 0</span><br><span class="line"></span><br><span class="line">00:01.0 PCI bridge: Intel Corporation 440BX/ZX/DX - 82443BX/ZX/DX AGP bridge (rev 01) (prog-if 00 [Normal decode])</span><br><span class="line">        Control: I/O+ Mem+ BusMaster+ SpecCycle+ MemWINV+ VGASnoop- ParErr- Stepping- SERR+ FastB2B- DisINTx-</span><br><span class="line">        Status: Cap- 66MHz+ UDF- FastB2B- ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-</span><br><span class="line">        Latency: 0</span><br><span class="line">        Bus: primary=00, secondary=01, subordinate=01, sec-latency=64</span><br><span class="line">        I/O behind bridge: None</span><br><span class="line">        Memory behind bridge: None</span><br><span class="line">        Prefetchable memory behind bridge: None</span><br><span class="line">        Secondary status: 66MHz+ FastB2B+ ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &lt;SERR- &lt;PERR-</span><br><span class="line">        BridgeCtl: Parity- SERR- NoISA+ VGA- MAbort- &gt;Reset- FastB2B+</span><br><span class="line">                PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn-</span><br><span class="line"></span><br><span class="line">00:07.0 ISA bridge: Intel Corporation 82371AB/EB/MB PIIX4 ISA (rev 08)</span><br><span class="line">        Subsystem: VMware Virtual Machine Chipset</span><br><span class="line">        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-</span><br><span class="line">        Status: Cap- 66MHz- UDF- FastB2B+ ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-</span><br><span class="line">        Latency: 0</span><br><span class="line"></span><br><span class="line">00:07.1 IDE interface: Intel Corporation 82371AB/EB/MB PIIX4 IDE (rev 01) (prog-if 8a [ISA Compatibility mode controller, supports both channels switched to PCI native mode, supports bus mastering])</span><br><span class="line">        Subsystem: VMware Virtual Machine Chipset</span><br><span class="line">        Control: I/O+ Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-</span><br><span class="line">        Status: Cap- 66MHz- UDF- FastB2B+ ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-</span><br><span class="line">        Latency: 64</span><br><span class="line">        Region 0: [virtual] Memory at 000001f0 (32-bit, non-prefetchable) [size=8]</span><br><span class="line">        Region 1: [virtual] Memory at 000003f0 (<span class="built_in">type</span> 3, non-prefetchable)</span><br><span class="line">        Region 2: [virtual] Memory at 00000170 (32-bit, non-prefetchable) [size=8]</span><br><span class="line">        Region 3: [virtual] Memory at 00000370 (<span class="built_in">type</span> 3, non-prefetchable)</span><br><span class="line">        Region 4: I/O ports at 1060 [size=16]</span><br><span class="line">        Kernel driver <span class="keyword">in</span> use: ata_piix</span><br><span class="line">        Kernel modules: ata_piix, ata_generic</span><br><span class="line">        ...............</span><br></pre></td></tr></table></figure>

<p><code>hwloc</code>是一个开源软件包，提供了命令行和图形工具，用于收集和展示硬件信息。它可以帮助用户了解系统中的<code>硬件拓扑结构</code>，包括处理器、缓存、内存、PCI设备和网络设备等</p>
<p>lstopo：是<code>hwloc</code>的主要命令行工具，用于展示硬件拓扑结构。它会生成一个图形化的拓扑图，显示处理器、缓存、内存和其他设备的层次结构和拓扑关系,如果没有图形环境，<code>Istopo-no-graphics</code> 可以提供命令行文字信息输出</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$ yum  -y install  hwloc</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$  lstopo-no-graphics</span><br><span class="line">Machine (4226MB)</span><br><span class="line">  L3 L<span class="comment">#0 (4096KB)</span></span><br><span class="line">    Package L<span class="comment">#0</span></span><br><span class="line">      L2 L<span class="comment">#0 (512KB) + L1d L#0 (32KB) + L1i L#0 (64KB) + Core L#0 + PU L#0 (P#0)</span></span><br><span class="line">      L2 L<span class="comment">#1 (512KB) + L1d L#1 (32KB) + L1i L#1 (64KB) + Core L#1 + PU L#1 (P#1)</span></span><br><span class="line">    Package L<span class="comment">#1</span></span><br><span class="line">      L2 L<span class="comment">#2 (512KB) + L1d L#2 (32KB) + L1i L#2 (64KB) + Core L#2 + PU L#2 (P#2)</span></span><br><span class="line">      L2 L<span class="comment">#3 (512KB) + L1d L#3 (32KB) + L1i L#3 (64KB) + Core L#3 + PU L#3 (P#3)</span></span><br><span class="line">  HostBridge L<span class="comment">#0</span></span><br><span class="line">    PCI 8086:7111</span><br><span class="line">    PCI 15ad:0405</span><br><span class="line">    PCI 1000:0030</span><br><span class="line">      Block(Disk) L<span class="comment">#0 &quot;sda&quot;</span></span><br><span class="line">    PCIBridge</span><br><span class="line">      PCI 8086:100f</span><br><span class="line">        Net L<span class="comment">#1 &quot;ens32&quot;</span></span><br><span class="line">      PCI 15ad:07e0</span><br></pre></td></tr></table></figure>

<p>根据输出，可以看到以下组件：</p>
<ul>
<li><p>机器（Machine）：总共有 4226MB 的内存容量。</p>
</li>
<li><p>L3 缓存（L3 L#0）：具有 4096KB 的容量。</p>
</li>
<li><p>处理器包（Package）：存在两个处理器包（Package L#0 和 Package L#1）。</p>
<ul>
<li>每个处理器包中包含以下组件：<ul>
<li>L2 缓存（L2 L#0 和 L2 L#1）：每个 L2 缓存具有 512KB 的容量。</li>
<li>L1 数据缓存（L1d L#0 和 L1d L#1）：每个 L1 数据缓存具有 32KB 的容量。</li>
<li>L1 指令缓存（L1i L#0 和 L1i L#1）：每个 L1 指令缓存具有 64KB 的容量。</li>
<li>核心（Core L#0、Core L#1、Core L#2 和 Core L#3）：每个处理器包中有四个核心。</li>
<li>处理单元（PU L#0、PU L#1、PU L#2 和 PU L#3）：每个核心有一个处理单元。</li>
</ul>
</li>
</ul>
</li>
<li><p>主机桥接器（HostBridge L#0）：用于连接其他组件的主机桥接器。</p>
<ul>
<li>PCI 设备：显示了一些 PCI 设备的信息，包括厂商和设备的 ID。</li>
<li>PCI 8086:7111</li>
<li>PCI 15ad:0405</li>
<li>PCI 1000:0030<ul>
<li>硬盘块（Block）：标识为 “sda” 的磁盘块。</li>
</ul>
</li>
<li>PCI 8086:100f<ul>
<li>网络设备（Net）：标识为 “ens32” 的网络设备。</li>
</ul>
</li>
<li>PCI 15ad:07e0</li>
</ul>
</li>
</ul>
<p>通过 <code>-v</code> 选项，可以查看更详细的信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$  lstopo-no-graphics -v</span><br><span class="line">Machine (P<span class="comment">#0 local=4327132KB total=4327132KB DMIProductName=&quot;VMware Virtual Platform&quot; DMIProductVersion=None DMIProductSerial=&quot;VMware-56 4d 75 ae f9 4e 9f ad-ba a0 f4 a3 26 c9 6f ae&quot; DMIProductUUID=AE754D56-4EF9-AD9F-BAA0-F4A326C96FAE DMIBoardVendor=&quot;Intel Corporation&quot; DMIBoardName=&quot;440BX Desktop Reference Platform&quot; DMIBoardVersion=None DMIBoardSerial=None DMIBoardAssetTag= DMIChassisVendor=&quot;No Enclosure&quot; DMIChassisType=1 DMIChassisVersion=N/A DMIChassisSerial=None DMIChassisAssetTag=&quot;No Asset Tag&quot; DMIBIOSVendor=&quot;Phoenix Technologies LTD&quot; DMIBIOSVersion=6.00 DMIBIOSDate=07/22/2020 DMISysVendor=&quot;VMware, Inc.&quot; Backend=Linux LinuxCgroup=/ OSName=Linux OSRelease=3.10.0-693.el7.x86_64 OSVersion=&quot;#1 SMP Tue Aug 22 21:09:27 UTC 2017&quot; HostName=liruilongs.github.io Architecture=x86_64 hwlocVersion=1.11.8 ProcessName=lstopo-no-graphics)</span></span><br><span class="line">  L3Cache L<span class="comment">#0 (size=4096KB linesize=64 ways=16 Inclusive=0)</span></span><br><span class="line">    Package L<span class="comment">#0 (P#0 CPUVendor=AuthenticAMD CPUFamilyNumber=23 CPUModelNumber=17 CPUModel=&quot;AMD Ryzen 7 2700U with Radeon Vega Mobile Gfx&quot; CPUStepping=0)</span></span><br><span class="line">      L2Cache L<span class="comment">#0 (size=512KB linesize=64 ways=8 Inclusive=0)</span></span><br><span class="line">        L1dCache L<span class="comment">#0 (size=32KB linesize=64 ways=16 Inclusive=0)</span></span><br><span class="line">          L1iCache L<span class="comment">#0 (size=64KB linesize=64 ways=4 Inclusive=0)</span></span><br><span class="line">            Core L<span class="comment">#0 (P#0)</span></span><br><span class="line">              PU L<span class="comment">#0 (P#0)</span></span><br><span class="line">      L2Cache L<span class="comment">#1 (size=512KB linesize=64 ways=8 Inclusive=0)</span></span><br><span class="line">        L1dCache L<span class="comment">#1 (size=32KB linesize=64 ways=16 Inclusive=0)</span></span><br><span class="line">          L1iCache L<span class="comment">#1 (size=64KB linesize=64 ways=4 Inclusive=0)</span></span><br><span class="line">            Core L<span class="comment">#1 (P#1)</span></span><br><span class="line">              PU L<span class="comment">#1 (P#1)</span></span><br><span class="line">...................................</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<p>支持通过以下方式来查看硬件拓扑结构信息</p>
<ul>
<li><code>lstopo-no-graphics --output-format txt</code>：以文本格式输出硬件拓扑结构。</li>
<li><code>lstopo-no-graphics --output-format xml</code>：以XML格式输出硬件拓扑结构。</li>
<li><code>lstopo-no-graphics --output-format fig</code>：以FIG格式输出硬件拓扑结构。</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/fb323ebd880d4d6482824cc167883122.png" alt="在这里插入图片描述"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@hp-ProLiant-SL270s-Gen8-SE]-[~]</span><br><span class="line">└─$ lstopo-no-graphics --output-format txt</span><br><span class="line">Authorization required, but no authorization protocol specified</span><br><span class="line">┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐</span><br><span class="line">│ Machine (126GB total)                                                                                                                                                                                                                                                      │</span><br><span class="line">│                                                                                                                                                                                                                                                                            │</span><br><span class="line">│ ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐  ┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │</span><br><span class="line">│ │ Package L<span class="comment">#0                                                                                                                     │  │ Package L#1                                                                                                                       │ │</span></span><br><span class="line">│ │                                                                                                                                 │  │                                                                                                                                   │ │</span><br><span class="line">│ │ ┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │  │ ┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ │</span><br><span class="line">│ │ │ NUMANode L<span class="comment">#0 P#0 (63GB)                                                                                                     │ │  │ │ NUMANode L#1 P#1 (63GB)                                                                                                       │ │ │</span></span><br><span class="line">│ │ └─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │  │ └───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │ │</span><br><span class="line">│ │                                                                                                                                 │  │                                                                                                                                   │ │</span><br><span class="line">│ │ ┌───────────────────────────────────────────────────────────┐  ├┤╶─┬─────┼┤╶───────┬─────────────┐                              │  │ ┌───────────────────────────────────────────────────────────┐  ├┤╶─┬─────┼┤╶───────┼┤╶─┬─────┼┤╶───────┬────────────────────────┐ │ │</span><br><span class="line">│ │ │ L3 (20MB)                                                 │      │2.0       2.0  │ PCI 05:00.0 │                              │  │ │ L3 (20MB)                                                 │      │7.9       7.9      │7.9       7.9  │ PCI 23:00.0            │ │ │</span><br><span class="line">│ │ └───────────────────────────────────────────────────────────┘      │               └─────────────┘                              │  │ └───────────────────────────────────────────────────────────┘      │                   │               │                        │ │ │</span><br><span class="line">│ │                                                                    │                                                            │  │                                                                    │                   │               │ ┌────────────────────┐ │ │ │</span><br><span class="line">│ │ ┌─────────────┐  ┌─────────────┐              ┌─────────────┐      ├─────┼┤╶───────┼┤╶─┬─────┼┤╶───────┬──────────────────────┐ │  │ ┌─────────────┐  ┌─────────────┐              ┌─────────────┐      │                   │               │ │ OpenFabrics mlx4_0 │ │ │ │</span><br><span class="line">│ │ │ L2 (256KB)  │  │ L2 (256KB)  │  ├┤  ├┤  ├┤  │ L2 (256KB)  │      │16        16       │4.0       4.0  │ PCI 0d:00.0          │ │  │ │ L2 (256KB)  │  │ L2 (256KB)  │  ├┤  ├┤  ├┤  │ L2 (256KB)  │      │                   │               │ └────────────────────┘ │ │ │</span><br><span class="line">│ │ └─────────────┘  └─────────────┘              └─────────────┘      │                   │               │                      │ │  │ └─────────────┘  └─────────────┘              └─────────────┘      │                   │               └────────────────────────┘ │ │</span><br><span class="line">│ │                                    8x total                        │                   │               │ ┌──────────────────┐ │ │  │                                    8x total                        │                   │                                          │ │</span><br><span class="line">│ │ ┌─────────────┐  ┌─────────────┐              ┌─────────────┐      │                   │               │ │ CoProc opencl0d1 │ │ │  │ ┌─────────────┐  ┌─────────────┐              ┌─────────────┐      │                   └─────┼┤╶───────┬───────────────┐          │ │</span><br><span class="line">│ │ │ L1d (32KB)  │  │ L1d (32KB)  │              │ L1d (32KB)  │      │                   │               │ │                  │ │ │  │ │ L1d (32KB)  │  │ L1d (32KB)  │              │ L1d (32KB)  │      │                    7.9       7.9  │ PCI 24:00.0   │          │ │</span><br><span class="line">│ │ └─────────────┘  └─────────────┘              └─────────────┘      │                   │               │ │ 15 compute units │ │ │  │ └─────────────┘  └─────────────┘              └─────────────┘      │                                   │               │          │ │</span><br><span class="line">│ │                                                                    │                   │               │ │                  │ │ │  │                                                                    │                                   │ ┌───────────┐ │          │ │</span><br><span class="line">│ │ ┌─────────────┐  ┌─────────────┐              ┌─────────────┐      │                   │               │ │ 11 GB            │ │ │  │ ┌─────────────┐  ┌─────────────┐              ┌─────────────┐      │                                   │ │ Block sda │ │          │ │</span><br><span class="line">│ │ │ L1i (32KB)  │  │ L1i (32KB)  │              │ L1i (32KB)  │      │                   │               │ └──────────────────┘ │ │  │ │ L1i (32KB)  │  │ L1i (32KB)  │              │ L1i (32KB)  │      │                                   │ │           │ │          │ │</span><br><span class="line">│ │ └─────────────┘  └─────────────┘              └─────────────┘      │                   │               └──────────────────────┘ │  │ └─────────────┘  └─────────────┘              └─────────────┘      │                                   │ │ 894 GB    │ │          │ │</span><br><span class="line">│ │                                                                    │                   │                                        │  │                                                                    │                                   │ └───────────┘ │          │ │</span><br><span class="line">│ │ ┌─────────────┐  ┌─────────────┐              ┌─────────────┐      │                   └─────┼┤╶───────┬──────────────────────┐ │  │ ┌─────────────┐  ┌─────────────┐              ┌─────────────┐      │                                   └───────────────┘          │ │</span><br><span class="line">│ │ │ Core L<span class="comment">#0    │  │ Core L#1    │              │ Core L#7    │      │                    4.0       4.0  │ PCI 0e:00.0          │ │  │ │ Core L#8    │  │ Core L#9    │              │ Core L#15   │      │                                                              │ │</span></span><br><span class="line">│ │ │             │  │             │              │             │      │                                   │                      │ │  │ │             │  │             │              │             │      ├─────┼┤╶───────┼┤╶─┬─────┼┤╶───────┬──────────────────────┐   │ │</span><br><span class="line">│ │ │ ┌─────────┐ │  │ ┌─────────┐ │              │ ┌─────────┐ │      │                                   │ ┌──────────────────┐ │ │  │ │ ┌─────────┐ │  │ ┌─────────┐ │              │ ┌─────────┐ │      │16        16       │4.0       4.0  │ PCI 28:00.0          │   │ │</span><br><span class="line">│ │ │ │ PU L<span class="comment">#0  │ │  │ │ PU L#2  │ │              │ │ PU L#14 │ │      │                                   │ │ CoProc opencl0d2 │ │ │  │ │ │ PU L#16 │ │  │ │ PU L#18 │ │              │ │ PU L#30 │ │      │                   │               │                      │   │ │</span></span><br><span class="line">│ │ │ │         │ │  │ │         │ │              │ │         │ │      │                                   │ │                  │ │ │  │ │ │         │ │  │ │         │ │              │ │         │ │      │                   │               │ ┌──────────────────┐ │   │ │</span><br><span class="line">│ │ │ │   P<span class="comment">#0   │ │  │ │   P#1   │ │              │ │   P#7   │ │      │                                   │ │ 15 compute units │ │ │  │ │ │   P#8   │ │  │ │   P#9   │ │              │ │  P#15   │ │      │                   │               │ │ CoProc opencl0d3 │ │   │ │</span></span><br><span class="line">│ │ │ └─────────┘ │  │ └─────────┘ │              │ └─────────┘ │      │                                   │ │                  │ │ │  │ │ └─────────┘ │  │ └─────────┘ │              │ └─────────┘ │      │                   │               │ │                  │ │   │ │</span><br><span class="line">│ │ │ ┌─────────┐ │  │ ┌─────────┐ │              │ ┌─────────┐ │      │                                   │ │ 11 GB            │ │ │  │ │ ┌─────────┐ │  │ ┌─────────┐ │              │ ┌─────────┐ │      │                   │               │ │ 15 compute units │ │   │ │</span><br><span class="line">│ │ │ │ PU L<span class="comment">#1  │ │  │ │ PU L#3  │ │              │ │ PU L#15 │ │      │                                   │ └──────────────────┘ │ │  │ │ │ PU L#17 │ │  │ │ PU L#19 │ │              │ │ PU L#31 │ │      │                   │               │ │                  │ │   │ │</span></span><br><span class="line">│ │ │ │         │ │  │ │         │ │              │ │         │ │      │                                   └──────────────────────┘ │  │ │ │         │ │  │ │         │ │              │ │         │ │      │                   │               │ │ 11 GB            │ │   │ │</span><br><span class="line">│ │ │ │  P<span class="comment">#16   │ │  │ │  P#17   │ │              │ │  P#23   │ │      │                                                            │  │ │ │  P#24   │ │  │ │  P#25   │ │              │ │  P#31   │ │      │                   │               │ └──────────────────┘ │   │ │</span></span><br><span class="line">│ │ │ └─────────┘ │  │ └─────────┘ │              │ └─────────┘ │      ├─────┼┤╶───────┼┤╶───────┼┤╶───────┬──────────────────────┐ │  │ │ └─────────┘ │  │ └─────────┘ │              │ └─────────┘ │      │                   │               └──────────────────────┘   │ │</span><br><span class="line">│ │ └─────────────┘  └─────────────┘              └─────────────┘      │0.5       0.5       1.0       1.0  │ PCI 09:00.0          │ │  │ └─────────────┘  └─────────────┘              └─────────────┘      │                   │                                          │ │</span><br><span class="line">│ │                                                                    │                                   │                      │ │  │                                                                    │                   └─────┼┤╶───────┬──────────────────────┐   │ │</span><br><span class="line">│ │                                                                    │                                   │ ┌──────────────────┐ │ │  │                                                                    │                    4.0       4.0  │ PCI 2b:00.0          │   │ │</span><br><span class="line">│ │                                                                    │                                   │ │ CoProc opencl0d0 │ │ │  │                                                                    │                                   │                      │   │ │</span><br><span class="line">│ │                                                                    │                                   │ │                  │ │ │  │                                                                    │                                   │ ┌──────────────────┐ │   │ │</span><br><span class="line">│ │                                                                    │                                   │ │ 15 compute units │ │ │  │                                                                    │                                   │ │ CoProc opencl0d4 │ │   │ │</span><br><span class="line">│ │                                                                    │                                   │ │                  │ │ │  │                                                                    │                                   │ │                  │ │   │ │</span><br><span class="line">│ │                                                                    │                                   │ │ 11 GB            │ │ │  │                                                                    │                                   │ │ 15 compute units │ │   │ │</span><br><span class="line">│ │                                                                    │                                   │ └──────────────────┘ │ │  │                                                                    │                                   │ │                  │ │   │ │</span><br><span class="line">│ │                                                                    │                                   └──────────────────────┘ │  │                                                                    │                                   │ │ 11 GB            │ │   │ │</span><br><span class="line">│ │                                                                    │                                                            │  │                                                                    │                                   │ └──────────────────┘ │   │ │</span><br><span class="line">│ │                                                                    ├─────┼┤╶─┬─────┬──────────────┐                             │  │                                                                    │                                   └──────────────────────┘   │ │</span><br><span class="line">│ │                                                                    │2.0      │2.0  │ PCI 02:00.0  │                             │  │                                                                    │                                                              │ │</span><br><span class="line">│ │                                                                    │         │     │              │                             │  │                                                                    └─────┼┤╶───────┼┤╶─┬─────┼┤╶───────┬──────────────────────┐   │ │</span><br><span class="line">│ │                                                                    │         │     │ ┌──────────┐ │                             │  │                                                                     16        16       │4.0       4.0  │ PCI 30:00.0          │   │ │</span><br><span class="line">│ │                                                                    │         │     │ │ Net eno1 │ │                             │  │                                                                                        │               │                      │   │ │</span><br><span class="line">│ │                                                                    │         │     │ └──────────┘ │                             │  │                                                                                        │               │ ┌──────────────────┐ │   │ │</span><br><span class="line">│ │                                                                    │         │     └──────────────┘                             │  │                                                                                        │               │ │ CoProc opencl0d5 │ │   │ │</span><br><span class="line">│ │                                                                    │         │                                                  │  │                                                                                        │               │ │                  │ │   │ │</span><br><span class="line">│ │                                                                    │         └─────┬──────────────┐                             │  │                                                                                        │               │ │ 15 compute units │ │   │ │</span><br><span class="line">│ │                                                                    │          2.0  │ PCI 02:00.1  │                             │  │                                                                                        │               │ │                  │ │   │ │</span><br><span class="line">│ │                                                                    │               │              │                             │  │                                                                                        │               │ │ 11 GB            │ │   │ │</span><br><span class="line">│ │                                                                    │               │ ┌──────────┐ │                             │  │                                                                                        │               │ └──────────────────┘ │   │ │</span><br><span class="line">│ │                                                                    │               │ │ Net eno2 │ │                             │  │                                                                                        │               └──────────────────────┘   │ │</span><br><span class="line">│ │                                                                    │               │ └──────────┘ │                             │  │                                                                                        │                                          │ │</span><br><span class="line">│ │                                                                    │               └──────────────┘                             │  │                                                                                        └─────┼┤╶───────┬──────────────────────┐   │ │</span><br><span class="line">│ │                                                                    │                                                            │  │                                                                                         4.0       4.0  │ PCI 33:00.0          │   │ │</span><br><span class="line">│ │                                                                    └─────┼┤╶───────┬─────────────┐                              │  │                                                                                                        │                      │   │ │</span><br><span class="line">│ │                                                                     0.2       0.2  │ PCI 01:00.1 │                              │  │                                                                                                        │ ┌──────────────────┐ │   │ │</span><br><span class="line">│ │                                                                                    └─────────────┘                              │  │                                                                                                        │ │ CoProc opencl0d6 │ │   │ │</span><br><span class="line">│ └─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘  │                                                                                                        │ │                  │ │   │ │</span><br><span class="line">│                                                                                                                                      │                                                                                                        │ │ 15 compute units │ │   │ │</span><br><span class="line">│                                                                                                                                      │                                                                                                        │ │                  │ │   │ │</span><br><span class="line">│                                                                                                                                      │                                                                                                        │ │ 11 GB            │ │   │ │</span><br><span class="line">│                                                                                                                                      │                                                                                                        │ └──────────────────┘ │   │ │</span><br><span class="line">│                                                                                                                                      │                                                                                                        └──────────────────────┘   │ │</span><br><span class="line">│                                                                                                                                      └───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ │</span><br><span class="line">└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</span><br><span class="line">┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐</span><br><span class="line">│ Host: hp-ProLiant-SL270s-Gen8-SE                                                                                                                                                                                                                                           │</span><br><span class="line">│                                                                                                                                                                                                                                                                            │</span><br><span class="line">│ Date: 2023年11月10日 星期五 11时01分24秒                                                                                                                                                                                                                                            │</span><br><span class="line">└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</span><br><span class="line">┌──[root@hp-ProLiant-SL270s-Gen8-SE]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<p>从上面 lstopo 的输出可以看到这个系统的拓扑结构:</p>
<ul>
<li>这是一台双插槽双 处理器(processor) 的服务器,每个 processor 插槽默认安装了一个 <code>AMD EPYC 7002</code> 系列的 <code>CPU</code></li>
<li>每个 CPU 有多个核心,每个核有各级 cache,如 L1,L2,L3 缓存</li>
<li>多个核心通过<code>高速互联交换机</code>连接在一起,组成一个 numa 节点</li>
<li>每个 <code>numa</code> 节点有固定容量的内存,这里的是 <code>64GB</code></li>
<li>系统一共有两个 <code>numa</code> 节点,总内存为 <code>128GB</code></li>
<li>还安装了多块 <code>OpenCL</code> 加速卡,分布在两个 <code>numa</code> 节点上(CoProc: 加速卡,这里是AMD RadeonOpenCL计算卡)</li>
<li>另外还有两个网卡,连接外部网络,OpenFabrics: InfiniBand或者RoCE网络接口</li>
<li>磁盘是 <code>894GB</code>的串行<code>ATA 盘</code></li>
</ul>
<p>部分参数信息：</p>
<ul>
<li>Machine: 显示整体服务器硬件信息,总内存为 126GB</li>
<li>Package: CPU Socket,这里是两个Socket</li>
<li>NUMANode: NUMA节点,每个CPU Socket对应的是一个NUMA节点</li>
<li>L3: L3缓存,每个CPU有20MB L3缓存</li>
<li>PCI: PCIe插槽信息</li>
<li>L2: L2缓存,每个核有256KB L2缓存</li>
<li>OpenFabrics: InfiniBand或者RoCE网络接口</li>
<li>CoProc: 加速卡,这里是AMD RadeonOpenCL计算卡</li>
<li>L1d&#x2F;L1i: L1数据缓存和指令缓存,每个核32KB</li>
<li>Core: 物理CPU核</li>
<li>PU: 指令处理单元,每个物理核内部资源分配</li>
<li>Block: 磁盘磁道</li>
<li>Net: 网络接口信息</li>
</ul>
<p><code>lshw</code> 命令可以列出机器硬件相关详细信息，<code>lshw</code> 命令可以列出<code>内存，固件，主板，CPU，总线速度</code>等信息</p>
<p>lshw 命令将硬件组件分多个类别，如<code>系统，内存，网络</code>等</p>
<p>查看信息的 <code>class</code> 分类</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[root@workstation ~]<span class="comment"># lshw -short</span></span><br><span class="line">H/W path          Device      Class          Description</span><br><span class="line">========================================================</span><br><span class="line">                              system         KVM</span><br><span class="line">/0                            bus            Motherboard</span><br><span class="line">/0/0                          memory         96KiB BIOS</span><br><span class="line">/0/400                        processor      QEMU Virtual CPU version 2.5+</span><br><span class="line">/0/401                        processor      QEMU Virtual CPU version 2.5+</span><br><span class="line">/0/1000                       memory         2GiB System Memory</span><br><span class="line">/0/1000/0                     memory         2GiB DIMM RAM</span><br><span class="line">/0/100                        bridge         82G33/G31/P35/P31 Express DRAM Controller</span><br><span class="line">/0/100/1                      bridge         QEMU PCIe Root port</span><br><span class="line">/0/100/1/0                    network        Virtio network device</span><br><span class="line">/0/100/1/0/0      eth0        network        Ethernet interface</span><br><span class="line">/0/100/1.1                    bridge         QEMU PCIe Root port</span><br><span class="line">/0/100/1.1/0                  bus            QEMU XHCI Host Controller</span><br><span class="line">/0/100/1.1/0/0    usb1        bus            xHCI Host Controller</span><br><span class="line">/0/100/1.1/0/1    usb2        bus            xHCI Host Controller</span><br><span class="line">/0/100/1.2                    bridge         QEMU PCIe Root port</span><br><span class="line">/0/100/1.2/0                  communication  Virtio console</span><br><span class="line">/0/100/1.2/0/0                generic        Virtual I/O device</span><br><span class="line">/0/100/1.3                    bridge         QEMU PCIe Root port</span><br><span class="line">/0/100/1.3/0                  storage        Virtio block device</span><br><span class="line">/0/100/1.3/0/0    /dev/vda    disk           10GB Virtual I/O device</span><br><span class="line">/0/100/1.3/0/0/1              volume         10238MiB Linux filesystem partition</span><br><span class="line">/0/100/1.4                    bridge         QEMU PCIe Root port</span><br><span class="line">/0/100/1.4/0                  generic        Virtio memory balloon</span><br><span class="line">/0/100/1.4/0/0                generic        Virtual I/O device</span><br><span class="line">/0/100/1.5                    bridge         QEMU PCIe Root port</span><br><span class="line">/0/100/2                      display        Virtio GPU</span><br><span class="line">/0/100/2/0                    generic        Virtual I/O device</span><br><span class="line">/0/100/1f                     bridge         82801IB (ICH9) LPC Interface Controller</span><br><span class="line">/0/100/1f.2                   storage        82801IR/IO/IH (ICH9R/DO/DH) 6 port SATA Controller [AHCI mode]</span><br><span class="line">/0/100/1f.3                   bus            82801I (ICH9 Family) SMBus Controller</span><br><span class="line">/0/1                          system         PnP device PNP0b00</span><br><span class="line">/0/2                          input          PnP device PNP0303</span><br><span class="line">/0/3                          input          PnP device PNP0f13</span><br><span class="line">/0/4                          communication  PnP device PNP0501</span><br><span class="line">/1                virbr0      network        Ethernet interface</span><br><span class="line">/2                virbr0-nic  network        Ethernet interface</span><br></pre></td></tr></table></figure>

<p>查看特定类型的数据</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@hp-ProLiant-SL270s-Gen8-SE]-[~]</span><br><span class="line">└─$ lshw -c network</span><br><span class="line">  *-network:0</span><br><span class="line">       description: Ethernet interface</span><br><span class="line">       product: I350 Gigabit Network Connection</span><br><span class="line">       vendor: Intel Corporation</span><br><span class="line">       physical id: 0</span><br><span class="line">       bus info: pci@0000:02:00.0</span><br><span class="line">       logical name: eno1</span><br><span class="line">       version: 01</span><br><span class="line">       serial: 9c:b6:54:b5:e2:64</span><br><span class="line">       size: 100Mbit/s  <span class="comment">#size 指的是网卡当前的连接速度(Negotiated Speed)。</span></span><br><span class="line">       capacity: 1Gbit/s <span class="comment">#capacity 指的是网卡的最大理论连接速度能力(Maximum Speed)。</span></span><br><span class="line">       width: 32 bits</span><br><span class="line">       clock: 33MHz</span><br><span class="line">       capabilities: pm msi msix pciexpress vpd bus_master cap_list rom ethernet physical tp 10bt 10bt-fd 100bt 100bt-fd 1000bt-fd autonegotiation</span><br><span class="line">       configuration: autonegotiation=on broadcast=yes driver=igb driverversion=5.19.0-32-generic duplex=full firmware=1.61, 0x80000cd5, 1.949.0 ip=10.255.0.101 latency=0 link=yes multicast=yes port=twisted pair speed=100Mbit/s</span><br><span class="line">       resources: irq:16 memory:efd00000-efdfffff ioport:5000(size=32) memory:efcf0000-efcf3fff memory:efa00000-efa7ffff memory:3cbfdfe0000-3cbfdffffff memory:3cbfdfc0000-3cbfdfdffff</span><br><span class="line">  *-network:1</span><br><span class="line">       description: Ethernet interface</span><br><span class="line">       product: I350 Gigabit Network Connection</span><br><span class="line">       vendor: Intel Corporation</span><br><span class="line">       physical id: 0.1</span><br><span class="line">       bus info: pci@0000:02:00.1</span><br><span class="line">       logical name: eno2</span><br><span class="line">       version: 01</span><br><span class="line">       serial: 9c:b6:54:b5:e2:65</span><br><span class="line">       capacity: 1Gbit/s</span><br><span class="line">       width: 32 bits</span><br><span class="line">       clock: 33MHz</span><br><span class="line">       capabilities: pm msi msix pciexpress vpd bus_master cap_list rom ethernet physical tp 10bt 10bt-fd 100bt 100bt-fd 1000bt-fd autonegotiation</span><br><span class="line">       configuration: autonegotiation=on broadcast=yes driver=igb driverversion=5.19.0-32-generic firmware=1.61, 0x80000cd5, 1.949.0 latency=0 link=no multicast=yes port=twisted pair</span><br><span class="line">       resources: irq:17 memory:efb00000-efbfffff ioport:5020(size=32) memory:efaf0000-efaf3fff memory:efc00000-efc7ffff memory:3cbfdfa0000-3cbfdfbffff memory:3cbfdf80000-3cbfdf9ffff</span><br><span class="line">  *-network</span><br><span class="line">       description: Network controller</span><br><span class="line">       product: MT27520 Family [ConnectX-3 Pro]</span><br><span class="line">       vendor: Mellanox Technologies</span><br><span class="line">       physical id: 0</span><br><span class="line">       bus info: pci@0000:23:00.0</span><br><span class="line">       version: 00</span><br><span class="line">       width: 64 bits</span><br><span class="line">       clock: 33MHz</span><br><span class="line">       capabilities: pm vpd msix pciexpress bus_master cap_list rom</span><br><span class="line">       configuration: driver=mlx4_core latency=0</span><br><span class="line">       resources: iomemory:3e30-3e2f irq:46 memory:f6c00000-f6cfffff memory:3e3fc000000-3e3fdffffff memory:3e3dc000000-3e3fbffffff</span><br><span class="line">┌──[root@hp-ProLiant-SL270s-Gen8-SE]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<p>从<code>lshw</code>的输出可以得知这个系统的网络结构:</p>
<p>有2块<code>Intel I350</code>网卡,型号相同:</p>
<ul>
<li>eno1在PCI插槽0000:02:00.0</li>
<li>eno2在PCI插槽0000:02:00.1</li>
</ul>
<p>另外还有1块<code>Mellanox ConnectX-3 Pro InfiniBand</code>卡:</p>
<ul>
<li>在PCI插槽0000:23:00.0</li>
<li>使用mlx4_core驱动</li>
</ul>
<p>主要特点:</p>
<ul>
<li><code>Intel I350</code>是常见的1Gb以太网卡</li>
<li>MellanoxConnectX-3 Pro是InfiniBand卡,用于高性能计算集群</li>
<li>一个InfiniBand卡,两个以太网卡</li>
<li>以太网卡独立驱动与Mellanox卡单独驱动</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@hp-ProLiant-SL270s-Gen8-SE]-[~]</span><br><span class="line">└─$ lshw  -c disk</span><br><span class="line">  *-disk</span><br><span class="line">       description: SCSI Disk</span><br><span class="line">       product: LOGICAL VOLUME</span><br><span class="line">       vendor: HP</span><br><span class="line">       physical id: 1.0.0</span><br><span class="line">       bus info: scsi@1:1.0.0</span><br><span class="line">       logical name: /dev/sda</span><br><span class="line">       version: 3.22</span><br><span class="line">       serial: PBKTU0ARH3U005</span><br><span class="line">       size: 894GiB (960GB)</span><br><span class="line">       capabilities: 15000rpm gpt-1.00 partitioned partitioned:gpt</span><br><span class="line">       configuration: ansiversion=5 guid=525c7981-1a75-4223-a48b-cac0e40e44c2 logicalsectorsize=512 sectorsize=512</span><br><span class="line">┌──[root@hp-ProLiant-SL270s-Gen8-SE]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<p>也可以直接把硬件信息输出到 <code>html</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@workstation ~]<span class="comment"># lshw -html &gt; hw.hhtml</span></span><br></pre></td></tr></table></figure>

<h2 id="报告硬件错误"><a href="#报告硬件错误" class="headerlink" title="报告硬件错误"></a>报告硬件错误</h2><p>用户可以通过<code>rasdaemon</code>捕获并处理<code>内核生成的错误事件</code>，这些信息记录在<code>/sys/kernel/debug/tracing/</code>目录下，有 <code>syslog/journald</code> 报告使用<code>rasdaemon</code> 需要安装并启动服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@workstation ~]<span class="comment"># yum -y install  rasdaemon</span></span><br><span class="line">[root@workstation ~]<span class="comment"># systemctl enable --now rasdaemon.service</span></span><br></pre></td></tr></table></figure>

<p>可以在目录下查看相关的文件信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@hp-ProLiant-SL270s-Gen8-SE]-[~]</span><br><span class="line">└─$ ls /sys/kernel/debug/tracing/</span><br><span class="line">available_events            dynamic_events            hwlat_detector   printk_formats         set_event_pid           snapshot            trace_clock       tracing_max_latency</span><br><span class="line">available_filter_functions  dyn_ftrace_total_info     instances        README                 set_ftrace_filter       stack_max_size      trace_marker      tracing_on</span><br><span class="line">available_tracers           enabled_functions         kprobe_events    saved_cmdlines         set_ftrace_notrace      stack_trace         trace_marker_raw  tracing_thresh</span><br><span class="line">buffer_percent              error_log                 kprobe_profile   saved_cmdlines_size    set_ftrace_notrace_pid  stack_trace_filter  trace_options     uprobe_events</span><br><span class="line">buffer_size_kb              events                    max_graph_depth  saved_tgids            set_ftrace_pid          synthetic_events    trace_pipe        uprobe_profile</span><br><span class="line">buffer_total_size_kb        free_buffer               options          set_event              set_graph_function      timestamp_mode      trace_stat</span><br><span class="line">current_tracer              function_profile_enabled  per_cpu          set_event_notrace_pid  set_graph_notrace       trace               tracing_cpumask</span><br><span class="line">┌──[root@hp-ProLiant-SL270s-Gen8-SE]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<p>第一次运行可以会有如下报错信息，按照提示信息使用 <code>rasdaemon --record</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@workstation ~]<span class="comment"># ras-mc-ctl --summary</span></span><br><span class="line">DBD::SQLite::db prepare failed: no such table: mc_event at /usr/sbin/ras-mc-ctl line 1130.</span><br><span class="line">Can<span class="string">&#x27;t call method &quot;execute&quot; on an undefined value at /usr/sbin/ras-mc-ctl line 1131.</span></span><br><span class="line"><span class="string">[root@workstation ~]# ras-mc-ctl  --errors</span></span><br><span class="line"><span class="string">DBD::SQLite::db prepare failed: no such table: mc_event at /usr/sbin/ras-mc-ctl line 1208.</span></span><br><span class="line"><span class="string">ras-mc-ctl: Error: mc_event table missing from /var/lib/rasdaemon/ras-mc_event.db. Run &#x27;</span>rasdaemon --record<span class="string">&#x27;.</span></span><br><span class="line"><span class="string">[root@workstation ~]# rasdaemon --record</span></span><br></pre></td></tr></table></figure>

<p>运行 <code>ras-mc-ctl --errors</code>命令后，可以检测到以下类型的错误：</p>
<ul>
<li>内存错误（Memory errors）</li>
<li>PCIe AER 高速串行总线错误（PCIe Advanced Error Reporting errors）</li>
<li>Extlog 扩展日志错误（Extended Log errors）</li>
<li>MCE 机器检查异常错误（Machine Check Exception errors）</li>
</ul>
<p><code>ras-mc-ctl --errors</code> 命令用于列出当前系统中发生的<code>机器检查错误</code>。它会显示<code>内存错误、PCIe AER 错误、Extlog 错误和 MCE 错误</code>的详细信息（如果有的话）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@workstation ~]<span class="comment"># ras-mc-ctl  --errors</span></span><br><span class="line">No Memory errors.</span><br><span class="line"></span><br><span class="line">No PCIe AER errors.</span><br><span class="line"></span><br><span class="line">No Extlog errors.</span><br><span class="line"></span><br><span class="line">No MCE errors.</span><br></pre></td></tr></table></figure>

<p><code>ras-mc-ctl --summary</code> 命令用于提供机器检查错误的摘要信息。它会显示每个错误类型的总数，而不会提供每个具体错误的详细信息。这个命令适用于快速查看系统中错误的总体情况，以便对系统健康状况有一个概览。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@workstation ~]<span class="comment"># ras-mc-ctl --summary</span></span><br><span class="line">No Memory errors.</span><br><span class="line"></span><br><span class="line">No PCIe AER errors.</span><br><span class="line"></span><br><span class="line">No Extlog errors.</span><br><span class="line">No MCE errors.</span><br></pre></td></tr></table></figure>

<h2 id="查看虚拟环境和云环境的资源"><a href="#查看虚拟环境和云环境的资源" class="headerlink" title="查看虚拟环境和云环境的资源"></a>查看虚拟环境和云环境的资源</h2><p><code>KVM</code> 是基于内核的虚拟机技术，是内核可加载的模块，<code>KVM</code> 运行在内核空间。</p>
<ul>
<li><code>libvirt</code> 工具是虚拟机和相关设备的管理工具，需要安装工具包 <code>apt install libvirt-daemon-system</code></li>
<li><code>virsh</code> 命令使用 <code>libvit</code> 库和 API 访问虚拟机,当前命令需要安装工具包 <code>apt install libvirt-clients</code></li>
</ul>
<p><code>QEMU</code> 是仿真器，可以将<code>虚拟设备</code>提供给<code>虚拟机操作系统</code>包括：</p>
<ul>
<li>网络 PCI 控制器(virtio-net-pci)</li>
<li>存储控制器 (virtio-scsi-pci)</li>
<li>存储 PCI 块控制器 (virtio-blk)</li>
<li>内存 PCI 控制器 (virtio-balloon-pci)随机数发生器(virtio-rng-pci)</li>
<li>USB (ich9-usdb-uhci3 或 pciohci)网络设备动器 (e1000 或 virtio)</li>
<li>视频设备 (cirrus-vga-vga 或 qxl-vga)</li>
</ul>
<p>QEMU 可以与 KVM（Kernel-based Virtual Machine）结合使用，以提供完整的虚拟化解决方案。KVM 提供硬件虚拟化支持，而 QEMU 提供了虚拟机监控器和硬件仿真能力。结合使用时，KVM 负责处理虚拟化的底层操作，而 QEMU 负责模拟虚拟机的硬件设备。</p>
<p>列出所有的虚拟机</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$virsh</span> list --all</span><br><span class="line"> Id    Name                           State</span><br><span class="line">----------------------------------------------------</span><br><span class="line"> 1     classroom                      running</span><br><span class="line"> 2     workstation                    running</span><br><span class="line"> 3     bastion                        running</span><br><span class="line"> -     servera                        shut off</span><br><span class="line"> -     serverb                        shut off</span><br><span class="line"> -     serverc                        shut off</span><br><span class="line"> -     serverd                        shut off</span><br></pre></td></tr></table></figure>

<p>查看虚拟机的信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$virsh</span>  dominfo workstation</span><br><span class="line">Id:             2</span><br><span class="line">Name:           workstation</span><br><span class="line">UUID:           3f09a13c-94ad-4d97-8f76-17e9a81ae61f</span><br><span class="line">OS Type:        hvm</span><br><span class="line">State:          running</span><br><span class="line">CPU(s):         2</span><br><span class="line">CPU time:       1015.4s</span><br><span class="line">Max memory:     2097152 KiB</span><br><span class="line">Used memory:    2097152 KiB</span><br><span class="line">Persistent:     yes</span><br><span class="line">Autostart:      <span class="built_in">disable</span></span><br><span class="line">Managed save:   no</span><br><span class="line">Security model: selinux</span><br><span class="line">Security DOI:   0</span><br><span class="line">Security label: system_u:system_r:svirt_t:s0:c249,c656 (enforcing)</span><br></pre></td></tr></table></figure>
<p>查看虚拟机 CPU 信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$cat</span> /etc/libvirt/qemu/workstation.xml  | grep cpu</span><br><span class="line">  &lt;vcpu placement=<span class="string">&#x27;static&#x27;</span>&gt;2&lt;/vcpu&gt;</span><br></pre></td></tr></table></figure>

<p>查看宿主机和虚拟机的 CPU 时间</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$virsh</span>  cpu-stats workstation</span><br><span class="line">CPU0:</span><br><span class="line">        cpu_time           165.460132723 seconds</span><br><span class="line">        vcpu_time          128.590700314 seconds</span><br><span class="line">CPU1:</span><br><span class="line">        cpu_time           134.540034318 seconds</span><br><span class="line">        vcpu_time           98.868638312 seconds</span><br><span class="line">CPU2:</span><br><span class="line">        cpu_time            81.308894671 seconds</span><br><span class="line">        vcpu_time           49.496840393 seconds</span><br><span class="line">CPU3:</span><br><span class="line">        cpu_time            95.084166725 seconds</span><br><span class="line">        vcpu_time           57.692533169 seconds</span><br><span class="line">CPU4:</span><br><span class="line">        cpu_time           127.711824011 seconds</span><br><span class="line">        vcpu_time           93.085340637 seconds</span><br><span class="line">CPU5:</span><br><span class="line">        cpu_time           208.676280988 seconds</span><br><span class="line">        vcpu_time          172.028112759 seconds</span><br><span class="line">CPU6:</span><br><span class="line">        cpu_time            68.894659228 seconds</span><br><span class="line">        vcpu_time           38.683257218 seconds</span><br><span class="line">CPU7:</span><br><span class="line">        cpu_time           139.665723281 seconds</span><br><span class="line">        vcpu_time          103.899829328 seconds</span><br><span class="line">Total:</span><br><span class="line">        cpu_time          1021.341715945 seconds</span><br><span class="line">        user_time            1.360000000 seconds</span><br><span class="line">        system_time        144.920000000 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>获取名为 “workstation” 的虚拟机的 VCPU 信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$virsh</span>  vcpuinfo workstation</span><br><span class="line">VCPU:           0</span><br><span class="line">CPU:            5</span><br><span class="line">State:          running</span><br><span class="line">CPU time:       573.3s</span><br><span class="line">CPU Affinity:   yyyyyyyy</span><br><span class="line"></span><br><span class="line">VCPU:           1</span><br><span class="line">CPU:            7</span><br><span class="line">State:          running</span><br><span class="line">CPU time:       169.2s</span><br><span class="line">CPU Affinity:   yyyyyyyy</span><br><span class="line"></span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<p>内存气泡 <code>memballoon/belun/</code></p>
<p><code>Memory Ballooning（内存气泡）</code>是一种虚拟化技术，用于动态调整虚拟机的内存分配。它允许在运行的虚拟机之间共享和重新分配内存，以提高资源利用率。</p>
<p>Memory Ballooning 的工作原理如下：</p>
<ul>
<li>在虚拟机中安装并启动 <code>Virtio-Balloon</code> 驱动程序。<code>Virtio-Balloon</code> 是一种虚拟设备驱动程序，通过与宿主机（通常是 <code>QEMU</code>）通信来进行内存管理。</li>
<li>虚拟机启动后，<code>Virtio-Balloon</code> 驱动程序会向宿主机报告虚拟机当前的内存使用情况。</li>
<li>如果宿主机上的其他虚拟机需要更多内存，宿主机会发送请求给 <code>Virtio-Balloon</code> 驱动程序，要求虚拟机释放一部分内存。</li>
<li>虚拟机的 <code>Virtio-Balloon</code> 驱动程序会响应请求，通过将一些内存页面释放回宿主机，从而减少虚拟机的内存使用量。</li>
<li>宿主机收到释放的内存后，可以将其分配给其他虚拟机使用，从而实现内存的复用。</li>
</ul>
<p>查看 linux 内核是否具备 <code>virtio-ballon</code> 模块</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$ lsmod | grep virtio_balloon</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$ modprobe virtio_balloon</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$ lsmod | grep virtio_balloon</span><br><span class="line">virtio_balloon         18015  0</span><br><span class="line">virtio_ring            22991  1 virtio_balloon</span><br><span class="line">virtio                 14959  1 virtio_balloon</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$ modinfo virtio-balloon</span><br><span class="line">filename:       /lib/modules/3.10.0-1160.76.1.el7.x86_64/kernel/drivers/virtio/virtio_balloon.ko.xz</span><br><span class="line">license:        GPL</span><br><span class="line">description:    Virtio balloon driver</span><br><span class="line">retpoline:      Y</span><br><span class="line">rhelversion:    7.9</span><br><span class="line">srcversion:     52EDF3EAD03F14A066CA3BC</span><br><span class="line"><span class="built_in">alias</span>:          virtio:d00000005v*</span><br><span class="line">depends:        virtio,virtio_ring</span><br><span class="line">intree:         Y</span><br><span class="line">vermagic:       3.10.0-1160.76.1.el7.x86_64 SMP mod_unload modversions</span><br><span class="line">signer:         CentOS Linux kernel signing key</span><br><span class="line">sig_key:        C6:93:65:52:C5:A1:E9:97:0B:A2:4C:98:1A:C4:51:A6:BC:11:09:B9</span><br><span class="line">sig_hashalgo:   sha256</span><br><span class="line">parm:           oom_pages:pages to free on OOM (int)</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>



<p><code>kvm_stat</code> 命令是一个 python 脚本，通过读取内核的计数器信息，查看虚拟机数据,使用 ctrl+c 或者 q 键退出 kvm stat 命令,使用 x 键，查看 kvmexit 事件的细节</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$kvm_stat</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">kvm statistics - summary</span><br><span class="line"></span><br><span class="line"> Event                                         Total %Total CurAvg/s</span><br><span class="line"> kvm_entry                                      8663   17.3      377</span><br><span class="line"> kvm_exit                                       8663   17.3      377</span><br><span class="line"> kvm_apic                                       6442   12.8      285</span><br><span class="line"> kvm_msr                                        6377   12.7      283</span><br><span class="line"> kvm_hv_timer_state                             6295   12.5      282</span><br><span class="line"> kvm_pv_tlb_flush                               2069    4.1       90</span><br><span class="line"> kvm_inj_virq                                   1960    3.9       85</span><br><span class="line"> kvm_apic_accept_irq                            1960    3.9       85</span><br><span class="line"> kvm_eoi                                        1960    3.9       85</span><br><span class="line"> kvm_pv_eoi                                     1943    3.9       85</span><br><span class="line"> kvm_vcpu_wakeup                                1870    3.7       80</span><br><span class="line"> kvm_fpu                                         402    0.8       20</span><br><span class="line"> kvm_halt_poll_ns                                311    0.6       12</span><br><span class="line"> kvm_msi_set_irq                                 232    0.5       11</span><br><span class="line"> kvm_emulate_insn                                212    0.4       10</span><br><span class="line"> vcpu_match_mmio                                 201    0.4       10</span><br><span class="line"> kvm_userspace_exit                              201    0.4       10</span><br><span class="line"> kvm_mmio                                        201    0.4       10</span><br><span class="line"> kvm_apic_ipi                                     65    0.1        1</span><br><span class="line"> kvm_ack_irq                                      10    0.0        0</span><br><span class="line"> kvm_page_fault                                   83    0.2        0</span><br><span class="line"> kvm_cpuid                                        39    0.1        0</span><br><span class="line"> kvm_fast_mmio                                    11    0.0        0</span><br><span class="line"> kvm_ple_window_update                             2    0.0        0</span><br><span class="line"> kvm_pvclock_update                                1    0.0        0</span><br><span class="line"> Total                                         50173            2198</span><br></pre></td></tr></table></figure>

<h2 id="博文部分内容参考"><a href="#博文部分内容参考" class="headerlink" title="博文部分内容参考"></a>博文部分内容参考</h2><p>© 文中涉及参考链接内容版权归原作者所有，如有侵权请告知，这是一个开源项目，如果你认可它，不要吝啬星星哦 :)</p>
<hr>
<p><a href="#">《 Red Hat Performance Tuning 442 》</a></p>
<hr>
<p>© 2018-2023 <a href="mailto:&#108;&#x69;&#x72;&#117;&#x69;&#x6c;&#x6f;&#x6e;&#103;&#101;&#x72;&#x40;&#x67;&#109;&#97;&#105;&#x6c;&#x2e;&#x63;&#x6f;&#109;">&#108;&#x69;&#x72;&#117;&#x69;&#x6c;&#x6f;&#x6e;&#103;&#101;&#x72;&#x40;&#x67;&#109;&#97;&#105;&#x6c;&#x2e;&#x63;&#x6f;&#109;</a>, All rights reserved. 保持署名-非商用-相同方式共享(CC BY-NC-SA 4.0)</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Linux 性能调优之硬件资源监控</p><p><a href="https://liruilongs.github.io/2023/10/07/待发布/Linux 性能调优之硬件资源监控/">https://liruilongs.github.io/2023/10/07/待发布/Linux 性能调优之硬件资源监控/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="https://liruilongs.github.io"><p>山河已无恙</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2023-10-07</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2023-11-14</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/2023/11/10/%E5%BE%85%E5%8F%91%E5%B8%83/Linux-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E4%B9%8B%E4%BD%BF%E7%94%A8-Tuned-%E9%85%8D%E7%BD%AE%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/" target="_blank">Linux 性能优化之使用 Tuned 配置优化方案</a><br></span><span>  2.<a class="is-size-6" href="/2023/11/09/%E5%BE%85%E5%8F%91%E5%B8%83/Linux-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E5%86%85%E6%A0%B8%E5%8F%AF%E8%B0%83%E5%8F%82%E6%95%B0/" target="_blank">Linux 性能调优之内核可调参数优化</a><br></span><span>  3.<a class="is-size-6" href="/2023/10/17/%E5%BE%85%E5%8F%91%E5%B8%83/Linux-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E8%B5%84%E6%BA%90%E9%99%90%E5%88%B6/" target="_blank">Linux 性能调优之资源限制</a><br></span><span>  4.<a class="is-size-6" href="/2023/10/07/rhca/RH442/Linux%20%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E7%BD%91%E7%BB%9C%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96/" target="_blank">Linux 性能调优之网络内核参数优化</a><br></span><span>  5.<a class="is-size-6" href="/2022/12/06/Linux/What-is-the-difference-between-the-iptables-command-and-iptables-service/" target="_blank">iptables 命令和 iptables.service 服务的区别是上面 ?</a><br></span><span>  6.<a class="is-size-6" href="/2022/12/03/Linux/%E5%85%B3%E4%BA%8E%20Linux%20%E4%B8%AD%20firewalld%20%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86/" target="_blank">关于 Linux 中 firewalld 的一些笔记整理</a><br></span><span>  7.<a class="is-size-6" href="/2022/10/03/%E5%BE%85%E5%8F%91%E5%B8%83/%E3%80%8ALinux-Basics-for-Hackers-Getting-Started-with-Networking-Scripting-and-Security-in-Kali-%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" target="_blank">《Linux Basics for Hackers：Getting Started with Networking, Scripting, and Security in Kali 》读书笔记</a><br></span><span>  8.<a class="is-size-6" href="/2022/09/05/rhca/RH442/%E5%85%B3%E4%BA%8ELinux%E4%B8%AD%E4%BD%BF%E7%94%A8USE(%E4%BD%BF%E7%94%A8%E7%8E%87%E3%80%81%E9%A5%B1%E5%92%8C%E5%BA%A6%E3%80%81%E9%94%99%E8%AF%AF)%E6%96%B9%E6%B3%95%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%E6%80%A7%E8%83%BD%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于Linux中使用USE(使用率/饱和度/错误)方法分析系统性能的一些笔记</a><br></span></div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 推荐文章</span><br><span>  1.<a class="is-size-6" href="/2021/08/27/K8s/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AKubernetes%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97-%E4%BB%8EDocker%E5%88%B0Kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A8%E6%8E%A5%E8%A7%A6%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" target="_blank">《Kubernetes权威指南:从Docker到Kubernetes实践全接触》读书笔记</a><br></span><span>  2.<a class="is-size-6" href="/2022/11/19/Git/%E5%85%B3%E4%BA%8E-Git-%E9%87%8D%E5%86%99%E5%8E%86%E5%8F%B2%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于 Git 重写历史的一些笔记</a><br></span><span>  3.<a class="is-size-6" href="/2022/08/02/Git/%E5%85%B3%E4%BA%8EGit%E5%88%86%E6%94%AF%E5%8F%98%E5%9F%BA%E6%93%8D%E4%BD%9C%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于Git分支变基操作的一些笔记</a><br></span><span>  4.<a class="is-size-6" href="/2022/07/26/Git/%E5%85%B3%E4%BA%8EGit%E5%88%86%E6%94%AF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于Git分支基础知识的一些笔记</a><br></span><span>  5.<a class="is-size-6" href="/2022/08/02/Git/%E5%85%B3%E4%BA%8EGit%E5%88%86%E6%94%AF%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于Git分支工作流的一些笔记</a><br></span><span>  6.<a class="is-size-6" href="/2023/02/19/Git/%E5%85%B3%E4%BA%8EGit%E9%AB%98%E7%BA%A7%E5%90%88%E5%B9%B6%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86/" target="_blank">关于Git分支高级合并的一些笔记整理</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/alipay%EF%BF%A5.png" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/wechat%EF%BF%A5.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2023/10/07/rhca/RH442/Linux%20%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E7%BD%91%E7%BB%9C%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Linux 性能调优之网络内核参数优化</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2023/09/19/%E5%BE%85%E5%8F%91%E5%B8%83/GO%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98%E4%B9%8B%E5%B9%B6%E5%8F%91%E5%92%8C-goroutine/"><span class="level-item">GO语言实战之并发和 goroutine</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><div class="card"><div class="card-content"><div class="title is-5">评论</div><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            language:'zh-CN',
            id: '5ff184878e678bf388c3a205ab5b8792',
            repo: 'blog_comment',
            owner: 'LIRUILONGS',
            clientID: '9fdc9739266d48d5f62e',
            clientSecret: 'c1cc33697d099a2197650ec9dadcb16bd4904655',
            admin: ["LIRUILONGS"],
            createIssueManually: true,
            distractionFreeMode: true,
            perPage: 10,
            pagerDirection: 'last',
            proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token',
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex is-mobile" href="#写在前面"><span class="mr-2">1</span><span>写在前面</span></a></li><li><a class="is-flex is-mobile" href="#硬件信息查看"><span class="mr-2">2</span><span>硬件信息查看</span></a></li><li><a class="is-flex is-mobile" href="#报告硬件错误"><span class="mr-2">3</span><span>报告硬件错误</span></a></li><li><a class="is-flex is-mobile" href="#查看虚拟环境和云环境的资源"><span class="mr-2">4</span><span>查看虚拟环境和云环境的资源</span></a></li><li><a class="is-flex is-mobile" href="#博文部分内容参考"><span class="mr-2">5</span><span>博文部分内容参考</span></a></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class=""><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7.jpg" alt="山河已无恙"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">山河已无恙</p><p class="is-size-6 is-block">爱自己，是终生浪漫的开始</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国·呼和浩特</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">321</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">103</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">154</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://mp.weixin.qq.com/s?__biz=MzkyNjIxNTYwMw==&amp;mid=2247496480&amp;idx=1&amp;sn=a9971fed3962ef2a1aeda1f0bda65f86&amp;chksm=c2380ffcf54f86eaba8daac6caca72a70f38e61a8d25dc2a66d3a17b87c02530e326dcaea14b#rd" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/LIRUILONGS"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="CSDN" href="https://liruilong.blog.csdn.net/"><i class="fa fa-code"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:1224965096@qq.com"><i class="fa fa-envelope"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://liruilong.blog.csdn.net/?t=1&amp;type=blog" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CSDN</span></span><span class="level-right"><span class="level-item tag">liruilong.blog.csdn.net</span></span></a></li><li><a class="level is-mobile" href="https://www.cnblogs.com/liruilong/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">博客园</span></span><span class="level-right"><span class="level-item tag">www.cnblogs.com</span></span></a></li><li><a class="level is-mobile" href="https://github.com/LIRUILONGS" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Githup</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li><li><a class="level is-mobile" href="https://gitee.com/liruilonger" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">码云</span></span><span class="level-right"><span class="level-item tag">gitee.com</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新评论</h3><span class="body_hot_comment">加载中，最新评论有1分钟缓存...</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-12-18T20:39:30.000Z">2023-12-19</time></p><p class="title"><a href="/2023/12/19/%E5%BE%85%E5%8F%91%E5%B8%83/Stable-Diffusion-Windows%E9%83%A8%E7%BD%B2%E7%AE%80%E7%AD%94%E8%AE%A4%E7%9F%A5/">Stable Diffusion 简单认知 Windows 部署</a></p><p class="categories"><a href="/categories/AIGC/">AIGC</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-11-19T19:40:00.000Z">2023-11-20</time></p><p class="title"><a href="/2023/11/20/%E5%BE%85%E5%8F%91%E5%B8%83/Golang%20VScode%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">Golang VScode 开发环境搭建</a></p><p class="categories"><a href="/categories/GO/">GO</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-11-15T12:44:37.000Z">2023-11-15</time></p><p class="title"><a href="/2023/11/15/%E5%BE%85%E5%8F%91%E5%B8%83/%E5%9F%BA%E4%BA%8E%20selenium%20%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%AB%99%E5%9B%BE%E7%89%87%E9%87%87%E9%9B%86/">基于 selenium 实现网站图片采集</a></p><p class="categories"><a href="/categories/selenium/">selenium</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-11-13T20:29:38.000Z">2023-11-14</time></p><p class="title"><a href="/2023/11/14/%E5%BE%85%E5%8F%91%E5%B8%83/%E5%85%B3%E4%BA%8E-Kubernetes%E4%B8%ADAdmission-Controllers-%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/">关于 Kubernetes中Admission Controllers(准入控制器) 认知的一些笔记</a></p><p class="categories"><a href="/categories/Kubernetes/">Kubernetes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-11-13T19:52:18.000Z">2023-11-14</time></p><p class="title"><a href="/2023/11/14/%E5%BE%85%E5%8F%91%E5%B8%83/K8s%20Pod%20%E5%88%9B%E5%BB%BA%E5%9F%8B%E7%82%B9%E5%A4%84%E7%90%86(Mutating%20%20Admission%20Webhook)/">K8s Pod 创建埋点处理(Mutating  Admission Webhook)</a></p><p class="categories"><a href="/categories/Kubernetes/">Kubernetes</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/AIGC/"><span class="level-start"><span class="level-item">AIGC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/AdaFace/"><span class="level-start"><span class="level-item">AdaFace</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ajax/"><span class="level-start"><span class="level-item">Ajax</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ansible/"><span class="level-start"><span class="level-item">Ansible</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/AppCube/"><span class="level-start"><span class="level-item">AppCube</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/BPF/"><span class="level-start"><span class="level-item">BPF</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Bind9/"><span class="level-start"><span class="level-item">Bind9</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CI-CD/"><span class="level-start"><span class="level-item">CI/CD</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CSS/"><span class="level-start"><span class="level-item">CSS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ceph/"><span class="level-start"><span class="level-item">Ceph</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2023/12/"><span class="level-start"><span class="level-item">十二月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/11/"><span class="level-start"><span class="level-item">十一月 2023</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/10/"><span class="level-start"><span class="level-item">十月 2023</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/09/"><span class="level-start"><span class="level-item">九月 2023</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2023/08/"><span class="level-start"><span class="level-item">八月 2023</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Kubernetes/"><span class="tag">Kubernetes</span><span class="tag is-grey-lightest">92</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag is-grey-lightest">34</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ansible/"><span class="tag">Ansible</span><span class="tag is-grey-lightest">25</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ceph/"><span class="tag">Ceph</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Docker/"><span class="tag">Docker</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JAVA/"><span class="tag">JAVA</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go/"><span class="tag">Go</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OpenShift/"><span class="tag">OpenShift</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/"><span class="tag">程序人生</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DNS/"><span class="tag">DNS</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OKD/"><span class="tag">OKD</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/selenium/"><span class="tag">selenium</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%B9%E5%99%A8/"><span class="tag">容器</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C/"><span class="tag">网络</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CKA/"><span class="tag">CKA</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GO/"><span class="tag">GO</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ISCSI/"><span class="tag">ISCSI</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NFS/"><span class="tag">NFS</span><span class="tag is-grey-lightest">3</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="山河已无恙" height="28"></a><p class="size-small"><span>&copy; 2024 山河已无恙</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© <a href="http://www.beian.miit.gov.cn/" target="_blank">备案中</a><br></span><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已运行 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！❤️";
        }var now = new Date();setInterval("createTime('2021/6/26 21:27:00')", 250,"");</script><br></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2364053447" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/katex.min.css"><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/katex.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/contrib/auto-render.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/contrib/mhchem.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdnjs.loli.net/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('9fdc9739266d48d5f62e','c1cc33697d099a2197650ec9dadcb16bd4904655','LIRUILONGS','blog_comment',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(true){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('9fdc9739266d48d5f62e','c1cc33697d099a2197650ec9dadcb16bd4904655','LIRUILONGS','blog_comment',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>