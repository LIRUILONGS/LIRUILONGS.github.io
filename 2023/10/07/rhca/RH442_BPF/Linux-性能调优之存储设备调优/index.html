<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="google-adsense-account" content="ca-pub-5805170532312625"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Linux 性能调优之存储设备调优认知 - 山河已无恙</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="山河已无恙"><meta name="msapplication-TileImage" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="山河已无恙"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="对每个人而言，真正的职责只有一个：找到自我。然后在心中坚守其一生，全心全意，永不停息。所有其它的路都是不完整的，是人的逃避方式，是对大众理想的懦弱回归，是随波逐流，是对内心的恐惧 ——赫尔曼·黑塞《德米安》"><meta property="og:type" content="blog"><meta property="og:title" content="山河已无恙"><meta property="og:url" content="https://mp.weixin.qq.com/s?__biz=MzkyNjIxNTYwMw==&amp;mid=2247496480&amp;idx=1&amp;sn=a9971fed3962ef2a1aeda1f0bda65f86&amp;chksm=c2380ffcf54f86eaba8daac6caca72a70f38e61a8d25dc2a66d3a17b87c02530e326dcaea14b#rd"><meta property="og:site_name" content="山河已无恙"><meta property="og:description" content="对每个人而言，真正的职责只有一个：找到自我。然后在心中坚守其一生，全心全意，永不停息。所有其它的路都是不完整的，是人的逃避方式，是对大众理想的懦弱回归，是随波逐流，是对内心的恐惧 ——赫尔曼·黑塞《德米安》"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://mp.weixin.qq.com/img/头像.jpg"><meta property="article:published_time" content="2023-10-06T23:33:41.000Z"><meta property="article:modified_time" content="2024-11-22T02:19:42.843Z"><meta property="article:author" content="LIRUILONGS"><meta property="article:tag" content="Linux"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/头像.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://liruilongs.github.io/2023/10/07/rhca/RH442_BPF/Linux-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E5%AD%98%E5%82%A8%E8%AE%BE%E5%A4%87%E8%B0%83%E4%BC%98/"},"headline":"山河已无恙","image":["https://img-blog.csdnimg.cn/7ca3417709e84c50ae6bebd8d5ce55dd.png","https://img-blog.csdnimg.cn/direct/d967bf21c9db450a9034f81ad79448ad.png","https://img-blog.csdnimg.cn/direct/8fef224b86bf4c24b183b639747cb18c.png","https://img-blog.csdnimg.cn/direct/b32e748d1b9a4c6caab3438bd6f40899.png","https://img-blog.csdnimg.cn/direct/f45cd63521a24aa5b8a62e7701639445.png","https://img-blog.csdnimg.cn/direct/86b662acab1440a0bbfc9c950fb970d3.png","https://img-blog.csdnimg.cn/direct/81f8c8508bc241fc926ebea51970a3d9.png"],"datePublished":"2023-10-06T23:33:41.000Z","dateModified":"2024-11-22T02:19:42.843Z","author":{"@type":"Person","name":"山河已无恙"},"description":"对每个人而言，真正的职责只有一个：找到自我。然后在心中坚守其一生，全心全意，永不停息。所有其它的路都是不完整的，是人的逃避方式，是对大众理想的懦弱回归，是随波逐流，是对内心的恐惧 ——赫尔曼·黑塞《德米安》"}</script><link rel="canonical" href="https://liruilongs.github.io/2023/10/07/rhca/RH442_BPF/Linux-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E5%AD%98%E5%82%A8%E8%AE%BE%E5%A4%87%E8%B0%83%E4%BC%98/"><link rel="alternate" href="/path/to/atom.xml" title="山河已无恙" type="application/atom+xml"><link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/favicon.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?3f06f2b732a5b1034c989f74e28d0eea";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css"><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="/live2d/waifu.css"><script type="text/javascript" async src="/live2d/autoload.js"></script><meta name="generator" content="Hexo 5.4.2"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="山河已无恙" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/media">影音</a><a class="navbar-item" href="/album">相册</a><a class="navbar-item" href="/friend">友链</a><a class="navbar-item" href="/self-talking">生活小记</a><a class="navbar-item" href="/message">留言墙</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Gitee" href="https://gitee.com/liruilonger"><i class="fab fa-git-square fa-1x"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/LIRUILONGS"><i class="fab fa-github fa-1x"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul fa-1x"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search fa-1x"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon fa-1x" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2023-10-07  <a class="commentCountImg" href="/2023/10/07/rhca/RH442_BPF/Linux-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E5%AD%98%E5%82%A8%E8%AE%BE%E5%A4%87%E8%B0%83%E4%BC%98/#comment-container"><span class="display-none-class">78fb6df005a6eba75bf3a29a5bb409ca</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="78fb6df005a6eba75bf3a29a5bb409ca">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>40 分钟  <i class="fas fa-pencil-alt"> </i>6.0 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">Linux 性能调优之存储设备调优认知</h1><div class="content"><p><strong><font color="009688"> 对每个人而言，真正的职责只有一个：找到自我。然后在心中坚守其一生，全心全意，永不停息。所有其它的路都是不完整的，是人的逃避方式，是对大众理想的懦弱回归，是随波逐流，是对内心的恐惧 ——赫尔曼·黑塞《德米安》</strong></font></p>
<span id="more"></span>
<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><hr>
<ul>
<li>考试整理相关笔记</li>
<li>博文内容涉及，<code>IO调度器</code>，以及IO负载工具 <code>fio</code> 介绍，磁盘整列，IO 分析工具简单介绍</li>
<li>理解不足小伙伴帮忙指正</li>
</ul>
<p><strong><font color="009688"> 对每个人而言，真正的职责只有一个：找到自我。然后在心中坚守其一生，全心全意，永不停息。所有其它的路都是不完整的，是人的逃避方式，是对大众理想的懦弱回归，是随波逐流，是对内心的恐惧 ——赫尔曼·黑塞《德米安》</strong></font></p>
<hr>
<p>固态硬盘正逐步取代磁盘成为存储的标准解决方案，传统磁盘的转速、寻道时间、延迟、机械故障等特点，在新的固态硬盘中已经不复存在。固态硬盘的访问时间在真个设备中是统一的，因此碎片和磁道的优化也不再需要，固态硬盘大小更小、更轻、更节能。</p>
<p>但是固态硬盘也有局限性，比如成本较高。固态硬盘的写入次数有限。</p>
<p>很多传统硬盘的优化不再适用于固态硬盘，<code>红帽不建议在固态硬盘设备使用日志</code>，因为<code>固态磨损增加</code>，并且<code>不必要的双重写入会导致速度缓慢</code>。</p>
<h2 id="选择合适的IO-调度器"><a href="#选择合适的IO-调度器" class="headerlink" title="选择合适的IO 调度器"></a>选择合适的IO 调度器</h2><p><img src="https://img-blog.csdnimg.cn/7ca3417709e84c50ae6bebd8d5ce55dd.png" alt="在这里插入图片描述"></p>
<p>RHEL8开始使用新的<code>多队列I/O调度器</code>来替代之前的<code>单队列调度器</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$cat</span> /sys/block/nvme0n1/queue/scheduler</span><br><span class="line">[none] mq-deadline kyber bfq</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$cat</span> /sys/block/sr0/queue/scheduler</span><br><span class="line">none [mq-deadline] kyber bfq</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<p>调度器分类：</p>
<p><strong>Noop&#x2F;none</strong></p>
<p><code>Noop(none是多队列版本的Noop)</code> 调度算法是 Linux 内核中最简单的 IO 调度算法之一。它也被称为电梯调度算法。Noop 调度算法将 IO 请求放入一个 FIFO（先进先出）队列中，并按顺序执行这些 IO 请求。对于一些在磁盘上连续的 IO 请求，Noop 算法会适当地进行一些合并操作。这个调度算法特别适用于那些<code>不希望调度器重新组织 IO 请求顺序</code>的应用程序。</p>
<p>Noop 调度算法的应用案例包括：</p>
<ul>
<li><code>底层设备比内核调度器更优秀</code>：当底层设备（如 RAID、SAN、NAS 设备）具有自己的高效调度算法时，使用 Noop 算法可以避免重复的调度开销。</li>
<li><code>上层应用比内核调度器更优秀</code>：某些应用程序可能已经实现了自己的 IO 调度逻辑，使用 Noop 算法可以避免与内核调度器的冲突。</li>
<li><code>非旋转磁头的设备</code>：对于不需要磁头寻道的设备（如 SSD），内核调度器的重新组织 IO 请求可能会浪费 CPU 时间，而 Noop 算法可以节省这些开销</li>
</ul>
<p><strong>Deadline&#x2F;mq-deadline</strong></p>
<p>Deadline 调度算法旨在确保每个 IO 请求在一定的时间内得到服务，以避免某个请求饥饿。每个请求都被赋予一个期限值，读请求的默认期限是 500 毫秒，写请求的默认期限是 5 秒。该算法<code>适用于需要保证 IO 响应时间的应用场景</code>。</p>
<p>Deadline应用：一些多线程和数据库的应用适合Deadline算法（业务压力重，功能单一的场景）</p>
<p><code>deadline是单队列，mq（multi-queue）是多队列</code>，核心算法是一样的</p>
<p><strong>CFQ（Completely Fair Queuing）</strong></p>
<p>CFQ 是 Linux 内核默认的 IO 调度算法，它尝试为所有需要 IO 的进程分配请求队列和时间片。每个进程根据其 IO 优先级获得时间片，并在时间片内发送其读写请求给底层块设备。此算法旨在提供公平的 IO 资源分配，<code>适用于多任务环境</code>。</p>
<p>每个进程的时间片和每个进程的队列长度取决于进程的IO优先级，每个进程都会有一个IO优先级。通过ionice可以显示或修改进程的IO优先级！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$man</span> ionice</span><br></pre></td></tr></table></figure>

<p><strong>BFQ（Budget Fair Queueing）</strong></p>
<p>BFQ 算法将以扇区数为单位的预算分配给每个进程，而不是固定的时间片。它旨在提供更精确的 IO 资源分配，避免某些任务占用过多的 IO 资源。BFQ 算法适用于对<code>IO 响应时间要求较高的应用场景</code>。</p>
<p><strong>Kyber</strong></p>
<p>Kyber 调度算法类似于 Noop，它是一种简单的调度算法，不进行显式的调度操作。它对于一些底层设备已经具有高效调度算法的情况下，可以发挥更好的性能。</p>
<blockquote>
<p>注意：NVMe硬盘默认使用none I&#x2F;O调度算法，你不能改变NVMe硬盘的调度算法。</p>
</blockquote>
<h2 id="使用fio工具模拟工作负载"><a href="#使用fio工具模拟工作负载" class="headerlink" title="使用fio工具模拟工作负载"></a>使用fio工具模拟工作负载</h2><p>测试存储系统需要模拟真实的工作负载。fio命令可以通过多进程和多线程模拟各种工作负载情况（实现别发读写数据），包括顺序读写，随机读写以及I&#x2F;O类型。建议通过 &#x2F;usr&#x2F;share&#x2F;doc&#x2F;fio&#x2F;HOWTO来学习fio如何使用。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$dnf</span> provides fio</span><br><span class="line">Last metadata expiration check: 3:13:00 ago on Mon Feb  5 04:06:51 2024.</span><br><span class="line">fio-3.35-1.el9.x86_64 : Multithreaded IO generation tool</span><br><span class="line">Repo        : appstream</span><br><span class="line">Matched from:</span><br><span class="line">Provide    : fio = 3.35-1.el9</span><br><span class="line"></span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$dnf</span> -y install fio</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$rpm</span> -ql fio | grep HOWTO</span><br><span class="line">/usr/share/doc/fio/HOWTO.rst</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$cat</span> $(!!) | grep -i -A 5 <span class="string">&quot;Example output&quot;</span></span><br><span class="line">cat $(rpm -ql fio | grep HOWTO) | grep -i -A 5 <span class="string">&quot;Example output&quot;</span></span><br><span class="line">        Example output was based on the following:</span><br><span class="line">        TZ=UTC fio --iodepth=8 --ioengine=null --size=100M --time_based \</span><br><span class="line">                --rate=1256k --bs=14K --name=quick --runtime=1s --name=mixed \</span><br><span class="line">                --runtime=2m --rw=rw</span><br><span class="line"></span><br><span class="line">Fio spits out a lot of output. While running, fio will display the status of the</span><br><span class="line">--</span><br><span class="line">        Example output was based on the following:</span><br><span class="line">        TZ=UTC fio --iodepth=8 --ioengine=null --size=100M --runtime=58m \</span><br><span class="line">                --time_based --rate=2512k --bs=256K --numjobs=10 \</span><br><span class="line">                --name=readers --rw=<span class="built_in">read</span> --name=writers --rw=write</span><br><span class="line"></span><br><span class="line">Fio will condense the thread string as not to take up more space on the <span class="built_in">command</span></span><br><span class="line">--</span><br><span class="line">        Example output was based on the following:</span><br><span class="line">        TZ=UTC fio --iodepth=16 --ioengine=posixaio --filename=/tmp/fiofile \</span><br><span class="line">                --direct=1 --size=100M --time_based --runtime=50s --rate_iops=89 \</span><br><span class="line">                --bs=7K --name=Client1 --rw=write</span><br><span class="line"></span><br><span class="line">When fio is <span class="keyword">done</span> (or interrupted by :kbd:`Ctrl-C`), it will show the data <span class="keyword">for</span></span><br><span class="line">--</span><br><span class="line">        Example output was based on the following:</span><br><span class="line">        TZ=UTC fio --ioengine=null --iodepth=2 --size=100M --numjobs=2 \</span><br><span class="line">                --rate_process=poisson --io_limit=32M --name=<span class="built_in">read</span> --bs=128k \</span><br><span class="line">                --rate=11M --name=write --rw=write --bs=2k --rate=700k</span><br><span class="line"></span><br><span class="line">After each client has been listed, the group statistics are printed. They</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<p>下面的命令执行随机写操作，将512M数据写入一个指定的文件中，写操作是不使用缓存，采用直接写入硬盘的方式，同时进行2个相同的操作(2个进程或线程）。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$fio</span> --name=randwrite --ioengine=libaio --iodepth=1 --rw=randwrite --bs=4K --direct=1 --size=512M --numjobs=2 --group_reporting --filename=/tmp/testfile</span><br><span class="line">randwrite: (g=0): rw=randwrite, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=libaio, iodepth=1</span><br><span class="line">...</span><br><span class="line">fio-3.35</span><br><span class="line">Starting 2 processes</span><br><span class="line">Jobs: 2 (f=2): [w(2)][95.7%][w=41.9MiB/s][w=10.7k IOPS][eta 00m:01s]</span><br><span class="line">randwrite: (groupid=0, <span class="built_in">jobs</span>=2): err= 0: pid=20196: Mon Feb  5 07:28:25 2024</span><br><span class="line">  write: IOPS=11.5k, BW=44.9MiB/s (47.1MB/s)(1024MiB/22803msec); 0 zone resets</span><br><span class="line">    slat (usec): min=12, max=3836, avg=23.81, stdev=27.13</span><br><span class="line">    clat (nsec): min=1709, max=6549.7k, avg=148047.50, stdev=154937.29</span><br><span class="line">     lat (usec): min=69, max=6587, avg=171.85, stdev=164.42</span><br><span class="line">    clat percentiles (usec):</span><br><span class="line">     |  1.00th=[   80],  5.00th=[   84], 10.00th=[   86], 20.00th=[   90],</span><br><span class="line">     | 30.00th=[   94], 40.00th=[   99], 50.00th=[  106], 60.00th=[  117],</span><br><span class="line">     | 70.00th=[  131], 80.00th=[  153], 90.00th=[  221], 95.00th=[  318],</span><br><span class="line">     | 99.00th=[  898], 99.50th=[ 1123], 99.90th=[ 1696], 99.95th=[ 2008],</span><br><span class="line">     | 99.99th=[ 3097]</span><br><span class="line">   bw (  KiB/s): min=18528, max=64600, per=99.77%, avg=45878.96, stdev=6563.89, samples=90</span><br><span class="line">   iops        : min= 4632, max=16150, avg=11469.69, stdev=1641.01, samples=90</span><br><span class="line">  lat (usec)   : 2=0.01%, 4=0.06%, 10=0.02%, 20=0.01%, 50=0.02%</span><br><span class="line">  lat (usec)   : 100=42.05%, 250=49.94%, 500=4.86%, 750=1.42%, 1000=0.92%</span><br><span class="line">  lat (msec)   : 2=0.64%, 4=0.05%, 10=0.01%</span><br><span class="line">  cpu          : usr=2.16%, sys=9.33%, ctx=270388, majf=0, minf=26</span><br><span class="line">  IO depths    : 1=100.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;=64=0.0%</span><br><span class="line">     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%</span><br><span class="line">     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%</span><br><span class="line">     issued rwts: total=0,262144,0,0 short=0,0,0,0 dropped=0,0,0,0</span><br><span class="line">     latency   : target=0, window=0, percentile=100.00%, depth=1</span><br><span class="line"></span><br><span class="line">Run status group 0 (all <span class="built_in">jobs</span>):</span><br><span class="line">  WRITE: bw=44.9MiB/s (47.1MB/s), 44.9MiB/s-44.9MiB/s (47.1MB/s-47.1MB/s), io=1024MiB (1074MB), run=22803-22803msec</span><br><span class="line"></span><br><span class="line">Disk stats (<span class="built_in">read</span>/write):</span><br><span class="line">    dm-0: ios=0/259699, merge=0/0, ticks=0/38126, in_queue=38126, util=99.67%, aggrios=0/262144, aggrmerge=0/0, aggrticks=0/40150, aggrin_queue=40150, aggrutil=99.56%</span><br><span class="line">  nvme0n1: ios=0/262144, merge=0/0, ticks=0/40150, in_queue=40150, util=99.56%</span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>

<ul>
<li><code>randwrite</code>：测试名称。</li>
<li><code>rw=randwrite</code>：读写模式为随机写入。</li>
<li><code>bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B</code>：读取和写入的块大小都是 4096 字节。</li>
<li><code>ioengine=libaio</code>：使用 libaio 作为 I&#x2F;O 引擎。</li>
<li><code>iodepth=1</code>：I&#x2F;O 深度为 1。</li>
<li><code>write: IOPS=11.5k, BW=44.9MiB/s</code>：写入操作的 IOPS（每秒输入&#x2F;输出操作数）为 11,500，带宽为 44.9 MiB&#x2F;s（兆字节&#x2F;秒）。</li>
<li><code>slat</code>：写入操作的起始时间统计。</li>
<li><code>clat</code>：写入操作的完成时间统计。</li>
<li><code>lat</code>：写入操作的总体响应时间统计。</li>
<li><code>bw</code>：写入操作的带宽统计。</li>
<li><code>iops</code>：写入操作的 IOPS 统计。</li>
<li><code>cpu</code>：CPU 使用情况统计。</li>
<li><code>IO depths</code>：不同 I&#x2F;O 深度的统计。</li>
<li><code>Run status group 0 (all jobs)</code>：运行状态的总结信息。</li>
<li><code>WRITE: bw=44.9MiB/s (47.1MB/s), 44.9MiB/s-44.9MiB/s (47.1MB/s-47.1MB/s), io=1024MiB (1074MB), run=22803-22803msec</code>：写入操作的带宽和持续时间统计。</li>
<li><code>Disk stats (read/write)</code>：磁盘的读写统计信息。</li>
</ul>
<h2 id="磁盘阵列"><a href="#磁盘阵列" class="headerlink" title="磁盘阵列"></a>磁盘阵列</h2><p>磁盘阵列是一种虚拟化存储技术，将多个磁盘组成一个大的磁盘，利用同步写入到这些磁盘的技术，不但可以加快读写速度，而且支持数据恢复（需要有冗余数据）。</p>
<p>RAID会将数据打散成很多小数据块，这些数据块会被写入阵列中的不同磁盘。这些数据需要满足一个或多个策略需求：数据条带化、数据镜像化、数据校验。</p>
<p><code>数据条带化</code>将数据划分为条带，这些条带分布在RAID阵列内的多个磁盘中。</p>
<p><code>数据镜像</code>提供了将条带复制到至少两个不同RAID磁盘得冗余性。数据奇偶校验通过将奇偶校验添加到条带来支持数据冗余，因此与相同数据量相关的其他条带可以使用工作数据及其相关的</p>
<p><code>RAID 0</code>：<code>数据条带化（Striping）</code>，没有冗余。通过将数据分割成条带并在多个磁盘之间分布存储，提高了吞吐量，但没有<code>冗余备份</code>。适用于需要<code>高性能和较低成本</code>的应用，但不提供<code>故障容错</code>能力。</p>
<p><img src="https://img-blog.csdnimg.cn/direct/d967bf21c9db450a9034f81ad79448ad.png" alt="在这里插入图片描述"></p>
<ul>
<li>磁盘要求：至少需要两个磁盘。</li>
<li>容错能力：没有冗余，任何一个磁盘故障都会导致数据丢失。</li>
</ul>
<p><code>RAID 1</code>：<code>数据镜像（Data Mirroring）</code>。通过将数据复制到<code>至少两个不同的 RAID 磁盘上</code>，<code>提供冗余备份</code>。当一个磁盘故障时，仍然可以从镜像磁盘读取数据。数据冗余和读取冗余带来了更高的数据可靠性，但写入性能略有降低。</p>
<p><img src="https://img-blog.csdnimg.cn/direct/8fef224b86bf4c24b183b639747cb18c.png" alt="在这里插入图片描述"></p>
<ul>
<li>磁盘要求：至少需要两个磁盘。</li>
<li>容错能力：可以容忍一个磁盘故障，因为数据被镜像到其他磁盘上。</li>
</ul>
<p><code>RAID 4</code>：<code>基于块的条带化</code>，带有<code>专用奇偶校验磁盘</code>。类似于 <code>RAID 0</code>，但额外使用了一个专用的奇偶校验磁盘来<code>存储奇偶校验信息</code>。该奇偶校验信息用于<code>恢复任何一个数据块</code>，从而提供了故障容错能力。</p>
<p><img src="https://img-blog.csdnimg.cn/direct/b32e748d1b9a4c6caab3438bd6f40899.png" alt="在这里插入图片描述"></p>
<ul>
<li>磁盘要求：至少需要三个磁盘。</li>
<li>容错能力：可以容忍一个磁盘故障，因为有一个专用的奇偶校验磁盘。</li>
</ul>
<p><code>RAID 5</code>：基于块的条带化，带有<code>分布式奇偶校验</code>。类似于 <code>RAID 4</code>，但奇偶校验信息分布在所有磁盘上，而不是单独的奇偶校验磁盘上。这种分布式奇偶校验提供了更好的性能和容错能力。</p>
<p><img src="https://img-blog.csdnimg.cn/direct/f45cd63521a24aa5b8a62e7701639445.png" alt="在这里插入图片描述"></p>
<ul>
<li>磁盘要求：至少需要三个磁盘。</li>
<li>容错能力：可以容忍一个磁盘故障，因为奇偶校验信息分布在所有磁盘上。</li>
</ul>
<p><code>RAID 6</code>：基于块的条带化，带有<code>双重分布式奇偶校验</code>。类似于 <code>RAID 5</code>，但提供了更高的<code>冗余度</code>。使用两个奇偶校验计算来提供更高级别的容错能力，即使在<code>两个磁盘故障</code>的情况下，也能够<code>恢复数据</code>。</p>
<p><img src="https://img-blog.csdnimg.cn/direct/86b662acab1440a0bbfc9c950fb970d3.png" alt="在这里插入图片描述"></p>
<ul>
<li>磁盘要求：至少需要四个磁盘。</li>
<li>容错能力：可以容忍两个磁盘故障，因为使用了双重分布式奇偶校验。</li>
</ul>
<p><code>RAID 10</code>：镜像的条带化。将数据分成条带并在多个磁盘上进行镜像。提供了数据冗余和高性能的组合。数据被同时写入多个磁盘，提供了冗余备份和更快的读取性能。</p>
<ul>
<li>磁盘要求：至少需要四个磁盘。</li>
<li>容错能力：可以容忍多个磁盘故障，具体取决于故障发生在哪个镜像组上</li>
</ul>
<h3 id="创建软RAID"><a href="#创建软RAID" class="headerlink" title="创建软RAID"></a>创建软RAID</h3><p>mdadm 是一个用于管理 Linux 软件 RAID 的工具。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//创建RAID，-l指定级别</span><br><span class="line">[root@localhost ~]<span class="comment"># mdadm  -C  /dev/md0  -l  raid0  -n  2  /dev/vd[b-c]1</span></span><br><span class="line">//停止使用RAID</span><br><span class="line">[root@localhost ~]<span class="comment"># mdadm  --stop  /dev/md0</span></span><br><span class="line">//删除RAID</span><br><span class="line">[root@localhost ~]<span class="comment"># mdadm  --remove  /dev/md0</span></span><br><span class="line">//将原来RAID硬盘中的数据清零</span><br><span class="line">[root@localhost ~]<span class="comment"># mdadm  --zero-superblock  /dev/vdb</span></span><br><span class="line">[root@localhost ~]<span class="comment"># mdadm  --zero-superblock   /dev/vdc</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>创建好RAID之后，最好在格式化文件系统的时候，让文件系统和RAID数据<code>分块</code>保持一致。我们需要先了解一下这些信息：</p>
<p><code>Chunk Size（块大小）</code>：Chunk 是 RAID 中的最小数据单元，决定了数据如何在磁盘上进行分割和存储。较小的块大小可以提供更好的性能，因为数据可以更细粒度地分布在多个磁盘上。然而，小块大小可能会增加磁盘开销和额外的存储空间。较大的块大小可以提供更高的数据传输效率，但在故障恢复时可能需要恢复更多的数据。</p>
<p><code>Number of Disks（磁盘数量）</code>：磁盘数量决定了 RAID 中可用于存储数据的物理磁盘数量。增加磁盘数量可以提高性能和存储容量。更多的磁盘可以提供更多的并行性，从而提高数据传输速度。但同时，也意味着更多的磁盘故障可能会导致数据丢失。</p>
<p><code>Number of Parity Disks（奇偶校验磁盘数量）</code>：奇偶校验磁盘用于存储冗余信息，以实现数据的容错能力。在 RAID 4、RAID 5 和 RAID 6 级别中，需要指定奇偶校验磁盘的数量。增加奇偶校验磁盘的数量可以提供更高的容错能力，因为更多的磁盘故障可以被容忍。然而，每个奇偶校验磁盘都会增加额外的存储开销。</p>
<p>对于XFS文件系统，格式化的时候可以使用<code>su和sw</code>选项指定<code>RAID的chunk size和number of data disk</code>，保持一致。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs  -t  xfs  -d  su=64k,sw=4   /dev/san/lun1</span><br></pre></td></tr></table></figure>

<p>对于ext4文件系统而言，我们需要掌握除了上面的信息还需要：</p>
<p><code>文件系统块大小(block size)</code>：文件系统块大小是文件系统使用的最小数据单元。它决定了文件在存储介质上的最小分配单位。较小的块大小可以提供更好的空间利用率，但在处理大文件时可能会增加磁盘开销。较大的块大小可以提高顺序读写的性能，但可能会导致对小文件的空间浪费。</p>
<p>使用这些信息可以计算<code>stride和stride-width</code>的值</p>
<p><code>stride是一个chunk中包含多少个文件系统block</code>。比如对于<code>64KiB</code>的<code>chunk</code>磁盘阵列，如果文件系统<code>block</code>大小为<code>4KiB</code>，则stride&#x3D;16。</p>
<p><code>strip-width是一个条带中包含多少文件系统block</code>。</p>
<blockquote>
<p>比如一个6块硬盘组成的RAID6，在RAID6中每个条带包含2个校验盘，所以就有<code>6-2=4</code>块数据盘，一个条带有4个数据盘。这一个条带包含多少个文件系统block呢？<br>4（disk）* 16（stride） &#x3D; 64 file system blocks per stripe。<br>4个硬盘代表4个chunk，每个chunk可以包含16个block，所以一个条带包含64个文件系统块。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mkfs  -t  ext4   -E  stride=16,stripe-width=64   /dev/san/lun1</span></span><br></pre></td></tr></table></figure>

<h3 id="通过逻辑卷配置RAID"><a href="#通过逻辑卷配置RAID" class="headerlink" title="通过逻辑卷配置RAID"></a>通过逻辑卷配置RAID</h3><p>RHEL8支持创建RAID级别的逻辑卷，目前支持RAID0,1,4,5,6, and 10</p>
<p>创建一个3G容量的RAID0级别逻辑卷，</p>
<ul>
<li><code>--stripes 3</code>: 这指定了要使用的条带数（即磁盘数量）为3。在RAID 0中，这意味着数据将被分割成3部分并分别存储在3个磁盘上。</li>
<li><code>--stripesize 4K</code>: 这指定了每个条带的大小为4KB。这意味着每个磁盘上将存储4KB的数据块。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># lvcreate  --type  raid0   -L 3G  --stripes 3  --stripesize 4K  -n raidlv radivg</span></span><br></pre></td></tr></table></figure>

<h2 id="选择IO分析工具"><a href="#选择IO分析工具" class="headerlink" title="选择IO分析工具"></a>选择IO分析工具</h2><p>最简单的工具是使用<code>top命令观察wa值</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$top</span></span><br><span class="line">top - 10:52:58 up 10:41,  2 users,  load average: 0.00, 0.00, 0.00</span><br><span class="line">Tasks: 231 total,   1 running, 230 sleeping,   0 stopped,   0 zombie</span><br><span class="line">%Cpu0  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu1  :  0.0 us, 25.0 sy,  0.0 ni, 75.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">MiB Mem :  15694.3 total,  14350.9 free,    910.1 used,    730.8 buff/cache</span><br><span class="line">MiB Swap:   2048.0 total,   2048.0 free,      0.0 used.  14784.3 avail Mem</span><br></pre></td></tr></table></figure>

<h3 id="iostat"><a href="#iostat" class="headerlink" title="iostat"></a>iostat</h3><p>使用iostat命令输出了设备I&#x2F;O统计信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$yum</span> -y install sysstat</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$ iostat -Np</span><br><span class="line">Linux 5.14.0-362.8.1.el9_3.x86_64 (liruilongs.github.io)        02/05/24        _x86_64_        (2 CPU)</span><br><span class="line"></span><br><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">           0.14    0.01    0.22    0.01    0.00   99.63</span><br><span class="line"></span><br><span class="line">Device             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd</span><br><span class="line">nvme0n1          14.28        13.25        67.45         0.00     511266    2602804          0</span><br><span class="line">nvme0n1p1         0.02         1.51         0.06         0.00      58182       2130          0</span><br><span class="line">nvme0n1p2        14.26        11.71        67.39         0.00     451888    2600674          0</span><br><span class="line">sr0               0.00         0.08         0.00         0.00       2936          0          0</span><br><span class="line">rl-root          14.36        11.17        67.39         0.00     431044    2600674          0</span><br><span class="line">rl-swap           0.00         0.06         0.00         0.00       2220          0          0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$</span><br></pre></td></tr></table></figure>
<h3 id="iotop"><a href="#iotop" class="headerlink" title="iotop"></a>iotop</h3><p>iotop 监控Linux系统中的磁盘I&#x2F;O使用状况,实时显示系统中各个进程对I&#x2F;O的使用情况。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$yum</span> -y install iotop</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Total DISK READ :       0.00 B/s | Total DISK WRITE :       0.00 B/s</span><br><span class="line">Actual DISK READ:       0.00 B/s | Actual DISK WRITE:       0.00 B/s</span><br><span class="line">    TID  PRIO  USER     DISK READ DISK WRITE&gt;    COMMAND                                                                                                                      1 be/4 root        0.00 B/s    0.00 B/s systemd --switched-root --system --deserialize 31</span><br><span class="line">      2 be/4 root        0.00 B/s    0.00 B/s [kthreadd]</span><br><span class="line">      3 be/0 root        0.00 B/s    0.00 B/s [rcu_gp]</span><br><span class="line">      4 be/0 root        0.00 B/s    0.00 B/s [rcu_par_gp]</span><br><span class="line">      5 be/0 root        0.00 B/s    0.00 B/s [slub_flushwq]</span><br><span class="line">      6 be/0 root        0.00 B/s    0.00 B/s [netns]</span><br><span class="line">      8 be/0 root        0.00 B/s    0.00 B/s [kworker/0:0H-events_highpri]</span><br><span class="line">      ...................................</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-o(--only)</code>仅显示当前执行I&#x2F;O操作的进程和线程信息</li>
<li><code>-P(--processes)</code>显示进程信息</li>
<li><code>-a</code>显示启动iotop命令开始的总的I&#x2F;O数据信息</li>
</ul>
<h3 id="Blktrace"><a href="#Blktrace" class="headerlink" title="Blktrace"></a>Blktrace</h3><p><code>Blktrace</code>是一个针对Linux内核中Block IO的跟踪工具，它能够记录I&#x2F;O所经历的各个步骤，并从中分析<code>是IO Scheduler慢还是硬件响应慢</code>。这个工具可以在运行时捕获和记录块设备上的I&#x2F;O操作，并提供详细的<code>I/O请求队列信息</code>，包括读写进程名、进程号、执行时间、读写物理块号、块大小等。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install blktrace</span><br></pre></td></tr></table></figure>

<p>开始采集</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─$ blktrace -d /dev/mapper/rl-root -o disk.log</span><br><span class="line">User defined signal 1</span><br></pre></td></tr></table></figure>
<p>结束</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$killall</span> -SIGUSR1 blktrace</span><br></pre></td></tr></table></figure>
<p>模拟测试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$fio</span> --name=randwrite --ioengine=libaio --iodepth=1 --rw=randwrite --bs=4K --direct=1 --size=512M --numjobs=5 --group_reporting --filename=/tmp/testfile</span><br><span class="line">randwrite: (g=0): rw=randwrite, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=libaio, iodepth=1</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">┌──[root@liruilongs.github.io]-[~]</span><br><span class="line">└─<span class="variable">$btt</span> -i disk.log.blktrace.0</span><br><span class="line">==================== All Devices ====================</span><br><span class="line"></span><br><span class="line">            ALL           MIN           AVG           MAX           N</span><br><span class="line">--------------- ------------- ------------- ------------- -----------</span><br><span class="line">Q2Qdm             0.000001070   0.000257360  17.654174647      655292</span><br><span class="line">Q2Cdm             0.000054524   0.000268875   0.089907542      655281</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">==================== Device Overhead ====================</span><br><span class="line"></span><br><span class="line">       DEV |       Q2G       G2I       Q2M       I2D       D2C</span><br><span class="line">---------- | --------- --------- --------- --------- ---------</span><br><span class="line"></span><br><span class="line">==================== Device Merge Information ====================</span><br><span class="line"></span><br><span class="line">       DEV |       <span class="comment">#Q       #D   Ratio |   BLKmin   BLKavg   BLKmax    Total</span></span><br><span class="line">---------- | -------- -------- ------- | -------- -------- -------- --------</span><br><span class="line"></span><br><span class="line">==================== Device Q2Q Seek Information ====================</span><br><span class="line"></span><br><span class="line">       DEV |          NSEEKS            MEAN          MEDIAN | MODE</span><br><span class="line">---------- | --------------- --------------- --------------- | ---------------</span><br><span class="line"> (253,  0) |          655293        362399.7               0 | 0(1798)</span><br><span class="line">---------- | --------------- --------------- --------------- | ---------------</span><br><span class="line">   Overall |          NSEEKS            MEAN          MEDIAN | MODE</span><br><span class="line">   Average |          655293        362399.7               0 | 0(1798)</span><br><span class="line">   ......................................</span><br></pre></td></tr></table></figure>

<h3 id="pcp-system-tools"><a href="#pcp-system-tools" class="headerlink" title="pcp-system-tools"></a>pcp-system-tools</h3><p>pcp-system-tools是一个用于监控系统性能的工具包，它提供了多种用于监控系统资源使用情况的工具。这个工具包与pcp（Performance Co-Pilot）框架一起使用，可以提供全面的系统性能监控解决方案。</p>
<p><img src="https://img-blog.csdnimg.cn/direct/81f8c8508bc241fc926ebea51970a3d9.png" alt="在这里插入图片描述"></p>
<p>atop提供了对系统资源使用情况的全面视图，包括CPU、内存、磁盘I&#x2F;O、网络等。它还提供了各种性能指标的实时和历史数据，以及对系统进程和资源的详细信息。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ATOP - liruilongs                                2024/02/05  11:17:45                                -----------------                                  11h6m20s elapsedPRC |  sys    0.04s |  user   0.01s  | <span class="comment">#proc    243  |  #trun      1 |  #tslpi   142  | #tslpu   100  | #zombie    0  |  clones     1 |                | #exit      0  |CPU |  sys       0% |  user      0%  | irq       0%  |               |  idle    199%  | wait      0%  | steal     0%  |  guest     0% |                | curf 2.42GHz  |cpu |  sys       0% |  user      0%  | irq       0%  |               |  idle     99%  | cpu001 w  0%  | steal     0%  |  guest     0% |                |   |</span></span><br><span class="line">cpu |  sys       0% |  user      0%  | irq       0%  |               |  idle    100%  | cpu000 w  0%  | steal     0%  |  guest     0% |                |   |</span><br><span class="line">CPL |  numcpu     2 |                | avg1    0.19  |               |  avg5    0.35  | avg15   0.19  |               |  csw     2498 |                | intr    1299  |MEM |  tot    15.3G |  free   13.8G  | cache 838.3M  |  dirty   0.0M |  buff    1.7M  | slab  171.2M  | slrec  87.1M  |               |  pgtab   1.7M  |               |MEM |  numnode    1 |                | shmem  15.2M  |  shrss   0.0M |  shswp   0.0M  | tcpsk   0.0M  | udpsk   0.0M  |               |                | zfarc   0.0M  |SWP |  tot     2.0G |  free    2.0G  | swcac   0.0M  |  zpool   0.0M |  zstor   0.0M  | ksuse   0.0M  | kssav   0.0M  |               |  vmcom   3.5G  | vmlim   9.7G  |PAG |  scan       0 |  steal      0  | compact    0  |  numamig    0 |  migrate    0  | pgin       0  | pgout     64  |  swin       0 |  swout      0  | oomkill    0  |LVM |       rl-root |  busy      0%  | <span class="built_in">read</span>       0  |  write      5 |  discrd     0  | KiB/r      0  | KiB/w     12  |  MBr/s    0.0 |  MBw/s    0.0  | avio  0.0 ns  |</span><br><span class="line">DSK |       nvme0n1 |  busy      0%  | <span class="built_in">read</span>       0  |  write      5 |  discrd     0  | KiB/r      0  | KiB/w     12  |  MBr/s    0.0 |  MBw/s    0.0  | avio 0.80 ms  |</span><br><span class="line">NET |  transport    |  tcpi       2  | tcpo       6  |  udpi       0 |  udpo       0  | tcpao      0  | tcppo      0  |  tcprs      0 |  tcpie      0  | udpie      0  |NET |  network      |  ipi        2  | ipo        4  |  ipfrw      0 |  deliv      2  |               |               |               |  icmpi      0  | icmpo      0  |NET |  ens160    0% |  pcki       2  | pcko       6  |  sp   10 Gbps |  si    0 Kbps  | so    0 Kbps  | erri       0  |  erro       0 |  drpi       0  | drpo       0  |</span><br><span class="line"></span><br><span class="line">    PID   SYSCPU    USRCPU    RDELAY    BDELAY    VGROW     RGROW     RDDSK     WRDSK   RUID        EUID        ST    EXC    THR    S    CPUNR     CPU   CMD         1/1  21939    0.02s     0.01s     0.00s     0.00s   416.0K    348.0K        0B        0B   root        root        --      -      1    R        1      0%   pmdaproc</span><br><span class="line">  21987    0.01s     0.00s     0.00s     0.00s     2.5M      2.4M        0B        0B   root        root        --      -      1    S        1      0%   pcp-atop         21100    0.01s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    I        1      0%   kworker/1:2-ev</span><br><span class="line">    850    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    S        0      0%   /usr/sbin/http</span><br><span class="line">    862    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    S        1      0%   php-fpm</span><br><span class="line">  21065    0.00s     0.00s     0.01s     0.00s       0B        0B        0B        0B   root        root        --      -      3    S        0      0%   blktrace</span><br><span class="line">      1    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    S        1      0%   systemd</span><br><span class="line">  21934    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   pcp         pcp         --      -      1    S        0      0%   pmcd</span><br><span class="line">  21941    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    S        1      0%   pmdalinux        21094    0.00s     0.00s     0.00s     0.00s       0B    712.0K        0B        0B   liruilon    liruilon    --      -      1    S        0      0%   sshd</span><br><span class="line">    801    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      2    S        0      0%   irqbalance        1929    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    I        1      0%   kworker/u256:0</span><br><span class="line">     16    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    S        0      0%   pr/tty0             17    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    I        1      0%   rcu_preempt      20419    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    I        0      0%   kworker/0:2-ev</span><br><span class="line">    500    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    S        0      0%   scsi_eh_21</span><br><span class="line">     25    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    S        1      0%   ksoftirqd/1</span><br><span class="line">     37    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    S        1      0%   kcompactd0</span><br><span class="line">     56    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    I        0      0%   kthrotld            98    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    I        1      0%   kworker/1:1H-k</span><br><span class="line">    649    0.00s     0.00s     0.01s     0.00s       0B        0B        0B        0B   root        root        --      -      1    S        0      0%   xfsaild/dm-0</span><br><span class="line">  21803    0.00s     0.00s     0.00s     0.00s       0B        0B        0B        0B   root        root        --      -      1    I        0      0%   kworker/u256:3 </span><br></pre></td></tr></table></figure>


<h2 id="博文部分内容参考"><a href="#博文部分内容参考" class="headerlink" title="博文部分内容参考"></a>博文部分内容参考</h2><p>© 文中涉及参考链接内容版权归原作者所有，如有侵权请告知，这是一个开源项目，如果你认可它，不要吝啬星星哦 :)</p>
<hr>
<p><a href="#">《 Red Hat Performance Tuning 442 》</a></p>
<hr>
<p>© 2018-至今 <a href="mailto:&#x6c;&#x69;&#114;&#117;&#105;&#x6c;&#x6f;&#x6e;&#x67;&#101;&#114;&#64;&#x67;&#x6d;&#97;&#x69;&#108;&#x2e;&#99;&#x6f;&#x6d;">&#x6c;&#x69;&#114;&#117;&#105;&#x6c;&#x6f;&#x6e;&#x67;&#101;&#114;&#64;&#x67;&#x6d;&#97;&#x69;&#108;&#x2e;&#99;&#x6f;&#x6d;</a>, All rights reserved. 保持署名-非商用-相同方式共享(CC BY-NC-SA 4.0)</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Linux 性能调优之存储设备调优认知</p><p><a href="https://liruilongs.github.io/2023/10/07/rhca/RH442_BPF/Linux-性能调优之存储设备调优/">https://liruilongs.github.io/2023/10/07/rhca/RH442_BPF/Linux-性能调优之存储设备调优/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="https://liruilongs.github.io"><p>山河已无恙</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2023-10-07</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2024-11-22</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/2025/05/26/%E5%BE%85%E5%8F%91%E5%B8%83/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-BPF-%E5%88%86%E6%9E%90-Linux-%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%EF%BC%8CLinux-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B-BPF-%E5%88%86%E6%9E%90%E5%86%85%E6%A0%B8%E6%80%81%E3%80%81%E7%94%A8%E6%88%B7%E6%80%81%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2/" target="_blank">如何使用 BPF 分析 Linux 内存泄漏，Linux 性能调优之 BPF 分析内核态、用户态内存泄漏</a><br></span><span>  2.<a class="is-size-6" href="/2025/04/18/%E5%BE%85%E5%8F%91%E5%B8%83/%E8%AE%A4%E8%AF%86%20Linux%20%E5%86%85%E5%AD%98%E6%9E%84%E6%88%90%EF%BC%9ALinux%20%E5%86%85%E5%AD%98%E8%B0%83%E4%BC%98%E4%B9%8B%E9%A1%B5%E8%A1%A8%E3%80%81TLB%E3%80%81%E5%A4%A7%E9%A1%B5%E8%AE%A4%E7%9F%A5/" target="_blank">认识 Linux 内存构成：Linux 内存调优之页表、TLB、缺页异常、大页认知</a><br></span><span>  3.<a class="is-size-6" href="/2025/04/11/%E5%BE%85%E5%8F%91%E5%B8%83/Linux%20%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AD%98%E7%9B%91%E6%8E%A7%EF%BC%9ALinux%20%E5%86%85%E5%AD%98%E8%B0%83%E4%BC%98%E4%B9%8B%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AD%98%E5%85%A8%E9%9D%A2%E7%9B%91%E6%8E%A7/" target="_blank">Linux 系统内存监控：Linux 内存调优之系统内存全面监控</a><br></span><span>  4.<a class="is-size-6" href="/2025/04/11/%E5%BE%85%E5%8F%91%E5%B8%83/Linux-%E8%BF%9B%E7%A8%8B%E5%86%85%E5%AD%98%E7%9B%91%E6%8E%A7%EF%BC%9ALinux-%E5%86%85%E5%AD%98%E8%B0%83%E4%BC%98%E4%B9%8B%E8%BF%9B%E7%A8%8B%E5%86%85%E5%AD%98%E6%B7%B1%E5%BA%A6%E7%9B%91%E6%8E%A7/" target="_blank">Linux 进程内存监控：Linux 内存调优之进程内存深度监控</a><br></span><span>  5.<a class="is-size-6" href="/2025/04/10/%E5%BE%85%E5%8F%91%E5%B8%83/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%20eBPF%20%E7%9B%91%E6%8E%A7%20Linux%20%E5%86%85%E5%AD%98%20OOM%20killer%EF%BC%9ALinux%20%E5%86%85%E5%AD%98%E8%B0%83%E4%BC%98%E4%B9%8B%20eBPF%20%E7%9B%91%E6%8E%A7%E5%86%85%E5%AD%98%20OOM%20killer%20%E4%BA%8B%E4%BB%B6/" target="_blank">如何使用 eBPF 监控 Linux 内存 OOM killer：Linux 内存调优之 eBPF 监控内存 OOM killer 事件</a><br></span><span>  6.<a class="is-size-6" href="/2025/04/08/%E5%BE%85%E5%8F%91%E5%B8%83/%E8%AE%A4%E8%AF%86%20Linux%20%E5%86%85%E5%AD%98%E6%9E%84%E6%88%90%EF%BC%9ALinux%20%E5%86%85%E5%AD%98%E8%B0%83%E4%BC%98%E4%B9%8B%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E4%B8%8E%E7%89%A9%E7%90%86%E5%86%85%E5%AD%98/" target="_blank">认识 Linux 内存构成：Linux 内存调优之虚拟内存与物理内存</a><br></span><span>  7.<a class="is-size-6" href="/2025/04/07/rhca/RH442_BPF/CPU/Linux%20%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8BCPU%E8%B0%83%E4%BC%98%E8%AE%A4%E7%9F%A5/" target="_blank">Linux 性能调优之CPU调优认知</a><br></span><span>  8.<a class="is-size-6" href="/2024/08/23/rhca/RH442_BPF/CPU/Linux%20%E6%80%A7%E8%83%BD%E8%A7%82%E6%B5%8B%E4%B9%8B%E5%B9%B3%E5%9D%87%E8%B4%9F%E8%BD%BD/" target="_blank">Linux 性能观测之平均负载</a><br></span></div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 推荐文章</span><br><span>  1.<a class="is-size-6" href="/2021/08/27/K8s/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AKubernetes%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97-%E4%BB%8EDocker%E5%88%B0Kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A8%E6%8E%A5%E8%A7%A6%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" target="_blank">《Kubernetes权威指南:从Docker到Kubernetes实践全接触》读书笔记</a><br></span><span>  2.<a class="is-size-6" href="/2024/10/10/Git/Git-%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81-reference-broken-%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/" target="_blank">Git 提交代码 reference broken 问题处理</a><br></span><span>  3.<a class="is-size-6" href="/2022/11/19/Git/%E5%85%B3%E4%BA%8E-Git-%E9%87%8D%E5%86%99%E5%8E%86%E5%8F%B2%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于 Git 重写历史的一些笔记</a><br></span><span>  4.<a class="is-size-6" href="/2022/08/02/Git/%E5%85%B3%E4%BA%8EGit%E5%88%86%E6%94%AF%E5%8F%98%E5%9F%BA%E6%93%8D%E4%BD%9C%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于Git分支变基操作的一些笔记</a><br></span><span>  5.<a class="is-size-6" href="/2022/07/26/Git/%E5%85%B3%E4%BA%8EGit%E5%88%86%E6%94%AF%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于Git分支基础知识的一些笔记</a><br></span><span>  6.<a class="is-size-6" href="/2022/08/02/Git/%E5%85%B3%E4%BA%8EGit%E5%88%86%E6%94%AF%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/" target="_blank">关于Git分支工作流的一些笔记</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/alipay%EF%BF%A5.png" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/wechat%EF%BF%A5.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2023/10/10/AI-%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/%E5%9F%BA%E4%BA%8E%20Mtcnn(%E4%BA%BA%E8%84%B8%E6%A3%80%E6%B5%8B)+Hopenet(%E5%A7%BF%E6%80%81%E6%A3%80%E6%B5%8B)+%E6%8B%89%E6%99%AE%E6%8B%89%E6%96%AF%E7%AE%97%E5%AD%90(%E6%A8%A1%E7%B3%8A%E5%BA%A6%E6%A3%80%E6%B5%8B)%20%E7%9A%84%E4%BA%BA%E8%84%B8%E6%A3%80%E6%B5%8B%E6%9C%8D%E5%8A%A1/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">基于 Mtcnn(人脸检测)+Hopenet(姿态检测)+拉普拉斯算子(模糊度检测) 的人脸检测服务</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2023/10/07/rhca/RH442_BPF/%E7%BD%91%E7%BB%9C/Linux%20%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B%E7%BD%91%E7%BB%9C%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96/"><span class="level-item">Linux 性能调优之网络内核参数优化</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><div class="card"><div class="card-content"><div class="title is-5">评论</div><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            language:'zh-CN',
            id: '78fb6df005a6eba75bf3a29a5bb409ca',
            repo: 'blog_comment',
            owner: 'LIRUILONGS',
            clientID: '9fdc9739266d48d5f62e',
            clientSecret: 'c1cc33697d099a2197650ec9dadcb16bd4904655',
            admin: ["LIRUILONGS"],
            createIssueManually: true,
            distractionFreeMode: true,
            perPage: 10,
            pagerDirection: 'last',
            proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token',
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex is-mobile" href="#写在前面"><span class="mr-2">1</span><span>写在前面</span></a></li><li><a class="is-flex is-mobile" href="#选择合适的IO-调度器"><span class="mr-2">2</span><span>选择合适的IO 调度器</span></a></li><li><a class="is-flex is-mobile" href="#使用fio工具模拟工作负载"><span class="mr-2">3</span><span>使用fio工具模拟工作负载</span></a></li><li><a class="is-flex is-mobile" href="#磁盘阵列"><span class="mr-2">4</span><span>磁盘阵列</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#创建软RAID"><span class="mr-2">4.1</span><span>创建软RAID</span></a></li><li><a class="is-flex is-mobile" href="#通过逻辑卷配置RAID"><span class="mr-2">4.2</span><span>通过逻辑卷配置RAID</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#选择IO分析工具"><span class="mr-2">5</span><span>选择IO分析工具</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#iostat"><span class="mr-2">5.1</span><span>iostat</span></a></li><li><a class="is-flex is-mobile" href="#iotop"><span class="mr-2">5.2</span><span>iotop</span></a></li><li><a class="is-flex is-mobile" href="#Blktrace"><span class="mr-2">5.3</span><span>Blktrace</span></a></li><li><a class="is-flex is-mobile" href="#pcp-system-tools"><span class="mr-2">5.4</span><span>pcp-system-tools</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#博文部分内容参考"><span class="mr-2">6</span><span>博文部分内容参考</span></a></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class=""><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7.jpg" alt="山河已无恙"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">山河已无恙</p><p class="is-size-6 is-block">爱自己，是终生浪漫的开始</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国·呼和浩特</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">443</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">144</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">191</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://mp.weixin.qq.com/s?__biz=MzkyNjIxNTYwMw==&amp;mid=2247496480&amp;idx=1&amp;sn=a9971fed3962ef2a1aeda1f0bda65f86&amp;chksm=c2380ffcf54f86eaba8daac6caca72a70f38e61a8d25dc2a66d3a17b87c02530e326dcaea14b#rd" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/LIRUILONGS"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="CSDN" href="https://liruilong.blog.csdn.net/"><i class="fa fa-code"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:1224965096@qq.com"><i class="fa fa-envelope"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://liruilong.blog.csdn.net/?t=1&amp;type=blog" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">CSDN</span></span><span class="level-right"><span class="level-item tag">liruilong.blog.csdn.net</span></span></a></li><li><a class="level is-mobile" href="https://www.cnblogs.com/liruilong/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">博客园</span></span><span class="level-right"><span class="level-item tag">www.cnblogs.com</span></span></a></li><li><a class="level is-mobile" href="https://github.com/LIRUILONGS" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Githup</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li><li><a class="level is-mobile" href="https://gitee.com/liruilonger" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">码云</span></span><span class="level-right"><span class="level-item tag">gitee.com</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新评论</h3><span class="body_hot_comment">加载中，最新评论有1分钟缓存...</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-05-26T02:38:57.000Z">2025-05-26</time></p><p class="title"><a href="/2025/05/26/%E5%BE%85%E5%8F%91%E5%B8%83/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-BPF-%E5%88%86%E6%9E%90-Linux-%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%EF%BC%8CLinux-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B9%8B-BPF-%E5%88%86%E6%9E%90%E5%86%85%E6%A0%B8%E6%80%81%E3%80%81%E7%94%A8%E6%88%B7%E6%80%81%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2/">如何使用 BPF 分析 Linux 内存泄漏，Linux 性能调优之 BPF 分析内核态、用户态内存泄漏</a></p><p class="categories"><a href="/categories/Linux/">Linux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-05-22T03:12:56.000Z">2025-05-22</time></p><p class="title"><a href="/2025/05/22/%E5%BE%85%E5%8F%91%E5%B8%83/%E5%BC%B1%E5%85%89%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%A6%82%E4%BD%95%E6%89%8B%E6%8C%81%E7%9B%B8%E6%9C%BA%E6%8B%8D%E6%91%84%E9%9D%99%E7%89%A9%EF%BC%9A%E6%91%84%E5%BD%B1%E6%9B%9D%E5%85%89%E4%B9%8B%E7%AD%89%E6%95%88%E6%9B%9D%E5%85%89%E8%AE%A4%E7%9F%A5/">弱光环境下如何手持相机拍摄静物：摄影曝光之等效曝光认知</a></p><p class="categories"><a href="/categories/%E6%91%84%E5%BD%B1%E6%9B%9D%E5%85%89/">摄影曝光</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-04-17T23:32:10.000Z">2025-04-18</time></p><p class="title"><a href="/2025/04/18/%E5%BE%85%E5%8F%91%E5%B8%83/%E8%AE%A4%E8%AF%86%20Linux%20%E5%86%85%E5%AD%98%E6%9E%84%E6%88%90%EF%BC%9ALinux%20%E5%86%85%E5%AD%98%E8%B0%83%E4%BC%98%E4%B9%8B%E9%A1%B5%E8%A1%A8%E3%80%81TLB%E3%80%81%E5%A4%A7%E9%A1%B5%E8%AE%A4%E7%9F%A5/">认识 Linux 内存构成：Linux 内存调优之页表、TLB、缺页异常、大页认知</a></p><p class="categories"><a href="/categories/Linux/">Linux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-04-13T14:50:54.000Z">2025-04-13</time></p><p class="title"><a href="/2025/04/13/%E5%BE%85%E5%8F%91%E5%B8%83/%E8%B0%B7%E6%AD%8C68%E9%A1%B5%E7%99%BD%E7%9A%AE%E4%B9%A6%E8%A7%A3%E5%AF%86%EF%BC%9A%E6%8F%90%E7%A4%BA%E5%B7%A5%E7%A8%8B%E5%A6%82%E4%BD%95%E9%87%8D%E5%A1%91AI%E4%BA%A4%E4%BA%92%E9%80%BB%E8%BE%91/">谷歌68页白皮书解密：提示工程如何重塑AI交互逻辑</a></p><p class="categories"><a href="/categories/LLM/">LLM</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-04-11T11:38:12.000Z">2025-04-11</time></p><p class="title"><a href="/2025/04/11/%E5%BE%85%E5%8F%91%E5%B8%83/Linux%20%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AD%98%E7%9B%91%E6%8E%A7%EF%BC%9ALinux%20%E5%86%85%E5%AD%98%E8%B0%83%E4%BC%98%E4%B9%8B%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AD%98%E5%85%A8%E9%9D%A2%E7%9B%91%E6%8E%A7/">Linux 系统内存监控：Linux 内存调优之系统内存全面监控</a></p><p class="categories"><a href="/categories/Linux/">Linux</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/AIGC/"><span class="level-start"><span class="level-item">AIGC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/AdaFace/"><span class="level-start"><span class="level-item">AdaFace</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ajax/"><span class="level-start"><span class="level-item">Ajax</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ansible/"><span class="level-start"><span class="level-item">Ansible</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/AppCube/"><span class="level-start"><span class="level-item">AppCube</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/BPF/"><span class="level-start"><span class="level-item">BPF</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Bind9/"><span class="level-start"><span class="level-item">Bind9</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CI-CD/"><span class="level-start"><span class="level-item">CI/CD</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CSS/"><span class="level-start"><span class="level-item">CSS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Ceph/"><span class="level-start"><span class="level-item">Ceph</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2025/05/"><span class="level-start"><span class="level-item">五月 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2025/04/"><span class="level-start"><span class="level-item">四月 2025</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2025/03/"><span class="level-start"><span class="level-item">三月 2025</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2025/02/"><span class="level-start"><span class="level-item">二月 2025</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2025/01/"><span class="level-start"><span class="level-item">一月 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Kubernetes/"><span class="tag">Kubernetes</span><span class="tag is-grey-lightest">98</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag is-grey-lightest">58</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ansible/"><span class="tag">Ansible</span><span class="tag is-grey-lightest">25</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ceph/"><span class="tag">Ceph</span><span class="tag is-grey-lightest">22</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag is-grey-lightest">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Docker/"><span class="tag">Docker</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JAVA/"><span class="tag">JAVA</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%8E%E4%B8%BA%E4%BA%91/"><span class="tag">华为云</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BPF/"><span class="tag">BPF</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CPU/"><span class="tag">CPU</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mysql/"><span class="tag">Mysql</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Go/"><span class="tag">Go</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LLM/"><span class="tag">LLM</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OpenShift/"><span class="tag">OpenShift</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%91%84%E5%BD%B1%E6%9B%9D%E5%85%89/"><span class="tag">摄影曝光</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/"><span class="tag">程序人生</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DNS/"><span class="tag">DNS</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OKD/"><span class="tag">OKD</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/selenium/"><span class="tag">selenium</span><span class="tag is-grey-lightest">4</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="山河已无恙" height="28"></a><p class="size-small"><span>&copy; 2025 山河已无恙</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© <a href="http://www.beian.miit.gov.cn/" target="_blank">备案中</a><br></span><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "❤️本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已运行 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！❤️";
        }var now = new Date();setInterval("createTime('2021/6/26 21:27:00')", 250,"");</script><br></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2364053447" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/katex.min.css"><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/katex.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/contrib/auto-render.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.11.1/contrib/mhchem.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdnjs.loli.net/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('9fdc9739266d48d5f62e','c1cc33697d099a2197650ec9dadcb16bd4904655','LIRUILONGS','blog_comment',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(true){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('9fdc9739266d48d5f62e','c1cc33697d099a2197650ec9dadcb16bd4904655','LIRUILONGS','blog_comment',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>